import{i as e,y as t,s as o}from"./lit-element-DtTU7p4v.js";const s=e=>class extends e{constructor(){super(...arguments),this._previouslyFocusedElement=null}captureFocus(){this._previouslyFocusedElement=document.activeElement}restoreFocus(){this._previouslyFocusedElement&&"function"==typeof this._previouslyFocusedElement.focus&&this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null}},n=e=>`toujou-overlay-${e}`,i=(e,t)=>{document.cookie=n(e)+"="+t+";path=/;"};var r,l,a,u=e(r||(l=[":host {\n    display: none;\n}\n\n:host([opened]) {\n    display: block !important;\n}\n"],a||(a=l.slice(0)),r=Object.freeze(Object.defineProperties(l,{raw:{value:Object.freeze(a)}}))));class d extends(s(o)){constructor(){super(...arguments),this.opened=!1,this.delay=0}static get is(){return"toujou-overlay"}static get properties(){return{opened:{type:Boolean,reflect:!0},delay:{type:Number,reflect:!0}}}firstUpdated(e){if(super.firstUpdated(e),"#aaa"===location.hash)return void i(this.id,"accepted");const t="accepted"!==(e=>{const t=document.cookie.match(new RegExp("(^| )"+n(e)+"=([^;]+)"));return!!t&&t[2]})(this.id);this.delay>0?setTimeout((()=>{this.opened=t}),this.delay):this.opened=t}updated(e){e.has("opened")&&void 0!==e.get("opened")&&(this.opened?this.showOverlay():this.hideOverlay(),this.setAttribute("aria-hidden",this.opened?"false":"true")),super.updated(e)}render(){return t`<slot id="templatedContent"></slot>`}showOverlay(){this.captureFocus(),this.shadowRoot.querySelector("#templatedContent").assignedNodes({flatten:!0}).filter((e=>"TEMPLATE"===e.tagName)).forEach((e=>{const t=(e=>{const t=e.innerHTML.trim();return(o=t).startsWith("\x3c!--")&&o.endsWith("--\x3e")?t.substring(4,t.length-3):t;var o})(e);this.innerHTML+=t})),this.overlayButtons.forEach((e=>{e.addEventListener("click",(e=>this.handleOverlayButtonClick(e)))})),this.overlayCloseButtons.forEach((e=>{e.addEventListener("click",(()=>this.handleCloseButtonClick()))})),document.body.classList.add("toujou-overlay-open");const e=this.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');e.length>0&&e[0].focus(),document.dispatchEvent(new CustomEvent("toujou-overlay-show",{detail:{overlay:this.id},bubbles:!0}))}hideOverlay(){document.body.classList.remove("toujou-overlay-open"),document.dispatchEvent(new CustomEvent("toujou-overlay-hide",{detail:{overlay:this.id},bubbles:!0})),Array.from(this.children).forEach((e=>{"TEMPLATE"!==e.tagName&&e.remove()})),this.restoreFocus()}showWarning(){this.overlayWarning&&(this.overlayWarning.style.display="block"),this.overlayButtonsContainer&&(this.overlayButtonsContainer.style.display="none")}handleOverlayButtonClick(e){const t=e.target.getAttribute("data-overlay-value");document.dispatchEvent(new CustomEvent("toujou-overlay-button-click",{detail:{overlay:this.id,choice:t},bubbles:!0})),"no"===t?(i(this.id,"rejected"),this.showWarning()):"yes"===t&&(i(this.id,"accepted"),this.opened=!1)}handleCloseButtonClick(){document.dispatchEvent(new CustomEvent("toujou-overlay-button-close-click",{detail:{overlay:this.id},bubbles:!0})),i(this.id,"accepted"),this.opened=!1}get overlayButtonsContainer(){return this.querySelector(".overlay__buttons")}get overlayButtons(){return this.querySelectorAll(".overlay__button")}get overlayCloseButtons(){return this.querySelectorAll(".overlay-button-close-trigger")}get overlayWarning(){return this.querySelector(".overlay__warning")}}d.styles=[u],customElements.define(d.is,d);
//# sourceMappingURL=toujou-overlay.js.map
