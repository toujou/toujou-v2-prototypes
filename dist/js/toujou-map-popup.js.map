{"version":3,"file":"toujou-map-popup.js","sources":["../../src/components/copied/toujou-map/toujou-map-popup.styles.js","../../src/components/copied/toujou-map/toujou-map-popup.js"],"sourcesContent":["import { css } from 'lit';\n\nexport const ToujouMapPopupStyles = css`\n  :host {\n    display: block;\n    max-width: 90vw;\n    width: 320px;\n  }\n`;","import { LitElement, html } from 'lit';\nimport mapboxgl from 'mapbox-gl';\nimport { ToujouMapPopupStyles } from \"./toujou-map-popup.styles.js\";\n\nfunction makeid(length) {\n  let result = '';\n  const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  const charactersLength = characters.length;\n  for (let i = 0; i < length; i++) {\n    result += characters.charAt(Math.floor(Math.random() * charactersLength));\n  }\n  return result;\n}\n\nclass ToujouMapPopup extends LitElement {\n  static get is() { return 'toujou-map-popup'; }\n\n  static styles = [ ToujouMapPopupStyles ];\n\n  static get styles() { return styles; }\n\n  render() {\n    return html`<slot></slot>`;\n  }\n\n  static get properties() {\n    return {\n\n      coordinates: {\n        type: Array,\n      },\n\n      closeButton: {\n        type: Boolean,\n        attribute: 'close-button',\n      },\n\n      closeOnOutsideClick: {\n        type: Boolean,\n        attribute: 'close-on-outside-click',\n      },\n    };\n  }\n\n  set map(map) {\n    if (map !== this._map) {\n      this._map = map;\n      map ? this.initPopup() : (this.popup && this.popup.remove());\n    }\n  }\n\n  get map() {\n    return this._map;\n  }\n\n  set marker(marker) {\n    if (marker !== this._marker) {\n      this._marker = marker;\n      marker ? this.initPopup() : (this.popup && this.popup.remove());\n    }\n  }\n\n  get marker() {\n    return this._marker;\n  }\n\n  set coordinates(lngLatLike) {\n    this.popup && this.popup.setLngLat(lngLatLike);\n    this._lngLat = lngLatLike;\n  }\n\n  get coordinates() {\n    return this.popup ? this.popup.getLngLat() : this._lngLat;\n  }\n\n  set closeButton(closeButton) {\n    this.initialPopupOptions.closeButton = !!closeButton;\n  }\n\n  get closeButton() {\n    return this.initialPopupOptions.closeButton;\n  }\n\n  set closeOnOutsideClick(closeOnOutsideClick) {\n    this.initialPopupOptions.closeOnClick = !!closeOnOutsideClick;\n  }\n\n  get closeOnOutsideClick() {\n    return this.initialPopupOptions.closeOnClick;\n  }\n\n  constructor(props) {\n    super(props);\n    this.initialPopupOptions = {\n      closeButton: false,\n      closeOnClick: false,\n    };\n    this._lngLat = [0, 0];\n    this._map = null;\n    this._marker = null;\n    this.popup = null;\n    this.popupSlotName = `popup-${makeid(6)}`;\n    this.forwardPopupEvent = this.forwardPopupEvent.bind(this);\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.dispatchEvent(new CustomEvent('toujou-map-element-attached', { detail: this, bubbles: true, composed: true }));\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this.popup && this.popup.remove();\n  }\n\n  initPopup() {\n    this.popup = new mapboxgl.Popup(this.initialPopupOptions);\n    this.popup.setLngLat(this._lngLat);\n    this.popup.on('open', this.forwardPopupEvent);\n    this.popup.on('close', this.forwardPopupEvent);\n    this.transferToPopupSlot();\n    if (this.map) {\n      this.popup.addTo(this.map);\n    } else if (this.marker) {\n      this.marker.setPopup(this.popup);\n    } else {\n      console.error('toujou-map-popup could not be added to a map or marker');\n    }\n  }\n\n  forwardPopupEvent(event) {\n    // eslint-disable-next-line default-case\n    switch (event.type) {\n      case 'open':\n        this.dispatchEvent(new CustomEvent('toujou-map-popup-opened', { detail: this.popup, bubbles: true, composed: true }));\n        break;\n      case 'close':\n        this.dispatchEvent(new CustomEvent('toujou-map-popup-closed', { detail: this.popup, bubbles: true, composed: true }));\n        break;\n    }\n  }\n\n  transferToPopupSlot() {\n    const slot = document.createElement('slot');\n    slot.name = this.popupSlotName;\n    this.popup.setDOMContent(slot);\n    this.slot = this.popupSlotName;\n    // eslint-disable-next-line no-undef\n    window.ShadyCSS && ShadyCSS.styleElement(this);\n  }\n}\n\ncustomElements.define(ToujouMapPopup.is, ToujouMapPopup);\n"],"names":["ToujouMapPopupStyles","css","makeid","length","result","characters","charactersLength","i","ToujouMapPopup","LitElement","html","map","marker","lngLatLike","closeButton","closeOnOutsideClick","props","mapboxgl","event","slot","__publicField"],"mappings":"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"}