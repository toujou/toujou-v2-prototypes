{"version":3,"file":"toujou-gallery.js","sources":["../../src/components/toujou-gallery/toujou-gallery.ts"],"sourcesContent":["import { LitElement } from 'lit'\nimport { customElement } from 'lit/decorators.js'\nimport PhotoSwipe from 'photoswipe';\nimport PhotoSwipeLightbox from 'photoswipe/lightbox';\n\n@customElement('toujou-gallery')\nexport class ToujouGallery extends LitElement {\n\n    private lightbox: any;\n\n    // @ts-ignore\n    private get galleryID(): string | undefined {\n        const galleryId = this.getAttribute('id');\n        return galleryId ? `#${galleryId}` : undefined;\n    }\n\n    protected createRenderRoot(): Element | ShadowRoot {\n        return this;\n    }\n\n    connectedCallback() {\n        super.connectedCallback();\n\n        this.lightbox = new PhotoSwipeLightbox({\n            gallery: this.galleryID,\n            children: 'a',\n            pswpModule: PhotoSwipe,\n            allowPanToNext: true,\n            preloaderDelay: 0,\n        })\n\n        this.lightbox.on('uiRegister', () => this._handleUiRegister());\n        this.lightbox.init();\n    }\n\n    /**\n     * Register a new UI element: caption\n     */\n    _handleUiRegister = () => {\n        this.lightbox.pswp.ui.registerElement({\n            name: 'caption',\n            order: 9,\n            isButton: false,\n            appendTo: 'root',\n            onInit: (el: HTMLElement) => {\n                this.lightbox.pswp.on('change', () => this._handleChange(el));\n            },\n        });\n    }\n\n    /**\n     * React to change on the lightbox so that we can add the correct caption text\n     * @param {HTMLElement} el\n     */\n    _handleChange = (el: HTMLElement) => {\n        let captionText = '';\n        const currSlideElement = this.lightbox.pswp.currSlide.data.element;\n\n        if (currSlideElement) {\n            captionText = currSlideElement.getAttribute('title');\n        }\n\n        el.textContent = captionText ? captionText : '';\n    }\n}\n\ndeclare global {\n    interface HTMLElementTagNameMap {\n        'toujou-gallery': ToujouGallery\n    }\n}\n"],"names":["ToujouGallery","LitElement","el","captionText","currSlideElement","galleryId","PhotoSwipeLightbox","PhotoSwipe","__decorateClass","customElement"],"mappings":"8YAMa,IAAAA,EAAN,cAA4BC,CAAW,CAAvC,aAAA,CAAA,MAAA,GAAA,SAAA,EAgCH,KAAA,kBAAoB,IAAM,CACjB,KAAA,SAAS,KAAK,GAAG,gBAAgB,CAClC,KAAM,UACN,MAAO,EACP,SAAU,GACV,SAAU,OACV,OAASC,GAAoB,CACpB,KAAA,SAAS,KAAK,GAAG,SAAU,IAAM,KAAK,cAAcA,CAAE,CAAC,CAChE,CAAA,CACH,CAAA,EAOL,KAAA,cAAiBA,GAAoB,CACjC,IAAIC,EAAc,GAClB,MAAMC,EAAmB,KAAK,SAAS,KAAK,UAAU,KAAK,QAEvDA,IACcD,EAAAC,EAAiB,aAAa,OAAO,GAGpDF,EAAA,YAAcC,GAA4B,EAAA,CACjD,CApDA,IAAY,WAAgC,CAClC,MAAAE,EAAY,KAAK,aAAa,IAAI,EACjC,OAAAA,EAAY,IAAIA,IAAc,MACzC,CAEU,kBAAyC,CACxC,OAAA,IACX,CAEA,mBAAoB,CAChB,MAAM,kBAAkB,EAEnB,KAAA,SAAW,IAAIC,EAAmB,CACnC,QAAS,KAAK,UACd,SAAU,IACV,WAAYC,EACZ,eAAgB,GAChB,eAAgB,CAAA,CACnB,EAED,KAAK,SAAS,GAAG,aAAc,IAAM,KAAK,mBAAmB,EAC7D,KAAK,SAAS,MAClB,CA+BJ,EA1DaP,EAANQ,EAAA,CADNC,EAAc,gBAAgB,CAAA,EAClBT,CAAA"}