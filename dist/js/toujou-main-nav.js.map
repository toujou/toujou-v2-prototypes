{"version":3,"file":"toujou-main-nav.js","sources":["../../src/components/toujou-main-nav/toujou-main-nav.ts"],"sourcesContent":["import { LitElement } from 'lit'\nimport { property } from 'lit/decorators.js'\n\nexport class ToujouMainNav extends LitElement {\n    @property({ type: Array })\n    navListItems: MainNavListItem[] = [];\n\n    protected readonly listItemSelector = '.main-nav__list-item';\n    protected readonly hasSubNavAttribute = 'has-subnav';\n    protected readonly isOpenAttribute = 'is-open';\n    protected readonly listItemLevelAttribute = 'nav-item-level';\n\n    constructor() {\n        super();\n    }\n\n    connectedCallback() {\n        super.connectedCallback();\n\n        this._getNavListItems();\n\n        // @ts-ignore\n        window.addEventListener('keyup', this._handleKeyUp);\n    }\n\n    protected createRenderRoot(): Element | ShadowRoot {\n        return this;\n    }\n\n    /**\n     * Get list of all the main navigation list items and start listening for click events\n     */\n    _getNavListItems = () => {\n        this.navListItems = [...this.querySelectorAll(this.listItemSelector)] as MainNavListItem[];\n\n        if (!this.navListItems) {\n            console.warn(\"TOUJOU: Main navigation has no list items!\");\n            return;\n        }\n\n        this.navListItems.forEach((listItem: MainNavListItem) => {\n            listItem.hasSubNav = listItem.hasAttribute(this.hasSubNavAttribute);\n            if (!listItem.hasSubNav) return;\n\n            listItem.isOpen = false;\n            listItem.level = listItem.getAttribute(this.listItemLevelAttribute);\n            listItem.toggleEl = listItem.querySelector('.main-nav__chevron') as HTMLElement;\n            listItem.toggleEl.addEventListener('click', () => {\n                this._toggleListItemState(listItem);\n            })\n            listItem.addEventListener('keyup', () => {\n                // @ts-ignore\n                this._handleKeyUp(event, listItem);\n            });\n        })\n    }\n\n    _handleKeyUp = (event: KeyboardEvent, listItem: MainNavListItem) => {\n        // Open list item when there is a \"enter\" or \"space\" press on the item chevron\n        if (event.key === 'Enter' || event.code === 'Enter' || event.code === 'Space' || event.key === ' ') {\n            this._toggleListItemState(listItem);\n        }\n\n        // Close all nav items when \"Escape\" is pressed\n        if (event.key === 'Escape' || event.code === 'Escape') {\n            this._closeAllNavListItems();\n        }\n    }\n\n    /**\n     * Toggle the list item isOpen state and add / remove the isOpenAttribute accordingly\n     * @param listItem\n     */\n    _toggleListItemState(listItem: MainNavListItem) {\n        listItem.isOpen = !listItem.isOpen;\n\n        if (listItem.isOpen) {\n            listItem.setAttribute(this.isOpenAttribute, '')\n            this._closeOtherOpenListItems(listItem);\n        } else {\n            listItem.removeAttribute(this.isOpenAttribute);\n        }\n    }\n\n    /**\n     * Close other open list items so there aren't multiple lists open at the same time\n     * (only sibling or child lists will be closed)\n     * @param listItem\n     */\n    _closeOtherOpenListItems(listItem: MainNavListItem) {\n        const openSiblings: NodeListOf<MainNavListItem> | undefined = listItem.parentNode?.querySelectorAll(`${this.listItemSelector}[is-open]`);\n        if (!openSiblings) return;\n\n        openSiblings.forEach((sibling) => {\n            if (sibling.isOpen && sibling !== listItem) {\n                this._toggleListItemState(sibling);\n            }\n        })\n    }\n\n    /**\n     * Close all open navigation items\n     */\n    _closeAllNavListItems() {\n        this.navListItems.forEach((listItem) => {\n            if (listItem.isOpen ) {\n                this._toggleListItemState(listItem);\n            }\n        })\n    }\n}\n\ndeclare global {\n    interface HTMLElementTagNameMap {\n        'toujou-main-nav': ToujouMainNav\n    }\n\n    interface MainNavListItem extends HTMLElement {\n        hasSubNav: boolean,\n        isOpen: boolean,\n        level: string | null,\n        toggleEl: HTMLElement\n    }\n}\n\ncustomElements.define('toujou-main-nav', ToujouMainNav, { extends: 'nav' });\n"],"names":["ToujouMainNav","LitElement","listItem","event","openSiblings","_a","sibling","__decorateClass","property"],"mappings":"uUAGO,MAAMA,UAAsBC,CAAW,CAS1C,aAAc,CACJ,QARV,KAAA,aAAkC,GAElC,KAAmB,iBAAmB,uBACtC,KAAmB,mBAAqB,aACxC,KAAmB,gBAAkB,UACrC,KAAmB,uBAAyB,iBAsB5C,KAAA,iBAAmB,IAAM,CAGjB,GAFJ,KAAK,aAAe,CAAC,GAAG,KAAK,iBAAiB,KAAK,gBAAgB,CAAC,EAEhE,CAAC,KAAK,aAAc,CACpB,QAAQ,KAAK,4CAA4C,EACzD,MACJ,CAEK,KAAA,aAAa,QAASC,GAA8B,CACrDA,EAAS,UAAYA,EAAS,aAAa,KAAK,kBAAkB,EAC7DA,EAAS,YAEdA,EAAS,OAAS,GAClBA,EAAS,MAAQA,EAAS,aAAa,KAAK,sBAAsB,EACzDA,EAAA,SAAWA,EAAS,cAAc,oBAAoB,EACtDA,EAAA,SAAS,iBAAiB,QAAS,IAAM,CAC9C,KAAK,qBAAqBA,CAAQ,CAAA,CACrC,EACQA,EAAA,iBAAiB,QAAS,IAAM,CAEhC,KAAA,aAAa,MAAOA,CAAQ,CAAA,CACpC,EAAA,CACJ,CAAA,EAGU,KAAA,aAAA,CAACC,EAAsBD,IAA8B,EAE5DC,EAAM,MAAQ,SAAWA,EAAM,OAAS,SAAWA,EAAM,OAAS,SAAWA,EAAM,MAAQ,MAC3F,KAAK,qBAAqBD,CAAQ,GAIlCC,EAAM,MAAQ,UAAYA,EAAM,OAAS,WACzC,KAAK,sBAAsB,CAC/B,CApDJ,CAEA,mBAAoB,CAChB,MAAM,kBAAkB,EAExB,KAAK,iBAAiB,EAGf,OAAA,iBAAiB,QAAS,KAAK,YAAY,CACtD,CAEU,kBAAyC,CACxC,OAAA,IACX,CA8CA,qBAAqBD,EAA2B,CACnCA,EAAA,OAAS,CAACA,EAAS,OAExBA,EAAS,QACAA,EAAA,aAAa,KAAK,gBAAiB,EAAE,EAC9C,KAAK,yBAAyBA,CAAQ,GAE7BA,EAAA,gBAAgB,KAAK,eAAe,CAErD,CAOA,yBAAyBA,EAA2B,OAChD,MAAME,GAAwDC,EAAAH,EAAS,aAAT,YAAAG,EAAqB,iBAAiB,GAAG,KAAK,6BACvGD,GAEQA,EAAA,QAASE,GAAY,CAC1BA,EAAQ,QAAUA,IAAYJ,GAC9B,KAAK,qBAAqBI,CAAO,CACrC,CACH,CACL,CAKA,uBAAwB,CACf,KAAA,aAAa,QAASJ,GAAa,CAChCA,EAAS,QACT,KAAK,qBAAqBA,CAAQ,CACtC,CACH,CACL,CACJ,CAzGIK,EAAA,CADCC,EAAS,CAAE,KAAM,MAAO,CAAA,EADhBR,EAET,UAAA,eAAA,CAAA,EAwHJ,eAAe,OAAO,kBAAmBA,EAAe,CAAE,QAAS,MAAO"}