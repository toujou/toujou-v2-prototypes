{"version":3,"file":"toujou-overlay.js","sources":["../../node_modules/@toujou/toujou-overlay/lib/index.js"],"sourcesContent":["import{css as e,html as t,LitElement as o}from\"lit\";const s=e=>class extends e{constructor(){super(...arguments),this._previouslyFocusedElement=null}captureFocus(){this._previouslyFocusedElement=document.activeElement}restoreFocus(){this._previouslyFocusedElement&&\"function\"==typeof this._previouslyFocusedElement.focus&&this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null}};var r;!function(e){e.LOCAL_STORAGE=\"localStorage\",e.SESSION=\"session\"}(r||(r={}));const n=e=>`toujou-overlay-${e}`,i=(e,t,o=r.SESSION)=>{const s=n(e);o===r.LOCAL_STORAGE?localStorage.setItem(s,t):document.cookie=s+\"=\"+t+\";path=/;\"};var a,l,u,d=e(a||(l=[\":host {\\n    display: none;\\n}\\n\\n:host([opened]) {\\n    display: block !important;\\n}\\n\"],u||(u=l.slice(0)),a=Object.freeze(Object.defineProperties(l,{raw:{value:Object.freeze(u)}}))));class c extends(s(o)){constructor(){super(...arguments),this.opened=!1,this.delay=0,this.storageMode=r.SESSION}static get is(){return\"toujou-overlay\"}static get properties(){return{opened:{type:Boolean,reflect:!0},delay:{type:Number,reflect:!0},storageMode:{type:String,reflect:!0,attribute:\"storage-mode\"}}}firstUpdated(e){if(super.firstUpdated(e),\"#aaa\"===location.hash)return void i(this.id,\"accepted\",this.storageMode);const t=\"accepted\"!==((e,t=r.SESSION)=>{const o=n(e);if(t===r.LOCAL_STORAGE)return localStorage.getItem(o);{const e=document.cookie.match(new RegExp(\"(^| )\"+o+\"=([^;]+)\"));return!!e&&e[2]}})(this.id,this.storageMode);this.delay>0?setTimeout((()=>{this.opened=t}),this.delay):this.opened=t}updated(e){e.has(\"opened\")&&void 0!==e.get(\"opened\")&&(this.opened?this.showOverlay():this.hideOverlay(),this.setAttribute(\"aria-hidden\",this.opened?\"false\":\"true\")),super.updated(e)}render(){return t`<slot id=\"templatedContent\"></slot>`}showOverlay(){this.captureFocus();this.shadowRoot.querySelector(\"#templatedContent\").assignedNodes({flatten:!0}).filter((e=>\"TEMPLATE\"===e.tagName)).forEach((e=>{const t=(e=>{const t=e.innerHTML.trim();return(o=t).startsWith(\"\\x3c!--\")&&o.endsWith(\"--\\x3e\")?t.substring(4,t.length-3):t;var o})(e);this.innerHTML+=t})),this.overlayButtons.forEach((e=>{e.addEventListener(\"click\",(e=>this.handleOverlayButtonClick(e)))})),this.overlayCloseButtons.forEach((e=>{e.addEventListener(\"click\",(()=>this.handleCloseButtonClick()))})),document.body.classList.add(\"toujou-overlay-open\");const e=this.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])');e.length>0&&e[0].focus(),document.dispatchEvent(new CustomEvent(\"toujou-overlay-show\",{detail:{overlay:this.id},bubbles:!0}))}hideOverlay(){document.body.classList.remove(\"toujou-overlay-open\"),document.dispatchEvent(new CustomEvent(\"toujou-overlay-hide\",{detail:{overlay:this.id},bubbles:!0})),Array.from(this.children).forEach((e=>{\"TEMPLATE\"!==e.tagName&&e.remove()})),this.restoreFocus()}showWarning(){this.overlayWarning&&(this.overlayWarning.style.display=\"block\"),this.overlayButtonsContainer&&(this.overlayButtonsContainer.style.display=\"none\")}handleOverlayButtonClick(e){const t=e.target.getAttribute(\"data-overlay-value\");document.dispatchEvent(new CustomEvent(\"toujou-overlay-button-click\",{detail:{overlay:this.id,choice:t},bubbles:!0})),\"no\"===t?(i(this.id,\"rejected\",this.storageMode),this.showWarning()):\"yes\"===t&&(i(this.id,\"accepted\",this.storageMode),this.opened=!1)}handleCloseButtonClick(){document.dispatchEvent(new CustomEvent(\"toujou-overlay-button-close-click\",{detail:{overlay:this.id},bubbles:!0})),i(this.id,\"accepted\",this.storageMode),this.opened=!1}get overlayButtonsContainer(){return this.querySelector(\".overlay__buttons\")}get overlayButtons(){return this.querySelectorAll(\".overlay__button\")}get overlayCloseButtons(){return this.querySelectorAll(\".overlay-button-close-trigger\")}get overlayWarning(){return this.querySelector(\".overlay__warning\")}}c.styles=[d],customElements.define(c.is,c);export{c as ToujouOverlay};//# sourceMappingURL=index.js.map\n"],"names":["s","e","constructor","super","arguments","this","_previouslyFocusedElement","captureFocus","document","activeElement","restoreFocus","focus","r","LOCAL_STORAGE","SESSION","n","i","t","o","localStorage","setItem","cookie","a","l","u","d","slice","Object","freeze","defineProperties","raw","value","c","opened","delay","storageMode","is","properties","type","Boolean","reflect","Number","String","attribute","firstUpdated","location","hash","id","getItem","match","RegExp","setTimeout","updated","has","get","showOverlay","hideOverlay","setAttribute","render","shadowRoot","querySelector","assignedNodes","flatten","filter","tagName","forEach","innerHTML","trim","startsWith","endsWith","substring","length","overlayButtons","addEventListener","handleOverlayButtonClick","overlayCloseButtons","handleCloseButtonClick","body","classList","add","querySelectorAll","dispatchEvent","CustomEvent","detail","overlay","bubbles","remove","Array","from","children","showWarning","overlayWarning","style","display","overlayButtonsContainer","target","getAttribute","choice","styles","customElements","define"],"mappings":"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","x_google_ignoreList":[0]}