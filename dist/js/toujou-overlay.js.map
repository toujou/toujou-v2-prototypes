{"version":3,"file":"toujou-overlay.js","sources":["../../node_modules/@toujou/toujou-overlay/lib/index.js"],"sourcesContent":["import{css as e,html as t,LitElement as o}from\"lit\";const s=e=>class extends e{constructor(){super(...arguments),this._previouslyFocusedElement=null}captureFocus(){this._previouslyFocusedElement=document.activeElement}restoreFocus(){this._previouslyFocusedElement&&\"function\"==typeof this._previouslyFocusedElement.focus&&this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null}},n=e=>`toujou-overlay-${e}`,r=(e,t)=>{document.cookie=n(e)+\"=\"+t+\";path=/;\"};var i,l,a,u=e(i||(l=[\":host {\\n    display: none;\\n}\\n\\n:host([opened]) {\\n    display: block !important;\\n}\\n\"],a||(a=l.slice(0)),i=Object.freeze(Object.defineProperties(l,{raw:{value:Object.freeze(a)}}))));class d extends(s(o)){constructor(){super(...arguments),this.opened=!1,this.delay=0}static get is(){return\"toujou-overlay\"}static get properties(){return{opened:{type:Boolean,reflect:!0},delay:{type:Number,reflect:!0}}}firstUpdated(e){if(super.firstUpdated(e),\"#aaa\"===location.hash)return void r(this.id,\"accepted\");const t=\"accepted\"!==(e=>{const t=document.cookie.match(new RegExp(\"(^| )\"+n(e)+\"=([^;]+)\"));return!!t&&t[2]})(this.id);this.delay>0?setTimeout((()=>{this.opened=t}),this.delay):this.opened=t}updated(e){e.has(\"opened\")&&void 0!==e.get(\"opened\")&&(this.opened?this.showOverlay():this.hideOverlay(),this.setAttribute(\"aria-hidden\",this.opened?\"false\":\"true\")),super.updated(e)}render(){return t`<slot id=\"templatedContent\"></slot>`}showOverlay(){this.captureFocus();this.shadowRoot.querySelector(\"#templatedContent\").assignedNodes({flatten:!0}).filter((e=>\"TEMPLATE\"===e.tagName)).forEach((e=>{const t=(e=>{const t=e.innerHTML.trim();return(o=t).startsWith(\"\\x3c!--\")&&o.endsWith(\"--\\x3e\")?t.substring(4,t.length-3):t;var o})(e);this.innerHTML+=t})),this.overlayButtons.forEach((e=>{e.addEventListener(\"click\",(e=>this.handleOverlayButtonClick(e)))})),this.overlayCloseButtons.forEach((e=>{e.addEventListener(\"click\",(()=>this.handleCloseButtonClick()))})),document.body.classList.add(\"toujou-overlay-open\");const e=this.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])');e.length>0&&e[0].focus(),document.dispatchEvent(new CustomEvent(\"toujou-overlay-show\",{detail:{overlay:this.id},bubbles:!0}))}hideOverlay(){document.body.classList.remove(\"toujou-overlay-open\"),document.dispatchEvent(new CustomEvent(\"toujou-overlay-hide\",{detail:{overlay:this.id},bubbles:!0})),Array.from(this.children).forEach((e=>{\"TEMPLATE\"!==e.tagName&&e.remove()})),this.restoreFocus()}showWarning(){this.overlayWarning&&(this.overlayWarning.style.display=\"block\"),this.overlayButtonsContainer&&(this.overlayButtonsContainer.style.display=\"none\")}handleOverlayButtonClick(e){const t=e.target.getAttribute(\"data-overlay-value\");document.dispatchEvent(new CustomEvent(\"toujou-overlay-button-click\",{detail:{overlay:this.id,choice:t},bubbles:!0})),\"no\"===t?(r(this.id,\"rejected\"),this.showWarning()):\"yes\"===t&&(r(this.id,\"accepted\"),this.opened=!1)}handleCloseButtonClick(){document.dispatchEvent(new CustomEvent(\"toujou-overlay-button-close-click\",{detail:{overlay:this.id},bubbles:!0})),r(this.id,\"accepted\"),this.opened=!1}get overlayButtonsContainer(){return this.querySelector(\".overlay__buttons\")}get overlayButtons(){return this.querySelectorAll(\".overlay__button\")}get overlayCloseButtons(){return this.querySelectorAll(\".overlay-button-close-trigger\")}get overlayWarning(){return this.querySelector(\".overlay__warning\")}}d.styles=[u],customElements.define(d.is,d);export{d as ToujouOverlay};//# sourceMappingURL=index.js.map\n"],"names":["s","e","constructor","super","arguments","this","_previouslyFocusedElement","captureFocus","document","activeElement","restoreFocus","focus","n","r","t","cookie","i","l","a","u","slice","Object","freeze","defineProperties","raw","value","d","o","opened","delay","is","properties","type","Boolean","reflect","Number","firstUpdated","location","hash","id","match","RegExp","setTimeout","updated","has","get","showOverlay","hideOverlay","setAttribute","render","shadowRoot","querySelector","assignedNodes","flatten","filter","tagName","forEach","innerHTML","trim","startsWith","endsWith","substring","length","overlayButtons","addEventListener","handleOverlayButtonClick","overlayCloseButtons","handleCloseButtonClick","body","classList","add","querySelectorAll","dispatchEvent","CustomEvent","detail","overlay","bubbles","remove","Array","from","children","showWarning","overlayWarning","style","display","overlayButtonsContainer","target","getAttribute","choice","styles","customElements","define"],"mappings":"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","x_google_ignoreList":[0]}