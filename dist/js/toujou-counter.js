import{s}from"./lit-element-6fe74b4f.js";const o=.75,u=1,m=3e3,h="medium",d="de-DE",l="toujou-counter-init",c="toujou-counter-animation-start",b="toujou-counter-animation-end";class i extends s{constructor(){super(...arguments),this._frameDuration=1e3/60,this._observer=new IntersectionObserver((t,e)=>{t.forEach(n=>{n.isIntersecting&&n.intersectionRatio>=o&&(this._dispatchCounterEvent(c),this._animate(),e.unobserve(this))})},{threshold:u}),this._init=()=>{this._startNumberVal=parseFloat(this.startNumber),this._endNumberVal=parseFloat(this.endNumber),this._animationDuration=this._getAnimationDuration(),this._totalFrames=Math.round(this._animationDuration/this._frameDuration),this._pageLang=document.documentElement.getAttribute("lang")||d,this._observer.observe(this._numberEl),this._dispatchCounterEvent(l)},this._animate=()=>{let t=0;const e=()=>{t++;const n=(r=t/this._totalFrames)*(2-r);var r;const a=this._endNumberVal>=this._startNumberVal?Math.round(this._startNumberVal+(this._endNumberVal-this._startNumberVal)*n):Math.round(this._startNumberVal-(this._startNumberVal-this._endNumberVal)*n);parseFloat(this._numberEl.textContent.replace(/,/g,""))!==a&&(this._numberEl.textContent=new Intl.NumberFormat(this._pageLang).format(a)),t<this._totalFrames?requestAnimationFrame(e):(this._numberEl.textContent=new Intl.NumberFormat(this._pageLang).format(this._endNumberVal),this._dispatchCounterEvent(b))};requestAnimationFrame(e)},this._getAnimationDuration=()=>{this._animationSpeedVarName=`--counter-animation-duration-${this.animationSpeed?this.animationSpeed:h}`;const t=getComputedStyle(this);let e=parseInt(t.getPropertyValue(`${this._animationSpeedVarName}`));return e||(console.warn("TOUJOU: could not get the counter animation duration variable. Using fallback value",this),e=m),e},this._dispatchCounterEvent=t=>{this.dispatchEvent(new CustomEvent(t,{bubbles:!0,composed:!0,detail:{counter:this}}))}}static get is(){return"toujou-counter"}createRenderRoot(){return this}firstUpdated(t){super.firstUpdated(t),this.startNumber&&this.endNumber?(this._numberEl=this.querySelector(".counter__number-text"),this._numberEl?(this.animationSpeed||console.warn("TOUJOU: could not get the counter animation speed. Using default value!",this),window.matchMedia("(prefers-reduced-motion: reduce)").matches?this._numberEl.textContent=this.endNumber:this._init()):console.error("TOUJOU: could not get the counter number element!",this)):console.error("TOUJOU: could not get start and end values for the counter animation!",this)}}i.properties={startNumber:{type:String,attribute:"start-number"},endNumber:{type:String,attribute:"end-number"},animationSpeed:{type:String,attribute:"animation-speed"}},customElements.define(i.is,i);
//# sourceMappingURL=toujou-counter.js.map
