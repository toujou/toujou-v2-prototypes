var u=Object.defineProperty;var a=(e,t,o)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var i=(e,t,o)=>(a(e,typeof t!="symbol"?t+"":t,o),o);import{r,s as l,$ as h}from"./lit-element-8ef55b20.js";import{m as c}from"./mapbox-gl-1a935e36.js";const d=r`
  :host {
    display: block;
    max-width: 90vw;
    width: 320px;
  }
`;function m(e){let t="";const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=o.length;for(let s=0;s<e;s++)t+=o.charAt(Math.floor(Math.random()*n));return t}class p extends l{static get is(){return"toujou-map-popup"}static get styles(){return styles}render(){return h`<slot></slot>`}static get properties(){return{coordinates:{type:Array},closeButton:{type:Boolean,attribute:"close-button"},closeOnOutsideClick:{type:Boolean,attribute:"close-on-outside-click"}}}set map(t){t!==this._map&&(this._map=t,t?this.initPopup():this.popup&&this.popup.remove())}get map(){return this._map}set marker(t){t!==this._marker&&(this._marker=t,t?this.initPopup():this.popup&&this.popup.remove())}get marker(){return this._marker}set coordinates(t){this.popup&&this.popup.setLngLat(t),this._lngLat=t}get coordinates(){return this.popup?this.popup.getLngLat():this._lngLat}set closeButton(t){this.initialPopupOptions.closeButton=!!t}get closeButton(){return this.initialPopupOptions.closeButton}set closeOnOutsideClick(t){this.initialPopupOptions.closeOnClick=!!t}get closeOnOutsideClick(){return this.initialPopupOptions.closeOnClick}constructor(t){super(t),this.initialPopupOptions={closeButton:!1,closeOnClick:!1},this._lngLat=[0,0],this._map=null,this._marker=null,this.popup=null,this.popupSlotName=`popup-${m(6)}`,this.forwardPopupEvent=this.forwardPopupEvent.bind(this)}connectedCallback(){super.connectedCallback(),this.dispatchEvent(new CustomEvent("toujou-map-element-attached",{detail:this,bubbles:!0,composed:!0}))}disconnectedCallback(){super.disconnectedCallback(),this.popup&&this.popup.remove()}initPopup(){this.popup=new c.Popup(this.initialPopupOptions),this.popup.setLngLat(this._lngLat),this.popup.on("open",this.forwardPopupEvent),this.popup.on("close",this.forwardPopupEvent),this.transferToPopupSlot(),this.map?this.popup.addTo(this.map):this.marker?this.marker.setPopup(this.popup):console.error("toujou-map-popup could not be added to a map or marker")}forwardPopupEvent(t){switch(t.type){case"open":this.dispatchEvent(new CustomEvent("toujou-map-popup-opened",{detail:this.popup,bubbles:!0,composed:!0}));break;case"close":this.dispatchEvent(new CustomEvent("toujou-map-popup-closed",{detail:this.popup,bubbles:!0,composed:!0}));break}}transferToPopupSlot(){const t=document.createElement("slot");t.name=this.popupSlotName,this.popup.setDOMContent(t),this.slot=this.popupSlotName,window.ShadyCSS&&ShadyCSS.styleElement(this)}}i(p,"styles",[d]);customElements.define(p.is,p);
//# sourceMappingURL=toujou-map-popup.js.map
