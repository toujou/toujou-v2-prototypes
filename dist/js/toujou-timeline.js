import{_ as e}from"./tslib.es6-Br7-PHSQ.js";import{s as t}from"./lit-element-CHDbfp5U.js";import{e as i}from"./custom-element-DPYutfhb.js";import"./query-assigned-elements-DqqHV3QO.js";const s="toujou-timeline-new-observation",n="toujou-timeline-legend-year-click";let r=class extends t{constructor(){super(...arguments),this._checkForLocationHash=()=>{const e=window.location.hash;e&&this.querySelector(`${e}`)&&(this._timelineContainerEl.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"}),this._scrollToYear(e.substring(1)))}}createRenderRoot(){return this}connectedCallback(){super.connectedCallback(),this._init()}_init(){if(this._years=this.querySelectorAll(".timeline-item__year"),!this._years)return;this._timelineContainerEl=this.querySelector(".timeline__container"),this._isHorizontalTimeline="horizontal"===this.getAttribute("timeline-direction"),this._isHorizontalTimeline&&this._checkForLocationHash();const e={rootMargin:"-100px -100px -100px -100px",threshold:this._createThresholdList(50)};this.observer=new IntersectionObserver(this._handleObserver.bind(this),e),this._years.forEach((e=>{this.observer.observe(e)})),this.dispatchEvent(new CustomEvent("toujou-timeline-ready",{bubbles:!0,composed:!0,detail:this})),this.addEventListener(n,this._onLegendYearClick)}_handleObserver(e){const t=[];e.forEach((e=>{const i=e.target.id;i&&(t.push({yearId:i,isIntersecting:e.isIntersecting}),this.dispatchEvent(new CustomEvent(s,{bubbles:!0,composed:!0,detail:t})))}))}_createThresholdList(e){return[...Array(e).keys()].map((t=>t/e))}_onLegendYearClick(e){const t=e.detail;t&&this._scrollToYear(t)}_scrollToYear(e){const t=this.querySelector(`#${e}`);if(!t)return;const i=t.closest(".timeline-item");if(!i)return;const s=i.offsetLeft;this._timelineContainerEl.scrollTo({left:s,behavior:"smooth"})}};r=e([i("toujou-timeline")],r);let o=class extends t{constructor(){super(...arguments),this.isActiveAttribute="is-active"}createRenderRoot(){return this}connectedCallback(){super.connectedCallback(),this._yearLinks=this.querySelectorAll(".timeline-legend__link"),this._yearLinks&&this._init()}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener(s,this._onTimelineObservations.bind(this))}_init(){window.addEventListener(s,this._onTimelineObservations.bind(this)),this._yearLinks.forEach((e=>{e.addEventListener("keyup",this._handleYearLinkKeyUp)})),this._isHorizontalTimeline=!!this.closest('.timeline[timeline-direction="horizontal"]'),this._isHorizontalTimeline&&this._initYearClicks(),this.dispatchEvent(new CustomEvent("toujou-timeline-legend-ready",{bubbles:!0,composed:!0,detail:this}))}_initYearClicks(){this._yearLinks.forEach((e=>{e.addEventListener("click",this._onYearLinkClick)}))}_onTimelineObservations(e){const t=e.detail;t&&t.forEach((e=>{const t=this.querySelector(`.timeline-legend__link[href="#${e.yearId}"]`);t&&(e.isIntersecting?t.setAttribute(this.isActiveAttribute,""):t.removeAttribute(this.isActiveAttribute))}))}_onYearLinkClick(e){let t;const i=e.currentTarget;if(!i)return;const s=i.href;if(!s)return;const r=s.split("#");r.length>1&&(t=r.pop()),t&&(e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent(n,{bubbles:!0,composed:!0,detail:t})))}_handleYearLinkKeyUp(e){"Enter"!==e.key&&"Enter"!==e.code&&"Space"!==e.code&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),e.currentTarget.click())}};o=e([i("toujou-timeline-legend")],o);
//# sourceMappingURL=toujou-timeline.js.map
