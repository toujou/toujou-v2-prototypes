import{_ as a}from"./tslib.es6-d64b32d8.js";import{s as c}from"./lit-element-6fe74b4f.js";import{e as h}from"./custom-element-73470d87.js";import"./query-assigned-elements-acf341e1.js";const s="toujou-timeline-new-observation",d="toujou-timeline-legend-year-click";let o=class extends c{constructor(){super(...arguments),this._checkForLocationHash=()=>{const e=window.location.hash;e&&this.querySelector(`${e}`)&&(this._timelineContainerEl.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"}),this._scrollToYear(e.substring(1)))}}createRenderRoot(){return this}connectedCallback(){super.connectedCallback(),this._init()}_init(){if(this._years=this.querySelectorAll(".timeline-item__year"),!this._years)return;this._timelineContainerEl=this.querySelector(".timeline__container"),this._isHorizontalTimeline=this.getAttribute("timeline-direction")==="horizontal",this._isHorizontalTimeline&&this._checkForLocationHash();const e={rootMargin:"-100px -100px -100px -100px",threshold:this._createThresholdList(50)};this.observer=new IntersectionObserver(this._handleObserver.bind(this),e),this._years.forEach(t=>{this.observer.observe(t)}),this.dispatchEvent(new CustomEvent("toujou-timeline-ready",{bubbles:!0,composed:!0,detail:this})),this.addEventListener(d,this._onLegendYearClick)}_handleObserver(e){const t=[];e.forEach(i=>{const n=i.target.id;n&&(t.push({yearId:n,isIntersecting:i.isIntersecting}),this.dispatchEvent(new CustomEvent(s,{bubbles:!0,composed:!0,detail:t})))})}_createThresholdList(e){return[...Array(e).keys()].map(t=>t/e)}_onLegendYearClick(e){const t=e.detail;t&&this._scrollToYear(t)}_scrollToYear(e){const t=this.querySelector(`#${e}`);if(!t)return;const i=t.closest(".timeline-item");if(!i)return;const n=i.offsetLeft;this._timelineContainerEl.scrollTo({left:n,behavior:"smooth"})}};o=a([h("toujou-timeline")],o);let l=class extends c{constructor(){super(...arguments),this.isActiveAttribute="is-active"}createRenderRoot(){return this}connectedCallback(){super.connectedCallback(),this._yearLinks=this.querySelectorAll(".timeline-legend__link"),this._yearLinks&&this._init()}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener(s,this._onTimelineObservations.bind(this))}_init(){window.addEventListener(s,this._onTimelineObservations.bind(this)),this._yearLinks.forEach(e=>{e.addEventListener("keyup",this._handleYearLinkKeyUp)}),this._isHorizontalTimeline=!!this.closest('.timeline[timeline-direction="horizontal"]'),this._isHorizontalTimeline&&this._initYearClicks(),this.dispatchEvent(new CustomEvent("toujou-timeline-legend-ready",{bubbles:!0,composed:!0,detail:this}))}_initYearClicks(){this._yearLinks.forEach(e=>{e.addEventListener("click",this._onYearLinkClick)})}_onTimelineObservations(e){const t=e.detail;t&&t.forEach(i=>{const n=this.querySelector(`.timeline-legend__link[href="#${i.yearId}"]`);n&&(i.isIntersecting?n.setAttribute(this.isActiveAttribute,""):n.removeAttribute(this.isActiveAttribute))})}_onYearLinkClick(e){let t;const i=e.currentTarget;if(!i)return;const n=i.href;if(!n)return;const r=n.split("#");r.length>1&&(t=r.pop()),t&&(e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent(d,{bubbles:!0,composed:!0,detail:t})))}_handleYearLinkKeyUp(e){(e.key==="Enter"||e.code==="Enter"||e.code==="Space"||e.key===" ")&&(e.preventDefault(),e.stopPropagation(),e.currentTarget.click())}};l=a([h("toujou-timeline-legend")],l);
//# sourceMappingURL=toujou-timeline.js.map
