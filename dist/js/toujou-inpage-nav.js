import{s as h,$ as c}from"./lit-element-8ef55b20.js";function u(s){let t=0;return Object.keys(s).forEach(e=>{const i=getComputedStyle(s[e].item),n=parseFloat(i.paddingLeft)+parseFloat(i.paddingRight);t+=s[e].item.offsetWidth+n}),t}function a(s){if(!s)return 0;if(s.classList.contains("inpage-nav__label")){const t=getComputedStyle(s),e=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight);return s.offsetWidth+e}return s.offsetWidth}function d(s,t,e,i){const n=u(s),r=a(t),l=a(e);return n+r+l*(i?3:1)}class o extends h{static get is(){return"toujou-inpage-nav"}render(){return c`
      <slot></slot>
      <slot name="cta" id="cta"></slot>
    `}static get properties(){return{isMobile:{type:Boolean,reflect:!0},mobileOpen:{type:Boolean,reflect:!0},_currentSectionID:{type:String},_targetSections:{type:Map}}}set _currentSectionID(t){this._navItems&&(t?this._previousCurrentSectionID!==t&&(this._updateLabelVisibility(t),this._updateNavItemsState(t)):(this._updateLabelVisibility(!1),this._updateNavItemsState(null)))}constructor(){super(),this.mobileBreakpointOffset=this._getMobileBreakpointOffset(),this._currentSectionID=null,this._previousCurrentSectionID=null,this._isCentered=this.hasAttribute("centered"),this._isAuto=this.hasAttribute("is-auto"),this._targetSections=new Map,this._rootMarginsSize=-200,setTimeout(()=>{this._init()})}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("resize",this._checkIsMobileState.bind(this)),this._toggle.removeEventListener("click",this._mobileOpenToggle.bind(this)),this.addEventListener("click",this._handleNavClick.bind(this))}attributeChangedCallback(t,e,i){super.attributeChangedCallback(t,e,i),(t==="ismobile"||t==="mobileopen")&&this._updateAriaAttributes(t,i)}_init(){if(this._getChildrenElements(),!this._navItems){console.error("Could not initialize the inpage-nav. Error: No nav items!!!");return}this._toggle=this.querySelector(".inpage-nav__toggle"),this._checkIsMobileState(),this._addTargetObservers(),window.addEventListener("resize",this._checkIsMobileState.bind(this)),this._toggle.addEventListener("click",this._mobileOpenToggle.bind(this)),this.addEventListener("click",this._handleNavClick.bind(this))}_getChildrenElements(){this._navItems={},this._navLabel=this.querySelector(".inpage-nav__label")||null,this._cta=this.querySelector('[slot="cta"]'),(this.querySelectorAll(".inpage-nav__item")||null).forEach((e,i)=>{const r=e.querySelector("a").getAttribute("href");this._navItems[i]={item:e,link:r,target:document.querySelector(r)}})}_checkIsMobileState(){this.isMobile=!1,window.requestAnimationFrame(()=>{this._navBreakpoint=d(this._navItems,this._navLabel,this._cta,this._isCentered),this.isMobile=this._navBreakpoint>this.offsetWidth-this.mobileBreakpointOffset})}_addTargetObservers(){const t={rootMargin:`${this._rootMarginsSize}px 0px ${this._rootMarginsSize}px 0px`,threshold:this._createThresholdList(50)};this.observer=new IntersectionObserver(this._handleObserver.bind(this),t),Object.keys(this._navItems).forEach(e=>{const i=this._navItems[e].target;if(!(i instanceof HTMLElement))return;this._targetSections.set(i,!1);const n=i.hasAttribute("id")?i:i.nextElementSibling;this.observer.observe(n)})}_createThresholdList(t){return[...Array(t).keys()].map(e=>e/t)}_handleObserver(t){t.forEach(e=>{this._targetSections.set(e.target,e.isIntersecting)}),this._updateSectionsAttributes(),this._updateActiveItemUI()}_updateSectionsAttributes(){let t=!1;this._targetSections.forEach((e,i)=>{i.toggleAttribute("inpageNavTargetVisible",t?!1:e),e&&!t&&(t=e)})}_updateActiveItemUI(){const t=document.querySelector("*[inpageNavTargetVisible]")||null;t?this._currentSectionID=`#${t.id.toString()}`:!t&&this._navLabel?this._currentSectionID=null:!t&&!this._navLabel&&(this._currentSectionID=this._navItems[0].link)}_mobileOpenToggle(){this.mobileOpen=!this.mobileOpen}_handleNavClick(t){t.target.classList.contains("inpage-nav__link")&&(this.mobileOpen=!1)}_updateAriaAttributes(t){t==="mobileopen"?this._toggle.setAttribute("aria-expanded",this.mobileOpen):t==="ismobile"&&this._toggle.setAttribute("aria-hidden",!this.isMobile)}_updateLabelVisibility(t){this._navLabel&&(t?this._navLabel.removeAttribute("visible"):this._navLabel.setAttribute("visible",""))}_updateNavItemsState(t){const e=this.querySelector(".inpage-nav__item[active]");e&&(e.removeAttribute("active"),e.removeAttribute("aria-current")),Object.keys(this._navItems).forEach(i=>{this._navItems[i].link===t&&(this._navItems[i].item.setAttribute("active",""),this._navItems[i].item.setAttribute("aria-current","true"))}),this._previousCurrentSectionID=t}_getMobileBreakpointOffset(){const t=getComputedStyle(document.documentElement);return parseInt(t.getPropertyValue("--toujou-inpage-nav-breakpoint-offset")||180,10)}}customElements.define(o.is,o);
//# sourceMappingURL=toujou-inpage-nav.js.map
