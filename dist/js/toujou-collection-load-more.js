import{_ as e}from"./tslib.es6-Br7-PHSQ.js";import{i as t,s as o,x as n}from"./lit-element-CHDbfp5U.js";import{n as i}from"./property-BjK_DIN0.js";import"./query-assigned-elements-DqqHV3QO.js";var r,s,l,c=t(r||(s=[":host {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-pack: center;\n        -ms-flex-pack: center;\n            justify-content: center;\n}\n"],l||(l=s.slice(0)),r=Object.freeze(Object.defineProperties(s,{raw:{value:Object.freeze(l)}}))));class a extends o{constructor(){super(...arguments),this.isLoading=!1,this.itemsContainerSelector=""}static get is(){return"toujou-collection-load-more"}render(){return this.isLoading?n`<slot name="spinner"></slot>`:n`<slot @click="${this._handleLoadMoreClick}"></slot>`}_handleLoadMoreClick(e){let t;e.preventDefault();const o=e.target;if(null===o)return;const n=o.getAttribute("href");if(null===n||""===n)throw"Missing or empty href on toujou-collection-load-more link";const i=new URL(n,document.baseURI).href;this.isLoading=!0,fetch(i).then((e=>e.text())).then((e=>{const t=document.createElement("div");return t.innerHTML=e,t})).then((e=>{const o=[].slice.call(e.querySelector(this.itemsContainerSelector).children),n=o[0];t=null==n?void 0:n.querySelector("a");const i=e.querySelector(a.is);document.querySelector(this.itemsContainerSelector).append(...o),i?this.replaceWith(i):this.remove()})).catch((e=>{window.dispatchEvent(new CustomEvent("toujou-collection-load-more-error",{bubbles:!0,composed:!0,detail:e}))})).finally((()=>{this.isLoading=!1,t&&requestAnimationFrame((()=>{t.focus()})),window.dispatchEvent(new CustomEvent("toujou-collection-load-more-done",{bubbles:!0,composed:!0}))}))}}a.styles=[c],e([i({type:Boolean,reflect:!0,attribute:"is-loading"})],a.prototype,"isLoading",void 0),e([i({type:String,attribute:"items-container-selector"})],a.prototype,"itemsContainerSelector",void 0),customElements.define(a.is,a);
//# sourceMappingURL=toujou-collection-load-more.js.map
