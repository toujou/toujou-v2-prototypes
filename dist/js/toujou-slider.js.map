{"version":3,"file":"toujou-slider.js","sources":["../../src/components/toujou-slider/toujou-slider.ts"],"sourcesContent":["import { LitElement } from 'lit'\nimport { customElement, property, state } from 'lit/decorators.js'\n// @ts-ignore\nimport Splide from \"@splidejs/splide\";\n\n@customElement('toujou-slider')\nexport class ToujouSlider extends LitElement {\n\n    /**\n     * Reference to the node that where the slider will be initialized (\".splide\")\n     */\n    @property({ type: Object })\n    splideContainer: Element | null = null;\n\n    /**\n     * Show or hide the count at the bottom of the slider\n     */\n    @property({ type: Boolean, attribute: 'show-count' })\n    showCount: Boolean = false;\n\n    /**\n     * Toggle on / off the autoplay function\n     */\n    @property({ type: Boolean, attribute: 'auto-play' })\n    autoplay: Boolean = false;\n\n    /**\n     * Count element where we display the number of the current active slide\n     * @private\n     */\n    @property()\n    private _currentIndexCountElement: HTMLElement | null = null;\n\n    /**\n     * Count element where we should the total number of slider\n     * @private\n     */\n    @property()\n    private _totalSlidesCountElement: HTMLElement | null = null;\n\n    /**\n     * Total number of slides on the page, to be used on the count element\n     * @private\n     */\n    @state()\n    private _numberOfSlides: Number = 0;\n\n    /**\n     * Index of currently active slide, to be used on the count element\n     * @private\n     */\n    @state()\n    private _activeSlideIndex: Number = 1;\n\n    /**\n     * Reference to the Splice instance\n     * @private\n     */\n    @property()\n    private splideSlider: any;\n\n    /**\n     * Number of slides to show per \"page\"\n     * Docs: https://splidejs.com/guides/options/#perpage\n     */\n    @property({ reflect: true, attribute: 'slides-to-show' })\n    slidesToShow: number = 1;\n\n    /**\n     * Number of slider to advance per move\n     * Docs: https://splidejs.com/guides/options/#permove\n     */\n    @property({ reflect: true, attribute: 'slides-per-move' })\n    slidesPerMove: number = 1;\n\n    /**\n     * Type of slider. Valid values are \"loop\", \"slide\" and \"fade\"\n     * Docs: https://splidejs.com/guides/options/#type\n     */\n    @property({ reflect: true, attribute: 'slider-type' })\n    sliderType: 'loop' | 'slide' | 'fade' = 'loop';\n\n    /**\n     * Gap between the slides\n     * Docs: https://splidejs.com/guides/options/#gap\n     */\n    @property({ reflect: true, attribute: 'slider-gap' })\n    sliderGap: string = '0';\n\n    /**\n     * Duration between automatic moves when autoplay is active\n     * Docs: https://splidejs.com/guides/options/#interval\n     */\n    @property({ reflect: true, attribute: 'auto-play-interval' })\n    autoplayInterval: string = '6000';\n\n    /**\n     * Stringified JSON with object defining the breakpoints for the slider\n     * Docs: https://splidejs.com/guides/options/#breakpoints\n     */\n    @property({ reflect: true, attribute: 'slider-breakpoints' })\n    sliderBreakpoints: string | null = null;\n\n    /**\n     * Carousel padding\n     * https://splidejs.com/guides/options/#padding\n     */\n    @property({ reflect: true, attribute: 'slider-padding' })\n    sliderPadding: string = '0';\n\n    /**\n     * Center the active slide\n     * https://splidejs.com/guides/options/#focus\n     * https://splidejs.com/guides/options/#trimspace\n     */\n    @property({ reflect: true, attribute: 'slider-focus-center' })\n    sliderFocusCenter: string | boolean = false;\n\n    /**\n     * Define the aspect ratio of the images on the carousel\n     * https://splidejs.com/guides/options/#heightratio\n     */\n    @property({ reflect: true, attribute: 'slider-aspect-ratio' })\n    sliderAspectRatio: string = '0.5625';\n\n    /**\n     * Number of clones to be created on each side of the carousel\n     * Docs: https://splidejs.com/guides/options/#clones\n     */\n    @property({ reflect: true, attribute: 'slider-clones-amount' })\n    sliderClonesAmount: number | null = null;\n\n    @property({ attribute: 'arrow-prev-aria-label' })\n    arrowPrevAriaLabel: string = '';\n\n    @property({ attribute: 'arrow-next-aria-label' })\n    arrowNextAriaLabel: string = '';\n\n    @property({ attribute: 'arrow-first-aria-label' })\n    arrowFirstAriaLabel: string = '';\n\n    @property({ attribute: 'arrow-last-aria-label' })\n    arrowLastAriaLabel: string = '';\n\n    @property({ attribute: 'bullets-list-aria-label' })\n    bulletsListAriaLabel: string = '';\n\n    @property({ attribute: 'single-bullet-aria-label' })\n    singleBulletAriaLabel: string = '';\n\n    /**\n     * If 'min', the media query for breakpoints will be min-width, or otherwise max-width.\n     * Docs: https://splidejs.com/guides/options/#mediaquery\n     */\n    @property({ reflect: true, attribute: 'slider-media-query' })\n    sliderMediaQuery: 'min' | 'max' = 'max';\n\n    constructor() {\n        super();\n\n        this._handlePaginationUpdate = this._handlePaginationUpdate.bind(this);\n        this._handleSliderMount = this._handleSliderMount.bind(this);\n    }\n\n    /**\n     * Disable shadow root\n     */\n    createRenderRoot() {\n        return this;\n    }\n\n    firstUpdated() {\n        this.splideContainer = this.querySelector('.splide') || null;\n\n        if (!this.splideContainer) {\n            console.error(\"TOUJOU: Could not get necessary elements to initialize the slider\");\n            return;\n        } else {\n            this._initSlider();\n        }\n    }\n\n    /**\n     * Build the i18n configuration object for Splide.\n     * Only aria-label strings that are explicitly provided via attributes are added to the returned object.\n     *\n     * @private\n     */\n    private _buildI18nOptions() {\n        const i18n: Record<string, string> = {};\n\n        if (this.arrowPrevAriaLabel) {\n            i18n.prev = this.arrowPrevAriaLabel;\n        }\n\n        if (this.arrowNextAriaLabel) {\n            i18n.next = this.arrowNextAriaLabel;\n        }\n\n        if (this.arrowFirstAriaLabel) {\n            i18n.first = this.arrowFirstAriaLabel;\n        }\n\n        if (this.arrowLastAriaLabel) {\n            i18n.last = this.arrowLastAriaLabel;\n        }\n\n        if (this.bulletsListAriaLabel) {\n            i18n.select = this.bulletsListAriaLabel;\n        }\n\n        if (this.singleBulletAriaLabel) {\n            i18n.slideX = `${this.singleBulletAriaLabel} %s`;\n        }\n\n        return Object.keys(i18n).length ? i18n : undefined;\n    }\n\n    /**\n     * Initialize the slider with the correct options\n     * Full list of options here: https://splidejs.com/guides/options/\n     */\n    private _initSlider() {\n        let sliderOptions = {\n            classes: {\n                pagination: 'splide__pagination slider-bullets',\n                page: 'splide__pagination__page slider-bullets__bullet',\n            },\n            type: this.sliderType,\n            autoplay: this.autoplay,\n            interval: this.autoplayInterval,\n            pauseOnHover: this.autoplay,\n            pauseOnFocus: this.autoplay,\n            perPage: parseInt(String(this.slidesToShow)),\n            perMove: this.slidesPerMove,\n            gap: this.sliderGap,\n            heightRatio: this.sliderAspectRatio,\n            mediaQuery: this.sliderMediaQuery,\n            reducedMotion: {\n                speed: 0,\n                rewindSpeed: 0,\n                autoplay: 'pause'\n            },\n            padding: this.sliderPadding,\n            i18n: this._buildI18nOptions(),\n            focusableNodes: '*',\n            breakpoints: undefined,\n        }\n\n        if (this.sliderFocusCenter === 'true') {\n            // @ts-ignore\n            sliderOptions.focus = 'center';\n            // @ts-ignore\n            sliderOptions.trimSpace = false;\n        }\n\n        if (this.sliderBreakpoints) {\n            try {\n                sliderOptions.breakpoints = JSON.parse(this.sliderBreakpoints);\n            } catch (error) {\n                console.error('Error parsing slider breakpoints JSON:', error, '\\n', 'Received breakpoints JSON:', '\\n', this.sliderBreakpoints);\n            }\n        }\n\n        if (this.sliderClonesAmount) {\n            // @ts-ignore\n            sliderOptions.clones = this.sliderClonesAmount;\n        }\n\n        // @ts-ignore\n        this.splideSlider = new Splide(this.splideContainer, sliderOptions);\n\n        this.splideSlider!.on('mounted', this._handleSliderMount);\n        this.splideSlider!.on('moved', this._handlePaginationUpdate);\n\n        this.splideSlider!.mount();\n    }\n\n    /**\n     * Setup the count element when the element first mounts\n     */\n    private _handleSliderMount() {\n        this._getCountInfo();\n        this._initCount();\n        this._removeSlidesTabpanelRole();\n        this._addAriaLabelToSliderContainer();\n\n        this.dispatchEvent(new CustomEvent('toujou-slider-mounted', {\n            bubbles: true,\n            composed: true,\n            detail: {\n                el: this.splideSlider\n            }\n        }));\n    }\n\n    /**\n     * Remove the \"tabpanel\" role from slides to fix accessibility error\n     * @private\n     */\n    private _removeSlidesTabpanelRole() {\n        const elsWithPanelTabRole = this.splideSlider.root.querySelectorAll('*[role=\"tabpanel\"]');\n        if (!elsWithPanelTabRole) return;\n\n        elsWithPanelTabRole.forEach((el: HTMLElement) => {\n            el.removeAttribute('role');\n            el.removeAttribute('aria-label');\n        });\n    }\n\n    /**\n     * Add an aria-label attribute to the slider container element to fix a11y error\n     * @private\n     */\n    private _addAriaLabelToSliderContainer() {\n        const containerId = this.splideContainer?.id;\n        this.splideContainer?.setAttribute('aria-label', `Slider - ${containerId}`)\n    }\n\n    /**\n     * Get the DOM elements that are used to display the count information\n     */\n    private _getCountInfo() {\n        this._currentIndexCountElement = this.querySelector('.slider-count__current');\n        this._totalSlidesCountElement = this.querySelector('.slider-count__total');\n    }\n\n    /**\n     * Initialize the count element and update count elements in the DOM\n     */\n    private _initCount() {\n        this._numberOfSlides = this.splideSlider.Components.Elements.slides.length;\n        this._updateSliderCount();\n    }\n\n    /**\n     * Trigger a count update whenever the pagination updates\n     * @param event\n     */\n    private _handlePaginationUpdate(event: number) {\n        this._activeSlideIndex = event + 1;\n        this._updateSliderCount();\n\n        this.dispatchEvent(new CustomEvent('toujou-slider-moved', {\n            bubbles: true,\n            composed: true,\n            detail: {\n                el: this.splideSlider,\n                activeIndex: this._activeSlideIndex\n            }\n        }));\n    }\n\n    /**\n     * Update the count elements with the correct content\n     */\n    private _updateSliderCount() {\n        if (this._currentIndexCountElement) {\n            this._currentIndexCountElement.textContent = String(this._activeSlideIndex);\n        }\n\n        if (this._totalSlidesCountElement) {\n            this._totalSlidesCountElement.textContent = String(this._numberOfSlides);\n        }\n    }\n}\n\ndeclare global {\n    interface HTMLElementTagNameMap {\n        'toujou-slider': ToujouSlider\n    }\n}\n"],"names":["ToujouSlider","LitElement","constructor","super","this","splideContainer","showCount","autoplay","_currentIndexCountElement","_totalSlidesCountElement","_numberOfSlides","_activeSlideIndex","slidesToShow","slidesPerMove","sliderType","sliderGap","autoplayInterval","sliderBreakpoints","sliderPadding","sliderFocusCenter","sliderAspectRatio","sliderClonesAmount","arrowPrevAriaLabel","arrowNextAriaLabel","arrowFirstAriaLabel","arrowLastAriaLabel","bulletsListAriaLabel","singleBulletAriaLabel","sliderMediaQuery","_handlePaginationUpdate","bind","_handleSliderMount","createRenderRoot","firstUpdated","querySelector","_initSlider","console","error","_buildI18nOptions","i18n","prev","next","first","last","select","slideX","Object","keys","length","sliderOptions","classes","pagination","page","type","interval","pauseOnHover","pauseOnFocus","perPage","parseInt","String","perMove","gap","heightRatio","mediaQuery","reducedMotion","speed","rewindSpeed","padding","focusableNodes","breakpoints","focus","trimSpace","JSON","parse","clones","splideSlider","Splide","on","mount","_getCountInfo","_initCount","_removeSlidesTabpanelRole","_addAriaLabelToSliderContainer","dispatchEvent","CustomEvent","bubbles","composed","detail","el","elsWithPanelTabRole","root","querySelectorAll","forEach","removeAttribute","containerId","_a","id","_b","setAttribute","Components","Elements","slides","_updateSliderCount","event","activeIndex","textContent","__decorateClass","property","prototype","Boolean","attribute","state","reflect","customElement"],"mappings":"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"}