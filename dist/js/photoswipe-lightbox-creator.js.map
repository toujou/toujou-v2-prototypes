{"version":3,"file":"photoswipe-lightbox-creator.js","sources":["../../src/js/elements/photoswipe-lightbox-creator.ts"],"sourcesContent":["import PhotoSwipe from 'photoswipe';\n// @ts-expect-error\nimport PhotoSwipeLightbox from 'photoswipe/lightbox';\n// @ts-expect-error\nimport PhotoSwipeVideoPlugin from 'photoswipe-video-plugin';\n\n// Create a global object to hold the element's variables and config\nconst pswpLightboxCreator = {\n    items: [] as HTMLElement[],\n    parents: new Set<HTMLElement>(),\n    lightboxes: new Set<PhotoSwipeLightbox>(),\n    parentIdAttribute: 'lightbox-parent-id',\n    itemIdAttribute: 'lightbox-item-id',\n}\n\n/**\n * Initialize the element by getting add lightbox items from the page\n */\nfunction initPhotoswipeLightboxCreator() {\n    pswpLightboxCreator.items = Array.from(document.querySelectorAll(`[${pswpLightboxCreator.itemIdAttribute}]`));\n\n    pswpLightboxCreator.items.forEach((item) => {\n        const itemLightboxParent = item.closest(`[${pswpLightboxCreator.parentIdAttribute}]`) as HTMLElement;\n        pswpLightboxCreator.parents.add(itemLightboxParent);\n    });\n\n    _initParents();\n}\n\n/**\n * Initialize a lightbox element for each of the lightbox parent element\n */\nfunction _initParents() {\n    pswpLightboxCreator.parents.forEach((parent) => {\n        _initLightbox(parent);\n    })\n}\n\n/**\n * Initialize  single instance of a PhotoSwipe lightbox\n * @param {HTMLElement} parent\n */\nfunction _initLightbox(parent: HTMLElement) {\n    const lightbox: PhotoSwipeLightbox = new PhotoSwipeLightbox({\n        gallery: parent,\n        children: `[${pswpLightboxCreator.itemIdAttribute}]`,\n        pswpModule: PhotoSwipe,\n        allowPanToNext: true,\n        preloaderDelay: 0,\n    })\n\n    lightbox.on('uiRegister', () => _handleUiRegister(lightbox));\n\n    lightbox.videoPlugin = new PhotoSwipeVideoPlugin(lightbox, {\n        autoplay: false\n    });\n\n    lightbox.init();\n\n    pswpLightboxCreator.lightboxes.add(lightbox);\n}\n\n/**\n * Set up the lightbox to show the required elements\n * @param {PhotoSwipeLightbox} lightbox\n */\nfunction _handleUiRegister(lightbox: PhotoSwipeLightbox): void {\n    lightbox.pswp.ui.registerElement({\n        name: 'caption',\n        order: 9,\n        isButton: false,\n        appendTo: 'root',\n        onInit: (el: HTMLElement) => {\n            lightbox.pswp.on('change', () => _handleChange(el, lightbox));\n        },\n    });\n}\n\n/**\n * Replace the lightbox caption with the image's title text\n * @param {HTMLElement} el\n * @param {PhotoSwipeLightbox} lightbox\n */\nfunction _handleChange(el: HTMLElement, lightbox: PhotoSwipeLightbox): void {\n    let captionText = '';\n    const currSlideElement = lightbox.pswp.currSlide.data.element;\n\n    if (currSlideElement) {\n        captionText = currSlideElement.getAttribute('title');\n    }\n\n    el.textContent = captionText ? captionText : '';\n}\n\n/**\n * Wait for the page to completely load before initializing the photoswipe-lightbox-creator script\n */\nif (document.readyState === \"complete\" || document.readyState === \"interactive\") {\n    setTimeout(() => {\n        initPhotoswipeLightboxCreator();\n    });\n} else {\n    document.addEventListener(\"DOMContentLoaded\", () => {\n        initPhotoswipeLightboxCreator();\n    });\n}\n"],"names":["pswpLightboxCreator","initPhotoswipeLightboxCreator","item","itemLightboxParent","_initParents","parent","_initLightbox","lightbox","PhotoSwipeLightbox","PhotoSwipe","_handleUiRegister","PhotoSwipeVideoPlugin","el","_handleChange","captionText","currSlideElement"],"mappings":"sDAOA,MAAMA,EAAsB,CACxB,MAAO,CAAC,EACR,YAAa,IACb,eAAgB,IAChB,kBAAmB,qBACnB,gBAAiB,kBACrB,EAKA,SAASC,GAAgC,CACjBD,EAAA,MAAQ,MAAM,KAAK,SAAS,iBAAiB,IAAIA,EAAoB,kBAAkB,CAAC,EAExFA,EAAA,MAAM,QAASE,GAAS,CACxC,MAAMC,EAAqBD,EAAK,QAAQ,IAAIF,EAAoB,oBAAoB,EAChEA,EAAA,QAAQ,IAAIG,CAAkB,CAAA,CACrD,EAEYC,GACjB,CAKA,SAASA,GAAe,CACAJ,EAAA,QAAQ,QAASK,GAAW,CAC5CC,EAAcD,CAAM,CAAA,CACvB,CACL,CAMA,SAASC,EAAcD,EAAqB,CAClC,MAAAE,EAA+B,IAAIC,EAAmB,CACxD,QAASH,EACT,SAAU,IAAIL,EAAoB,mBAClC,WAAYS,EACZ,eAAgB,GAChB,eAAgB,CAAA,CACnB,EAEDF,EAAS,GAAG,aAAc,IAAMG,EAAkBH,CAAQ,CAAC,EAElDA,EAAA,YAAc,IAAII,EAAsBJ,EAAU,CACvD,SAAU,EAAA,CACb,EAEDA,EAAS,KAAK,EAEMP,EAAA,WAAW,IAAIO,CAAQ,CAC/C,CAMA,SAASG,EAAkBH,EAAoC,CAClDA,EAAA,KAAK,GAAG,gBAAgB,CAC7B,KAAM,UACN,MAAO,EACP,SAAU,GACV,SAAU,OACV,OAASK,GAAoB,CACzBL,EAAS,KAAK,GAAG,SAAU,IAAMM,EAAcD,EAAIL,CAAQ,CAAC,CAChE,CAAA,CACH,CACL,CAOA,SAASM,EAAcD,EAAiBL,EAAoC,CACxE,IAAIO,EAAc,GAClB,MAAMC,EAAmBR,EAAS,KAAK,UAAU,KAAK,QAElDQ,IACcD,EAAAC,EAAiB,aAAa,OAAO,GAGpDH,EAAA,YAAcE,GAA4B,EACjD,CAKI,SAAS,aAAe,YAAc,SAAS,aAAe,cAC9D,WAAW,IAAM,CACiBb,GAAA,CACjC,EAEQ,SAAA,iBAAiB,mBAAoB,IAAM,CAClBA,GAAA,CACjC"}