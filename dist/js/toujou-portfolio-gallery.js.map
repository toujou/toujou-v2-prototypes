{"version":3,"file":"toujou-portfolio-gallery.js","sources":["../../src/components/toujou-portfolio-gallery/toujou-portfolio-gallery.styles.ts","../../src/components/toujou-portfolio-gallery/toujou-portfolio-gallery.ts"],"sourcesContent":["import { css } from 'lit';\n\nexport const ToujouPortfolioGalleryStyles = css`\n  * {\n    box-sizing: border-box;\n  }\n\n  :host {\n    position: relative;\n  }\n`;","import { LitElement, html } from 'lit'\nimport { customElement, property } from 'lit/decorators.js'\nimport { ToujouPortfolioGalleryStyles } from \"./toujou-portfolio-gallery.styles.js\";\nimport PhotoSwipe from 'photoswipe';\n// @ts-ignore\nimport PhotoSwipeLightbox from 'photoswipe/lightbox';\n// @ts-ignore\nimport PhotoSwipeVideoPlugin from 'photoswipe-video-plugin';\n\n@customElement('toujou-portfolio-gallery')\nexport class ToujouPortfolioGallery extends LitElement {\n    static styles = [ ToujouPortfolioGalleryStyles ];\n\n    @property({ type: Number }) _currentImageIndex: number = 1;\n    @property({ type: Number }) _imageCount: number | undefined = 0;\n    private lightbox: any;\n    protected videoPlugin: any;\n\n    /**\n     * Get the child elements of the slider\n     */\n    get #sliderContent() {\n        const sliderSlot = this.shadowRoot?.querySelector('#slider') as HTMLSlotElement;\n        if (!sliderSlot) return null;\n\n        const sliderElements = sliderSlot.assignedElements({ flatten: true });\n        return sliderElements[0] || null;\n    }\n\n    /**\n     * Get the first image link inside the slider\n     */\n    get #firstSliderImageLink() {\n        const firstImage = this.#sliderContent?.querySelector('a.slider__item') as HTMLAnchorElement;\n        return  firstImage || null;\n    }\n\n    /**\n     * Get the portfolio id, so we can create a unique lightbox\n     * @private\n     */\n    get #portfolioGalleryID() {\n        const portfolioGalleryID = this.getAttribute('id');\n        return portfolioGalleryID ? `#${portfolioGalleryID}` : undefined;\n    }\n\n    /**\n     * Initialize the lightbox when the portfolio gallery element first loads\n     */\n    connectedCallback() {\n        super.connectedCallback();\n\n        this._initializeLightbox();\n    }\n\n    /**\n     * Render the slots for the element's content\n     */\n    render() {\n        return html`\n            <slot id=\"slider\" name=\"slider\"></slot>\n            <slot id=\"button\" name=\"button\" @click=\"${this._handleButtonClick}\"></slot>\n        `\n    }\n\n    /**\n     * Initialize the lightbox with the correct settings\n     */\n    _initializeLightbox() {\n        this.lightbox = new PhotoSwipeLightbox({\n            gallery: this.#portfolioGalleryID,\n            children: '.slider-slide',\n            pswpModule: PhotoSwipe,\n            allowPanToNext: true,\n            preloaderDelay: 0,\n        })\n\n        this.lightbox.on('uiRegister', () => this._handleLightboxUiRegister());\n\n        this.videoPlugin = new PhotoSwipeVideoPlugin(this.lightbox, {\n            autoplay: false\n        });\n\n        this.lightbox.init();\n    }\n\n    /**\n     * Add the caption text to the lightbox\n     */\n    _handleLightboxUiRegister = () => {\n        this.lightbox.pswp.ui.registerElement({\n            name: 'caption',\n            order: 9,\n            isButton: false,\n            appendTo: 'root',\n            onInit: (el: HTMLElement) => {\n                this.lightbox.pswp.on('change', () => this._handleLightboxChange(el));\n            },\n        });\n    }\n\n    /**\n     * React to change on the lightbox so that we can add the correct caption text\n     * @param {HTMLElement} el\n     */\n    _handleLightboxChange = (el: HTMLElement) => {\n        let captionText = '';\n        const currSlideElement = this.lightbox.pswp.currSlide.data.element || null;\n        const currSlideLink = currSlideElement?.querySelector('a.slider__item') || null;\n        if (currSlideLink) {\n            captionText = currSlideLink.getAttribute('title');\n        }\n\n        el.textContent = captionText ? captionText : '';\n    }\n\n    /**\n     * Open lightbox when the button is clicked\n     */\n    _handleButtonClick() {\n        const currentVisibleImageLink = this.#sliderContent?.querySelector('.slider-slide.is-active.is-visible .slider__item') as HTMLAnchorElement;\n        currentVisibleImageLink\n            ? currentVisibleImageLink.click()\n            : this.#firstSliderImageLink.click();\n    }\n}\n\ndeclare global {\n    interface HTMLElementTagNameMap {\n        'toujou-portfolio-gallery': ToujouPortfolioGallery\n    }\n}\n"],"names":["ToujouPortfolioGalleryStyles","css","_sliderContent","sliderContent_get","_firstSliderImageLink","firstSliderImageLink_get","_portfolioGalleryID","portfolioGalleryID_get","ToujouPortfolioGallery","LitElement","__privateAdd","el","captionText","currSlideElement","currSlideLink","html","PhotoSwipeLightbox","__privateGet","PhotoSwipe","PhotoSwipeVideoPlugin","currentVisibleImageLink","_a","sliderSlot","portfolioGalleryID","__decorateClass","property","customElement"],"mappings":"uPAEO,MAAMA,EAA+BC;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,mcCF5CC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAUa,IAAAC,EAAN,cAAqCC,CAAW,CAAhD,aAAA,CAAA,MAAA,GAAA,SAAA,EAWCC,EAAA,KAAAR,CAAA,EAWAQ,EAAA,KAAAN,CAAA,EASAM,EAAA,KAAAJ,CAAA,EA5BqD,KAAA,mBAAA,EACK,KAAA,YAAA,EA2E9D,KAAA,0BAA4B,IAAM,CACzB,KAAA,SAAS,KAAK,GAAG,gBAAgB,CAClC,KAAM,UACN,MAAO,EACP,SAAU,GACV,SAAU,OACV,OAASK,GAAoB,CACpB,KAAA,SAAS,KAAK,GAAG,SAAU,IAAM,KAAK,sBAAsBA,CAAE,CAAC,CACxE,CAAA,CACH,CAAA,EAOL,KAAA,sBAAyBA,GAAoB,CACzC,IAAIC,EAAc,GAClB,MAAMC,EAAmB,KAAK,SAAS,KAAK,UAAU,KAAK,SAAW,KAChEC,GAAgBD,GAAA,YAAAA,EAAkB,cAAc,oBAAqB,KACvEC,IACcF,EAAAE,EAAc,aAAa,OAAO,GAGjDH,EAAA,YAAcC,GAA4B,EAAA,CACjD,CAjEA,mBAAoB,CAChB,MAAM,kBAAkB,EAExB,KAAK,oBAAoB,CAC7B,CAKA,QAAS,CACE,OAAAG;AAAAA;AAAAA,sDAEuC,KAAK;AAAA,SAEvD,CAKA,qBAAsB,CACb,KAAA,SAAW,IAAIC,EAAmB,CACnC,QAASC,EAAK,KAAAX,EAAAC,CAAA,EACd,SAAU,gBACV,WAAYW,EACZ,eAAgB,GAChB,eAAgB,CAAA,CACnB,EAED,KAAK,SAAS,GAAG,aAAc,IAAM,KAAK,2BAA2B,EAErE,KAAK,YAAc,IAAIC,EAAsB,KAAK,SAAU,CACxD,SAAU,EAAA,CACb,EAED,KAAK,SAAS,MAClB,CAmCA,oBAAqB,OACjB,MAAMC,GAA0BC,EAAAJ,EAAA,KAAKf,EAAgBC,CAAA,IAArB,YAAAkB,EAAqB,cAAc,oDACnED,EACMA,EAAwB,MAAA,EACxBH,EAAA,KAAKb,KAAsB,OACrC,CACJ,EAxGQF,EAAA,IAAA,QAAAC,EAAc,UAAG,OACjB,MAAMmB,GAAaD,EAAA,KAAK,aAAL,YAAAA,EAAiB,cAAc,WAClD,OAAKC,GAEkBA,EAAW,iBAAiB,CAAE,QAAS,GAAM,EAC9C,CAAC,GAAK,IAChC,EAKIlB,EAAA,IAAA,QAAAC,EAAqB,UAAG,OAExB,QADmBgB,EAAAJ,EAAA,KAAKf,EAAgBC,CAAA,IAArB,YAAAkB,EAAqB,cAAc,oBAChC,IAC1B,EAMIf,EAAA,IAAA,QAAAC,EAAmB,UAAG,CAChB,MAAAgB,EAAqB,KAAK,aAAa,IAAI,EAC1C,OAAAA,EAAqB,IAAIA,IAAuB,MAC3D,EAlCSf,EACF,OAAS,CAAER,CAA6B,EAEnBwB,EAAA,CAA3BC,EAAS,CAAE,KAAM,OAAQ,CAAA,EAHjBjB,EAGmB,UAAA,qBAAA,CAAA,EACAgB,EAAA,CAA3BC,EAAS,CAAE,KAAM,OAAQ,CAAA,EAJjBjB,EAImB,UAAA,cAAA,CAAA,EAJnBA,EAANgB,EAAA,CADNE,EAAc,0BAA0B,CAAA,EAC5BlB,CAAA"}