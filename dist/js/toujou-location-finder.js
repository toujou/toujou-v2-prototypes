import{A as t,T as e,s as o,x as n,i}from"./lit-element-CHDbfp5U.js";import{i as r}from"./maplibre-gl-B_iD9WI-.js";import{c as a,a as s,b as l,d as c}from"./redux-CCeFiJMx.js";import{i as u,t as d,e as p}from"./directive-BOwRBK0N.js";import"./_commonjsHelpers-lGe4XDVY.js";function h(t,e,o,n){return new(o||(o=Promise))((function(i,r){function a(t){try{l(n.next(t))}catch(e){r(e)}}function s(t){try{l(n.throw(t))}catch(e){r(e)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;var g,f,m="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function v(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function b(){if(f)return g;f=1,g=function(){for(var e={},o=0;o<arguments.length;o++){var n=arguments[o];for(var i in n)t.call(n,i)&&(e[i]=n[i])}return e};var t=Object.prototype.hasOwnProperty;return g}var _,y,j,w,x,k,E,L={exports:{}};function P(){if(x)return w;x=1;var t=b(),e=function(){return _||(_=1,L.exports=t={},t.simpleFilter=function(e,o){return o.filter((function(o){return t.test(e,o)}))},t.test=function(e,o){return null!==t.match(e,o)},t.match=function(t,e,o){o=o||{};var n,i=0,r=[],a=e.length,s=0,l=0,c=o.pre||"",u=o.post||"",d=o.caseSensitive&&e||e.toLowerCase();t=o.caseSensitive&&t||t.toLowerCase();for(var p=0;p<a;p++)n=e[p],d[p]===t[i]?(n=c+n+u,i+=1,l+=1+l):l=0,s+=l,r[r.length]=n;return i===t.length?(s=d===t?1/0:s,{rendered:r.join(""),score:s}):null},t.filter=function(e,o,n){return o&&0!==o.length?"string"!=typeof e?o:(n=n||{},o.reduce((function(o,i,r,a){var s=i;n.extract&&(s=n.extract(i));var l=t.match(e,s,n);return null!=l&&(o[o.length]={string:l.rendered,score:l.score,index:r,original:i}),o}),[]).sort((function(t,e){return e.score-t.score||t.index-e.index}))):[]}),L.exports;var t}(),o=function(){if(j)return y;j=1;var t=function(t){return this.component=t,this.items=[],this.active=t.options.noInitialSelection?-1:0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,t.el.parentNode.insertBefore(this.wrapper,t.el.nextSibling),this};return t.prototype.show=function(){this.element.style.display="block"},t.prototype.hide=function(){this.element.style.display="none"},t.prototype.add=function(t){this.items.push(t)},t.prototype.clear=function(){this.items=[],this.active=this.component.options.noInitialSelection?-1:0},t.prototype.isEmpty=function(){return!this.items.length},t.prototype.isVisible=function(){return"block"===this.element.style.display},t.prototype.draw=function(){if(this.element.innerHTML="",0!==this.items.length){for(var t=0;t<this.items.length;t++)this.drawItem(this.items[t],this.active===t);this.show()}else this.hide()},t.prototype.drawItem=function(t,e){var o=document.createElement("li"),n=document.createElement("a");e&&(o.className+=" active"),n.innerHTML=t.string,o.appendChild(n),this.element.appendChild(o),o.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),o.addEventListener("mouseup",function(){this.handleMouseUp.call(this,t)}.bind(this))},t.prototype.handleMouseUp=function(t){this.selectingListItem=!1,this.component.value(t.original),this.clear(),this.draw()},t.prototype.move=function(t){this.active=t,this.draw()},t.prototype.previous=function(){this.move(this.active<=0?this.items.length-1:this.active-1)},t.prototype.next=function(){this.move(this.active>=this.items.length-1?0:this.active+1)},t.prototype.drawError=function(t){var e=document.createElement("li");e.innerHTML=t,this.element.appendChild(e),this.show()},y=t}(),n=function(e,n,i){return i=i||{},this.options=t({minLength:2,limit:5,filter:!0,hideOnBlur:!0,noInitialSelection:!0},i),this.el=e,this.data=n||[],this.list=new o(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(t){this.handleKeyUp(t.keyCode,t)}.bind(this),!1),this.el.addEventListener("keydown",function(t){this.handleKeyDown(t)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this.el.addEventListener("paste",function(t){this.handlePaste(t)}.bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};return n.prototype.handleKeyUp=function(t,e){40!==t&&38!==t&&27!==t&&9!==t&&(13!==t?this.handleInputChange(this.el.value):this.list.items[this.list.active]&&(this.list.handleMouseUp(this.list.items[this.list.active]),e.stopPropagation()))},n.prototype.handleKeyDown=function(t){switch(t.keyCode){case 13:this.list.active>=0&&(this.list.selectingListItem=!0);break;case 9:this.list.isEmpty()||(this.list.isVisible()&&t.preventDefault(),this.value(this.list.active>=0?this.list.items[this.list.active].original:null),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},n.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},n.prototype.handlePaste=function(t){if(t.clipboardData)this.handleInputChange(t.clipboardData.getData("Text"));else{var e=this;setTimeout((function(){e.handleInputChange(t.target.value)}),100)}},n.prototype.handleInputChange=function(t){this.query=this.normalize(t),this.list.clear(),this.query.length<this.options.minLength?this.list.draw():this.getCandidates(function(t){for(var e=0;e<t.length&&(this.list.add(t[e]),e!==this.options.limit-1);e++);this.list.draw()}.bind(this))},n.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},n.prototype.update=function(t){this.data=t,this.handleKeyUp()},n.prototype.clear=function(){this.data=[],this.list.clear()},n.prototype.normalize=function(t){return t=t.toLowerCase()},n.prototype.match=function(t,e){return t.indexOf(e)>-1},n.prototype.value=function(t){if(this.selected=t,this.el.value=this.getItemValue(t||{place_name:this.query}),document.createEvent){var e=document.createEvent("HTMLEvents");e.initEvent("change",!0,!1),this.el.dispatchEvent(e)}else this.el.fireEvent("onchange")},n.prototype.getCandidates=function(t){var o={pre:"<strong>",post:"</strong>",extract:function(t){return this.getItemValue(t)}.bind(this)};t(this.options.filter?e.filter(this.query,this.data,o).map(function(t){return{original:t.original,string:this.render(t.original,t.string)}}.bind(this)):this.data.map(function(t){return{original:t,string:this.render(t)}}.bind(this)))},n.prototype.getItemValue=function(t){return t},n.prototype.render=function(t,e){if(e)return e;for(var o=t.original?this.getItemValue(t.original):this.getItemValue(t),n=this.normalize(o),i=n.lastIndexOf(this.query);i>-1;){var r=i+this.query.length;o=o.slice(0,i)+"<strong>"+o.slice(i,r)+"</strong>"+o.slice(r),i=n.slice(0,i).lastIndexOf(this.query)}return o},n.prototype.renderError=function(t){this.list.drawError(t)},w=n}var C,M=v(function(){if(E)return k;E=1;var t=P();return k=t,"undefined"!=typeof window&&(window.Suggestions=t),k}()),T={exports:{}};var S,A,O,R,F,I=v((C||(C=1,A=T.exports,O=function(){var t=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function e(e){return e.match(t)||[]}function o(t){return{language:(t=e(t))[1]||"",extlang:t[2]||"",script:t[3]||"",region:t[4]||""}}function n(t,e,o){Object.defineProperty(t,e,{value:o,enumerable:!0})}function i(t,i,r){function a(o){return e(o)[t]||""}n(a,"pattern",i),n(o,r,a)}return i(1,/^[a-zA-Z]{2,3}$/,"language"),i(2,/^[a-zA-Z]{3}$/,"extlang"),i(3,/^[a-zA-Z]{4}$/,"script"),i(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),n(o,"split",(function(t){return e(t).filter((function(t,e){return t&&e}))})),o},(S=T).exports?S.exports=O():A.subtag=O()),T.exports));var z,B=function(){if(F)return R;F=1;var t=/^\s+|\s+$/g,e=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,n=/^0o[0-7]+$/i,i=parseInt,r="object"==typeof m&&m&&m.Object===Object&&m,a="object"==typeof self&&self&&self.Object===Object&&self,s=r||a||Function("return this")(),l=Object.prototype.toString,c=Math.max,u=Math.min,d=function(){return s.Date.now()};function p(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function h(r){if("number"==typeof r)return r;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==l.call(t)}(r))return NaN;if(p(r)){var a="function"==typeof r.valueOf?r.valueOf():r;r=p(a)?a+"":a}if("string"!=typeof r)return 0===r?r:+r;r=r.replace(t,"");var s=o.test(r);return s||n.test(r)?i(r.slice(2),s?2:8):e.test(r)?NaN:+r}return R=function(t,e,o){var n,i,r,a,s,l,g=0,f=!1,m=!1,v=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function b(e){var o=n,r=i;return n=i=void 0,g=e,a=t.apply(r,o)}function _(t){var o=t-l;return void 0===l||o>=e||o<0||m&&t-g>=r}function y(){var t=d();if(_(t))return j(t);s=setTimeout(y,function(t){var o=e-(t-l);return m?u(o,r-(t-g)):o}(t))}function j(t){return s=void 0,v&&n?b(t):(n=i=void 0,a)}function w(){var t=d(),o=_(t);if(n=arguments,i=this,l=t,o){if(void 0===s)return function(t){return g=t,s=setTimeout(y,e),f?b(t):a}(l);if(m)return s=setTimeout(y,e),b(l)}return void 0===s&&(s=setTimeout(y,e)),a}return e=h(e)||0,p(o)&&(f=!!o.leading,r=(m="maxWait"in o)?c(h(o.maxWait)||0,e):r,v="trailing"in o?!!o.trailing:v),w.cancel=function(){void 0!==s&&clearTimeout(s),g=0,n=l=i=s=void 0},w.flush=function(){return void 0===s?a:j(d())},w}}(),N=v(B),D=v(b()),V={exports:{}};var $=function(){if(z)return V.exports;z=1;var t,e="object"==typeof Reflect?Reflect:null,o=e&&"function"==typeof e.apply?e.apply:function(t,e,o){return Function.prototype.apply.call(t,e,o)};t=e&&"function"==typeof e.ownKeys?e.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var n=Number.isNaN||function(t){return t!=t};function i(){i.init.call(this)}V.exports=i,V.exports.once=function(t,e){return new Promise((function(o,n){function i(o){t.removeListener(e,r),n(o)}function r(){"function"==typeof t.removeListener&&t.removeListener("error",i),o([].slice.call(arguments))}g(t,e,r,{once:!0}),"error"!==e&&function(t,e,o){"function"==typeof t.on&&g(t,"error",e,o)}(t,i,{once:!0})}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var r=10;function a(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function s(t){return void 0===t._maxListeners?i.defaultMaxListeners:t._maxListeners}function l(t,e,o,n){var i,r,l,c;if(a(o),void 0===(r=t._events)?(r=t._events=Object.create(null),t._eventsCount=0):(void 0!==r.newListener&&(t.emit("newListener",e,o.listener?o.listener:o),r=t._events),l=r[e]),void 0===l)l=r[e]=o,++t._eventsCount;else if("function"==typeof l?l=r[e]=n?[o,l]:[l,o]:n?l.unshift(o):l.push(o),(i=s(t))>0&&l.length>i&&!l.warned){l.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=l.length,c=u,console&&console.warn&&console.warn(c)}return t}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(t,e,o){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:o},i=c.bind(n);return i.listener=o,n.wrapFn=i,i}function d(t,e,o){var n=t._events;if(void 0===n)return[];var i=n[e];return void 0===i?[]:"function"==typeof i?o?[i.listener||i]:[i]:o?function(t){for(var e=new Array(t.length),o=0;o<e.length;++o)e[o]=t[o].listener||t[o];return e}(i):h(i,i.length)}function p(t){var e=this._events;if(void 0!==e){var o=e[t];if("function"==typeof o)return 1;if(void 0!==o)return o.length}return 0}function h(t,e){for(var o=new Array(e),n=0;n<e;++n)o[n]=t[n];return o}function g(t,e,o,n){if("function"==typeof t.on)n.once?t.once(e,o):t.on(e,o);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function i(r){n.once&&t.removeEventListener(e,i),o(r)}))}}return Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return r},set:function(t){if("number"!=typeof t||t<0||n(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");r=t}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||n(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},i.prototype.getMaxListeners=function(){return s(this)},i.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i="error"===t,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=r[t];if(void 0===l)return!1;if("function"==typeof l)o(l,this,e);else{var c=l.length,u=h(l,c);for(n=0;n<c;++n)o(u[n],this,e)}return!0},i.prototype.addListener=function(t,e){return l(this,t,e,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(t,e){return l(this,t,e,!0)},i.prototype.once=function(t,e){return a(e),this.on(t,u(this,t,e)),this},i.prototype.prependOnceListener=function(t,e){return a(e),this.prependListener(t,u(this,t,e)),this},i.prototype.removeListener=function(t,e){var o,n,i,r,s;if(a(e),void 0===(n=this._events))return this;if(void 0===(o=n[t]))return this;if(o===e||o.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,o.listener||e));else if("function"!=typeof o){for(i=-1,r=o.length-1;r>=0;r--)if(o[r]===e||o[r].listener===e){s=o[r].listener,i=r;break}if(i<0)return this;0===i?o.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(o,i),1===o.length&&(n[t]=o[0]),void 0!==n.removeListener&&this.emit("removeListener",t,s||e)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(t){var e,o,n;if(void 0===(o=this._events))return this;if(void 0===o.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==o[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete o[t]),this;if(0===arguments.length){var i,r=Object.keys(o);for(n=0;n<r.length;++n)"removeListener"!==(i=r[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=o[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},i.prototype.listeners=function(t){return d(this,t,!0)},i.prototype.rawListeners=function(t){return d(this,t,!1)},i.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):p.call(t,e)},i.prototype.listenerCount=p,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]},V.exports}();const H={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}};var G={placeholder:{de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"לחפש",ja:"サーチ",lv:"Meklēt",pt:"Procurar",sr:"Претрага",zh:"搜索",cs:"Vyhledávání",hu:"Keresés",ka:"ძიება",nb:"Søke",sk:"Vyhľadávanie",th:"ค้นหา",fi:"Hae",is:"Leita",ko:"수색",pl:"Szukaj",sl:"Iskanje",fa:"جستجو",ru:"Поиск",es:"Buscar"},errorNoResults:{en:"No results found",de:"Keine Ergebnisse gefunden",es:"No hay resultados"},errorConnectionFailed:{en:"There was an error reaching the server",de:"Verbindung fehlgeschlagen",es:"Error al conectarse al servidor"}};const U=/(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/;class q{constructor(t,e){this.options={zoom:16,flyTo:!0,trackProximity:!0,showResultsWhileTyping:!1,minLength:2,reverseGeocode:!1,limit:5,enableEventLogging:!0,marker:!0,popup:!1,maplibregl:void 0,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,proximityMinZoom:9,getItemValue:t=>void 0!==t.text?t.text:t.place_name,render:function(t){if(!t.geometry){const e=t.text,o=e.toLowerCase().indexOf(this.query.toLowerCase()),n=this.query.length;return'<div class="maplibregl-ctrl-geocoder--suggestion"><svg class="maplibregl-ctrl-geocoder--suggestion-icon" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22.8702 20.1258H21.4248L20.9125 19.6318C22.7055 17.546 23.785 14.8382 23.785 11.8925C23.785 5.32419 18.4608 0 11.8925 0C5.32419 0 0 5.32419 0 11.8925C0 18.4608 5.32419 23.785 11.8925 23.785C14.8382 23.785 17.546 22.7055 19.6318 20.9125L20.1258 21.4248V22.8702L29.2739 32L32 29.2739L22.8702 20.1258ZM11.8925 20.1258C7.33676 20.1258 3.65923 16.4483 3.65923 11.8925C3.65923 7.33676 7.33676 3.65923 11.8925 3.65923C16.4483 3.65923 20.1258 7.33676 20.1258 11.8925C20.1258 16.4483 16.4483 20.1258 11.8925 20.1258Z" fill="#687078"/></svg><div class="maplibregl-ctrl-geocoder--suggestion-info"><div class="maplibregl-ctrl-geocoder--suggestion-title">'+e.substring(0,o)+'<span class="maplibregl-ctrl-geocoder--suggestion-match">'+e.substring(o,o+n)+"</span>"+e.substring(o+n)+"</div></div></div>"}const e=t.place_name.split(",");return'<div class="maplibregl-ctrl-geocoder--result"><svg class="maplibregl-ctrl-geocoder--result-icon" viewBox="0 0 24 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.36571 0 0 5.38676 0 12.0471C0 21.0824 12 32 12 32C12 32 24 21.0824 24 12.0471C24 5.38676 18.6343 0 12 0ZM12 16.3496C9.63428 16.3496 7.71429 14.4221 7.71429 12.0471C7.71429 9.67207 9.63428 7.74454 12 7.74454C14.3657 7.74454 16.2857 9.67207 16.2857 12.0471C16.2857 14.4221 14.3657 16.3496 12 16.3496Z" fill="#687078"/></svg><div><div class="maplibregl-ctrl-geocoder--result-title">'+e[0]+'</div><div class="maplibregl-ctrl-geocoder--result-address">'+e.splice(1,e.length).join(",")+"</div></div></div>"},popupRender:t=>{const e=t.place_name.split(",");return'<div class="maplibregl-ctrl-geocoder--suggestion popup-suggestion"><div class="maplibregl-ctrl-geocoder--suggestion-title popup-suggestion-title">'+e[0]+'</div><div class="maplibregl-ctrl-geocoder--suggestion-address popup-suggestion-address">'+e.splice(1,e.length).join(",")+"</div></div>"},showResultMarkers:!0,debounceSearch:200},this._eventEmitter=new $.EventEmitter,this.options=D({},this.options,e),this.fresh=!0,this.lastSelected=null,this.geocoderApi=t}addTo(t){function e(t,e){if(!document.body.contains(e))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const o=t.onAdd();e.appendChild(o)}if(t instanceof HTMLElement)e(this,t);else if("string"==typeof t){const o=document.querySelectorAll(t);if(0===o.length)throw new Error("Element "+t+"not found.");if(o.length>1)throw new Error("Geocoder can only be added to a single html element");e(this,o[0])}else{if(!("addControl"in t))throw new Error("Error: addTo must be a maplibre-gl-js map, an html element, or a CSS selector query for a single html element");t.addControl(this)}}onAdd(t){if(t&&"string"!=typeof t&&(this._map=t),this.setLanguage(),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this);const e=this.container=document.createElement("div");e.className="maplibregl-ctrl-geocoder maplibregl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl";const o=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="maplibregl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",N(this._onKeyDown,this.options.debounceSearch)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton);const n=document.createElement("div");n.classList.add("maplibregl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("type","button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="maplibregl-ctrl-geocoder--button";const i=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');return this._clearEl.appendChild(i),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),n.appendChild(this._clearEl),n.appendChild(this._loadingEl),e.appendChild(o),e.appendChild(this._inputEl),e.appendChild(n),this._typeahead=new M(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit,noInitialSelection:!0}),this.container.addEventListener("click",(()=>{this._typeahead.update(this._typeahead.data)})),this.setRenderFunction(this.options.render),this._typeahead.getItemValue=this.options.getItemValue,this.mapMarker=null,this.resultMarkers=[],this._handleMarker=this._handleMarker.bind(this),this._handleResultMarkers=this._handleResultMarkers.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._maplibregl=this.options.maplibregl,!this._maplibregl&&this.options.marker&&(console.error("No maplibregl detected in options. Map markers are disabled. Please set options.maplibregl."),this.options.marker=!1)),e}createIcon(t,e){const o=document.createElementNS("http://www.w3.org/2000/svg","svg");if(o.setAttribute("class","maplibregl-ctrl-geocoder--icon maplibregl-ctrl-geocoder--icon-"+t),o.setAttribute("viewBox","0 0 18 18"),o.setAttribute("xml:space","preserve"),o.setAttribute("width","18"),o.setAttribute("height","18"),"innerHTML"in o)o.innerHTML=e;else{const t=document.createElement("div");t.innerHTML="<svg>"+e.valueOf().toString()+"</svg>";const n=t.firstChild.firstChild;o.appendChild(n)}return o}onRemove(){return this.container.remove(),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this}_onPaste(t){const e=(t.clipboardData||window.clipboardData).getData("text");e.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(e)}_onKeyDown(t){const e=27,o=9;if(t.keyCode===e&&this.options.clearAndBlurOnEsc)return this._clear(t),this._inputEl.blur();const n=this._inputEl.value;if(!n)return this.fresh=!0,t.keyCode!==o&&this.clear(t),this._clearEl.style.display="none";if(!t.metaKey&&-1===[o,e,37,39,38,40].indexOf(t.keyCode)){if(13===t.keyCode){if(this.options.showResultsWhileTyping)return void(null==this._typeahead.selected&&this.geocoderApi.getSuggestions?this._geocode(n,!0):null==this._typeahead.selected&&this.options.showResultMarkers&&this._fitBoundsForMarkers());this._typeahead.selected||this._geocode(n)}n.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(n)}}_showButton(){this._inputEl.value.length>0&&(this._clearEl.style.display="block")}_hideButton(){this._typeahead.selected&&(this._clearEl.style.display="none")}_onBlur(t){this.options.clearOnBlur&&this._clearOnBlur(t),this.options.collapsed&&this._collapse()}_onChange(){const t=this._typeahead.selected;if(t&&!t.geometry)t.placeId?this._geocode(t.placeId,!0,!0):this._geocode(t.text,!0);else if(t&&JSON.stringify(t)!==this.lastSelected){if(this._clearEl.style.display="none",this.options.flyTo){let e;if(this._removeResultMarkers(),t.properties&&H[t.properties.short_code])e=D({},this.options.flyTo),this._map&&this._map.fitBounds(H[t.properties.short_code].bbox,e);else if(t.bbox){const o=t.bbox;e=D({},this.options.flyTo),this._map&&this._map.fitBounds([[o[0],o[1]],[o[2],o[3]]],e)}else{const o={zoom:this.options.zoom};e=D({},o,this.options.flyTo),t.center?e.center=t.center:t.geometry&&t.geometry.type&&"Point"===t.geometry.type&&t.geometry.coordinates&&(e.center=t.geometry.coordinates),this._map&&this._map.flyTo(e)}}this.options.marker&&this._maplibregl&&this._handleMarker(t),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(t),this._typeahead.selected=null,this._eventEmitter.emit("result",{result:t})}}_getConfigForRequest(){return["bbox","limit","proximity","countries","types","language","reverseMode"].reduce(((t,e)=>(this.options[e]&&(["countries","types","language"].indexOf(e)>-1?t[e]=this.options[e].split(/[\s,]+/):t[e]=this.options[e],"proximity"===e&&this.options[e]&&"number"==typeof this.options[e].longitude&&"number"==typeof this.options[e].latitude&&(t[e]=[this.options[e].longitude,this.options[e].latitude])),t)),{})}_geocode(t){return h(this,arguments,void 0,(function*(t,e=!1,o=!1){this._loadingEl.style.display="block",this._eventEmitter.emit("loading",{query:t});const n=this._getConfigForRequest(),i=this._createGeocodeRequest(n,t,e,o),r=this.options.localGeocoder&&this.options.localGeocoder(t)||[];try{const o=yield i;yield this._handleGeocodeResponse(o,n,t,e,r)}catch(a){this._handleGeocodeErrorResponse(a,r)}return i}))}_createGeocodeRequest(t,e,o,n){return this.options.localGeocoderOnly?Promise.resolve({}):this.options.reverseGeocode&&U.test(e)?this._createReverseGeocodeRequest(e,t):(t.query=e,this.geocoderApi.getSuggestions?o?this.geocoderApi.searchByPlaceId&&n?this.geocoderApi.searchByPlaceId(t):this.geocoderApi.forwardGeocode(t):this.geocoderApi.getSuggestions(t):this.geocoderApi.forwardGeocode(t))}_createReverseGeocodeRequest(t,e){const o=t.split(/[\s(,)?]+/).map((t=>parseFloat(t))).reverse();return e.query=o,e.limit=1,"proximity"in e&&delete e.proximity,this.geocoderApi.reverseGeocode(e)}_handleGeocodeResponse(t,e,o,n,i){return h(this,void 0,void 0,(function*(){this._loadingEl.style.display="none";let r={};r=t||{type:"FeatureCollection",features:[]},r.config=e,this.fresh&&(this.fresh=!1),r.features=r.features?i.concat(r.features):i;const a=this.options.externalGeocoder&&this.options.externalGeocoder(o,r.features,e)||Promise.resolve([]);try{const t=yield a;r.features=r.features?t.concat(r.features):t}catch(l){}this.options.filter&&r.features.length&&(r.features=r.features.filter(this.options.filter));let s=[];s="suggestions"in r?r.suggestions:"place"in r?[r.place]:r.features,s.length?(this._clearEl.style.display="block",this._typeahead.update(s),(!this.options.showResultsWhileTyping||n)&&this.options.showResultMarkers&&(r.features.length>0||"place"in r)&&this._fitBoundsForMarkers(),this._eventEmitter.emit("results",r)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",r))}))}_handleGeocodeErrorResponse(t,e){this._loadingEl.style.display="none",e.length&&this.options.localGeocoder?(this._clearEl.style.display="block",this._typeahead.update(e)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:e}),this._eventEmitter.emit("error",{error:t})}_clear(t){t&&t.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._clearEl.style.display="none",this._removeMarker(),this._removeResultMarkers(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0}clear(t){this._clear(t),this._inputEl.focus()}_clearOnBlur(t){t.relatedTarget&&this._clear(t)}_onQueryResult(t){if(!("features"in t))return;if(!t.features.length)return;const e=t.features[0];this._typeahead.selected=e,this._inputEl.value=e.place_name,this._onChange()}_updateProximity(){if(this._map)if(this._map.getZoom()>this.options.proximityMinZoom){const t=this._map.getCenter().wrap();this.setProximity({longitude:t.lng,latitude:t.lat})}else this.setProximity(null)}_collapse(){this._inputEl.value||this._inputEl===document.activeElement||this.container.classList.add("maplibregl-ctrl-geocoder--collapsed")}_unCollapse(){this.container.classList.remove("maplibregl-ctrl-geocoder--collapsed")}query(t){return h(this,void 0,void 0,(function*(){const e=yield this._geocode(t);this._onQueryResult(e)}))}_renderError(){const t=`<div class='maplibre-gl-geocoder--error'>${this._localize("errorConnectionFailed")}</div>`;this._renderMessage(t)}_renderNoResults(){const t=`<div class='maplibre-gl-geocoder--error maplibre-gl-geocoder--no-results'>\n        ${this._localize("errorNoResults")}</div>`;this._renderMessage(t)}_renderMessage(t){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(t)}_localize(t){const e=I.language(this.options.language.split(",")[0]);return this.options.language&&(null==G?void 0:G[t][e])?G[t][e]:G[t].en}_fitBoundsForMarkers(){if(this._typeahead.data.length<1)return;const t=this._typeahead.data.filter((t=>"string"!=typeof t)).slice(0,this.options.limit);if(this._clearEl.style.display="none",this.options.flyTo&&this._maplibregl&&this._map){const e=D({},{padding:100},this.options.flyTo),o=new this._maplibregl.LngLatBounds;for(const n of t)o.extend(n.geometry.coordinates);this._map.fitBounds(o,e)}return t.length>0&&this._maplibregl&&this._handleResultMarkers(t),this}setInput(t){return this._inputEl.value=t,this._typeahead.selected=null,this._typeahead.clear(),t.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(t),this}setProximity(t){return this.options.proximity=t,this}getProximity(){return this.options.proximity}setRenderFunction(t){return t&&"function"==typeof t&&(this._typeahead.render=t),this}getRenderFunction(){return this._typeahead.render}setLanguage(t){return this.options.language=t||this.options.language||navigator.language,this}getLanguage(){return this.options.language}getZoom(){return this.options.zoom}setZoom(t){return this.options.zoom=t,this}getFlyTo(){return this.options.flyTo}setFlyTo(t){return this.options.flyTo=t,this}getPlaceholder(){return this.options.placeholder}setPlaceholder(t){return this.placeholder=t||(this.options.placeholder||this._localize("placeholder")),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this}getBbox(){return this.options.bbox}setBbox(t){return this.options.bbox=t,this}getCountries(){return this.options.countries}setCountries(t){return this.options.countries=t,this}getTypes(){return this.options.types}setTypes(t){return this.options.types=t,this}getMinLength(){return this.options.minLength}setMinLength(t){return this.options.minLength=t,this._typeahead&&(this._typeahead.options.minLength=t),this}getLimit(){return this.options.limit}setLimit(t){return this.options.limit=t,this._typeahead&&(this._typeahead.options.limit=t),this}getFilter(){return this.options.filter}setFilter(t){return this.options.filter=t,this}setGeocoderApi(t){return this.geocoderApi=t,this}getGeocoderApi(){return this.geocoderApi}_handleMarker(t){if(!this._map)return;this._removeMarker();const e=D({},{color:"#4668F2"},this.options.marker);let o;if(this.mapMarker=new this._maplibregl.Marker(e),this.options.popup){const e=D({},{},this.options.popup);o=new this._maplibregl.Popup(e).setHTML(this.options.popupRender(t))}return t.center?(this.mapMarker.setLngLat(t.center).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(o)):t.geometry&&t.geometry.type&&"Point"===t.geometry.type&&t.geometry.coordinates&&(this.mapMarker.setLngLat(t.geometry.coordinates).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(o)),this}_removeMarker(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)}_handleResultMarkers(t){if(!this._map)return;this._removeResultMarkers();let e=D({},{color:"#4668F2"},this.options.showResultMarkers);for(const o of t){let t;if(this.options.showResultMarkers){this.options.showResultMarkers&&this.options.showResultMarkers.element&&(t=this.options.showResultMarkers.element.cloneNode(!0),e=D(e,{element:t}));const n=new this._maplibregl.Marker(D({},e,{element:t}));let i;if(this.options.popup){const t=D({},{},this.options.popup);i=new this._maplibregl.Popup(t).setHTML(this.options.popupRender(o))}o.center?(n.setLngLat(o.center).addTo(this._map),this.options.popup&&n.setPopup(i)):o.geometry&&o.geometry.type&&"Point"===o.geometry.type&&o.geometry.coordinates&&(n.setLngLat(o.geometry.coordinates).addTo(this._map),this.options.popup&&n.setPopup(i)),this.resultMarkers.push(n)}}return this}_removeResultMarkers(){this.resultMarkers&&this.resultMarkers.length>0&&(this.resultMarkers.forEach((function(t){t.remove()})),this.resultMarkers=[])}on(t,e){return this._eventEmitter.on(t,e),this}once(t){return new Promise((e=>{this._eventEmitter.once(t,e)}))}off(t,e){return this._eventEmitter.removeListener(t,e),this}}function Z(t){return function(e){var o=e.dispatch,n=e.getState;return function(e){return function(i){return"function"==typeof i?i(o,n,t):e(i)}}}}var J=Z();J.withExtraArgument=Z;class K extends u{constructor(e){if(super(e),this.et=t,e.type!==d.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(o){if(o===t||null==o)return this.ft=void 0,this.et=o;if(o===e)return o;if("string"!=typeof o)throw Error(this.constructor.directiveName+"() called with a non-string value");if(o===this.et)return this.ft;this.et=o;const n=[o];return n.raw=n,this.ft={_$litType$:this.constructor.resultType,strings:n,values:[]}}}K.directiveName="unsafeHTML",K.resultType=1;const W=p(K);var X="NOT_FOUND";var Y=function(t,e){return t===e};function Q(t,e){var o,n,i="object"==typeof e?e:{equalityCheck:e},r=i.equalityCheck,a=void 0===r?Y:r,s=i.maxSize,l=void 0===s?1:s,c=i.resultEqualityCheck,u=function(t){return function(e,o){if(null===e||null===o||e.length!==o.length)return!1;for(var n=e.length,i=0;i<n;i++)if(!t(e[i],o[i]))return!1;return!0}}(a),d=1===l?(o=u,{get:function(t){return n&&o(n.key,t)?n.value:X},put:function(t,e){n={key:t,value:e}},getEntries:function(){return n?[n]:[]},clear:function(){n=void 0}}):function(t,e){var o=[];function n(t){var n=o.findIndex((function(o){return e(t,o.key)}));if(n>-1){var i=o[n];return n>0&&(o.splice(n,1),o.unshift(i)),i.value}return X}return{get:n,put:function(e,i){n(e)===X&&(o.unshift({key:e,value:i}),o.length>t&&o.pop())},getEntries:function(){return o},clear:function(){o=[]}}}(l,u);function p(){var e=d.get(arguments);if(e===X){if(e=t.apply(null,arguments),c){var o=d.getEntries().find((function(t){return c(t.value,e)}));o&&(e=o.value)}d.put(arguments,e)}return e}return p.clearCache=function(){return d.clear()},p}function tt(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var r,a=0,s={memoizeOptions:void 0},l=n.pop();if("object"==typeof l&&(s=l,l=n.pop()),"function"!=typeof l)throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof l+"]");var c=s.memoizeOptions,u=void 0===c?o:c,d=Array.isArray(u)?u:[u],p=function(t){var e=Array.isArray(t[0])?t[0]:t;if(!e.every((function(t){return"function"==typeof t}))){var o=e.map((function(t){return"function"==typeof t?"function "+(t.name||"unnamed")+"()":typeof t})).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+o+"]")}return e}(n),h=t.apply(void 0,[function(){return a++,l.apply(null,arguments)}].concat(d)),g=t((function(){for(var t=[],e=p.length,o=0;o<e;o++)t.push(p[o].apply(null,arguments));return r=h.apply(null,t)}));return Object.assign(g,{resultFunc:l,memoizedResultFunc:h,dependencies:p,lastResult:function(){return r},recomputations:function(){return a},resetRecomputations:function(){return a=0}}),g}}var et=tt(Q);const ot="SET_LOCATOR_LOADING_START",nt="SET_LOCATOR_LOADING_END",it={isLoading:!1},rt="MOUSE_ENTER_FEATURE",at="MOUSE_LEAVE_FEATURE",st={highlightedFeature:null,isLoading:!1},lt="RESET_PAGINATION",ct="SET_PREV_PAGINATION_PAGE",ut="SET_NEXT_PAGINATION_PAGE",dt="SET_HAS_PAGINATION",pt="SET_HAS_NO_PAGINATION",ht="SET_DATA_GEOJSON",gt="SET_DATA_TEASERS",ft="SET_DATA_LOAD_START",mt="SET_DATA_LOAD_END",vt="SET_CURRENT_VISIBLE_FEATURES",bt=()=>({type:ft}),_t=()=>({type:mt}),yt=t=>({type:vt,payload:t}),jt=(t,e)=>e.properties.search_boost-t.properties.search_boost||t.properties.name.localeCompare(e.properties.name),wt=(t,e,o,n)=>t.getClusterLeaves(e,o,n),xt={geojson:null,teasers:null,isLoading:!1,currentlyVisibleFeatures:[]},kt="SET_SEARCH_LOADING_START",Et="SET_SEARCH_LOADING_END",Lt={isLoading:!1},Pt={hasPagination:!1,currentPage:1},Ct="SET_POPUP_LOADING_START",Mt="SET_POPUP_LOADING_END",Tt="RESET_POPUP_FEATURE",St="SET_POPUP_FEATURE",At="SET_POPUP_COORDINATES",Ot="RESET_POPUP_COORDINATES",Rt={feature:null,coordinates:null,isLoading:!1},Ft=a({features:function(t=st,e){switch(e.type){case at:return{...t,highlightedFeature:null};case rt:return{...t,highlightedFeature:e.payload}}return t},locator:function(t=it,e){switch(e.type){case ot:return{...t,isLoading:!0};case nt:return{...t,isLoading:!1}}return t},data:function(t=xt,e){switch(e.type){case ht:return{...t,geojson:e.payload};case gt:return{...t,teasers:e.payload};case ft:return{...t,isLoading:!0};case mt:return{...t,isLoading:!1};case vt:return{...t,currentlyVisibleFeatures:e.payload}}return t},search:function(t=Lt,e){switch(e.type){case kt:return{...t,isLoading:!0};case Et:return{...t,isLoading:!1}}return t},pagination:function(t=Pt,e){switch(e.type){case lt:return{...t,currentPage:1};case ct:{const e=1===t.currentPage?1:t.currentPage-1;return{...t,currentPage:e}}case ut:{const e=t.currentPage+1;return{...t,currentPage:e}}case dt:return{...t,hasPagination:!0};case pt:return{...t,hasPagination:!1}}return t},popup:function(t=Rt,e){switch(e.type){case Ct:return{...t,isLoading:!0};case Mt:return{...t,isLoading:!1};case Tt:return{...t,feature:null};case St:return{...t,feature:e.payload};case At:return{...t,coordinates:e.payload};case Ot:return{...t,coordinates:null}}return t}}),It=function(){const t=(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({trace:!0,traceLimit:25}):s)(l(J.withExtraArgument({})));return c(Ft,t)}();function zt(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var Bt;customElements.define("toujou-location-finder-teaser",class extends o{constructor(){super(),this.isHighlightedAttribute="is-highlighted",this.teaserLinkSelector=".teaser",this.onStateChange=this.onStateChange.bind(this),this._featureUid=this.getAttribute("feature-uid"),this._teaserLinkEl=this.querySelector(this.teaserLinkSelector),this.store=It,this.store.subscribe(this.onStateChange),this._state=this.store.getState()}render(){return n`<slot id="slot"></slot>`}set _highlightedFeature(t){t==this._featureUid?this._teaserLinkEl.setAttribute(this.isHighlightedAttribute,""):this._teaserLinkEl.removeAttribute(this.isHighlightedAttribute)}onStateChange(){this._state=this.store.getState(),this._highlightedFeature=this._state.features.highlightedFeature}connectedCallback(){super.connectedCallback(),this.addEventListener("mouseenter",this._onMouseEnter),this.addEventListener("mouseleave",this._onMouseLeave)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("mouseenter",this._onMouseEnter),this.removeEventListener("mouseleave",this._onMouseLeave)}_onMouseEnter(){this.dispatchEvent(new CustomEvent("toujou-location-finder-teaser-mouse-enter",{composed:!0,detail:{featureUid:this.getAttribute("feature-uid")}}))}_onMouseLeave(){this.dispatchEvent(new CustomEvent("toujou-location-finder-teaser-mouse-leave",{composed:!0}))}});var Nt,Dt,Vt,$t=i(Bt||(Bt=zt(["* {\n    padding: 0;\n    margin: 0;\n    -webkit-box-sizing: border-box;\n            box-sizing: border-box;\n}\n\n:host {\n    display: var(--toujou-location-finder-host-display, grid);\n    grid-template-columns: var(--toujou-location-finder-host-grid-template-columns, 1fr);\n    grid-gap: var(--toujou-location-finder-host-grid-gap, 1rem);\n    position: var(--toujou-location-finder-host-position, relative);\n}\n\n.location-finder__map {\n    height: var(--toujou-location-finder-map-height, auto);\n    max-height: var(--toujou-location-finder-map-max-height, 50vh);\n    grid-row: var(--toujou-location-finder-map-grid-row, 2);\n}\n\n.sidebar__ui-button {\n    display: var(--toujou-location-finder-search-ui-button-display, block);\n    height: var(--toujou-location-finder-search-ui-button-height, var(--toujou-location-finder-search-height));\n    width: var(--toujou-location-finder-search-ui-button-width, var(--toujou-location-finder-search-height));\n    border-radius: var(--toujou-location-finder-search-border-radius, .25rem);\n    background-color: var(--toujou-location-finder-sidebar-buttons-bg, var(--bg-color));\n    position: var(--toujou-location-finder-sidebar-buttons-position, absolute);\n    border: var(--toujou-location-finder-sidebar-buttons-border, none);\n    outline: var(--toujou-location-finder-sidebar-buttons-outline, none);\n    -webkit-box-shadow: var(--toujou-location-finder-search-shadow, 0 2px 4px rgba(150, 150, 150, .2));\n            box-shadow: var(--toujou-location-finder-search-shadow, 0 2px 4px rgba(150, 150, 150, .2));\n    cursor: var(--toujou-location-finder-sidebar-buttons-cursor, pointer);\n}\n\n.sidebar__ui-button:after {\n    content: '';\n    height: var(--toujou-location-finder-sidebar-io-button-after-height, 1rem);\n    width: var(--toujou-location-finder-sidebar-io-button-after-width, 1rem);\n    background-color: var(--toujou-location-finder-sidebar-io-button-after-background-color, var(--font-color));\n    -webkit-mask-size: var(--toujou-location-finder-sidebar-io-button-after-mask-size, contain);\n    mask-size: var(--toujou-location-finder-sidebar-io-button-after-mask-size, contain);\n    -webkit-mask-position: var(--toujou-location-finder-sidebar-io-button-after-mask-position, center);\n    mask-position: var(--toujou-location-finder-sidebar-io-button-after-mask-position, center);\n    -webkit-mask-repeat: var(--toujou-location-finder-sidebar-io-button-after-mask-repeat, no-repeat);\n    mask-repeat: var(--toujou-location-finder-sidebar-io-button-after-mask-repeat, no-repeat);\n    position: var(--toujou-location-finder-sidebar-io-button-after-position, absolute);\n    top: var(--toujou-location-finder-sidebar-io-button-after-top, 50%);\n    left: var(--toujou-location-finder-sidebar-io-button-after-left, 50%);\n    opacity: var(--toujou-location-finder-sidebar-io-button-after-opacity, .5);\n}\n\n.sidebar__ui-button--locator {\n    top: var(--toujou-location-finder-locator-top, calc(var(--toujou-location-finder-search-height) + 1rem + var(--toujou-location-finder-padding)));\n    left: var(--toujou-location-finder-locator-left, var(--toujou-location-finder-padding));\n    -webkit-transition: var(--toujou-location-finder-locator-transform, transform var(--toujou-location-finder-transition-settings));\n    transition: var(--toujou-location-finder-locator-transform, transform var(--toujou-location-finder-transition-settings));\n}\n\n.sidebar__ui-button--locator:after {\n    height: var(--toujou-location-finder-sidebar-locator-icon-height, 1.5rem);\n    width: var(--toujou-location-finder-sidebar-locator-icon-width, 1.5rem);\n    -webkit-mask-image: var(--toujou-location-finder-sidebar-locator-icon-image, var(--toujou-location-finder-icon-target));\n    mask-image: var(--toujou-location-finder-sidebar-locator-icon-image, var(--toujou-location-finder-icon-target));\n    -webkit-transform: var(--toujou-location-finder-sidebar-locator-icon-transform, translate(-50%, -50%));\n            transform: var(--toujou-location-finder-sidebar-locator-icon-transform, translate(-50%, -50%));\n    -webkit-transition: var(--toujou-location-finder-sidebar-locator-icon-transition, transform .25s ease-in-out);\n    transition: var(--toujou-location-finder-sidebar-locator-icon-transition, transform .25s ease-in-out);\n}\n\n.sidebar__ui-button--locator[locatorisloading]:after {\n    height: var(--toujou-location-finder-sidebar-locator-loader-height, 1rem);\n    width: var(--toujou-location-finder-sidebar-locator-loader-width, 1rem);\n    mask-image: var(--toujou-location-finder-sidebar-locator-loader-image, none);\n    -webkit-mask-image: var(--toujou-location-finder-sidebar-locator-loader-image, none);\n    border-radius: var(--toujou-location-finder-sidebar-locator-loader-border-radius, 50%);\n    border: var(--toujou-location-finder-sidebar-locator-loader-border, 3px solid transparent);\n    border-top-color: var(--toujou-location-finder-sidebar-locator-loader-border-top-color, var(--primary-color));\n    -webkit-animation: var(--toujou-location-finder-sidebar-locator-loader-animation, locatorLoadingAnimation 1s linear infinite);\n            animation: var(--toujou-location-finder-sidebar-locator-loader-animation, locatorLoadingAnimation 1s linear infinite);\n    opacity: var(--toujou-location-finder-sidebar-locator-loader-opacity, 1);\n    background-color: var(--toujou-location-finder-sidebar-locator-loader-background-color, transparent);\n}\n\n@-webkit-keyframes locatorLoadingAnimation {\n    0% { -webkit-transform: translate(-50%, -50%) rotate(0deg); transform: translate(-50%, -50%) rotate(0deg); }\n    100% { -webkit-transform: translate(-50%, -50%) rotate(360deg); transform: translate(-50%, -50%) rotate(360deg); }\n}\n\n@keyframes locatorLoadingAnimation {\n    0% { -webkit-transform: translate(-50%, -50%) rotate(0deg); transform: translate(-50%, -50%) rotate(0deg); }\n    100% { -webkit-transform: translate(-50%, -50%) rotate(360deg); transform: translate(-50%, -50%) rotate(360deg); }\n}\n\n@media (hover: hover) {\n    .sidebar__ui-button:hover:after {\n        opacity: 1;\n    }\n    .sidebar__ui-button--locator[locatorisloading] {\n        pointer-events: none;\n    }\n}\n\n/* SIDEBAR PANEL */\n\n.sidebar__panel {\n    position: var(--toujou-location-finder-panel-position, relative);\n    background-color: var(--toujou-location-finder-panel-bg-color, var(--bg-color));\n    width: var(--toujou-location-finder-panel-width, 100%);\n    border-radius: var(--toujou-location-finder-panel-border-radius, var(--toujou-location-finder-radius));\n    -webkit-box-shadow: var(--toujou-location-finder-panel-shadow, var(--toujou-location-finder-shadow));\n            box-shadow: var(--toujou-location-finder-panel-shadow, var(--toujou-location-finder-shadow));\n    display: var(--toujou-location-finder-panel-display, flex);\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: var(--toujou-location-finder-panel-flex-direction, column);\n            flex-direction: var(--toujou-location-finder-panel-flex-direction, column);\n    overflow: var(--toujou-location-finder-panel-overflow, hidden);\n    z-index: var(--toujou-location-finder-panel-z-index, 1);\n    padding: var(--toujou-location-finder-panel-padding, 0);\n}\n\n/* TEASERS */\n\n.teasers {\n    background-color: var(--toujou-location-finder-teasers-bg-color, var(--bg-color));\n    position: var(--toujou-location-finder-teasers-position, relative);\n    width: var(--toujou-location-finder-teasers-width, 100%);\n}\n\n:host([hasPagination]) .teasers {\n    padding-bottom: var(--toujou-location-finder-teasers-no-pagination-padding-bottom, 0);\n}\n\n/* LOADING BAR */\n\n.loading-bar {\n    height: var(--toujou-location-finder-loading-bar-height, 4px);\n    width: var(--toujou-location-finder-loading-bar-width, 100%);\n    position: var(--toujou-location-finder-loading-bar-position, absolute);\n    top: calc(var(--toujou-location-finder-search-height) + 1rem );\n    left: var(--toujou-location-finder-loading-bar-left, 0);\n    background-color: var(--toujou-location-finder-loading-bar-bg-color, var(--font-color--light));\n    z-index: var(--toujou-location-finder-loading-bar-z-index, 1);\n    pointer-events: var(--toujou-location-finder-loading-bar-pointer-events, none);\n    opacity: 0;\n}\n\n:host([isLoading]) .loading-bar {\n    opacity: var(--toujou-location-finder-loading-bar-opacity, .875);\n}\n\n.loading-bar:after {\n    content: '';\n    display: block;\n    height: var(--toujou-location-finder-loading-bar-height);\n    background-color: var(--toujou-location-finder-loading-bar-mover-color, var(--primary-color));\n    position: var(--toujou-location-finder-loading-bar-after-position, absolute);\n    top: var(--toujou-location-finder-loading-bar-top, 0);\n    left: var(--toujou-location-finder-loading-bar-left, 0);\n    right: var(--toujou-location-finder-loading-bar-right, 100%);\n    -webkit-animation-name: var(--toujou-location-finder-loading-bar-animation-name, loadingBarAnimation);\n            animation-name: var(--toujou-location-finder-loading-bar-animation-name, loadingBarAnimation);\n    -webkit-animation-duration: var(--toujou-location-finder-loading-bar-animation-duration, 1.5s);\n            animation-duration: var(--toujou-location-finder-loading-bar-animation-duration, 1.5s);\n    -webkit-animation-timing-function: var(--toujou-location-finder-loading-bar-animation-easing, linear);\n            animation-timing-function: var(--toujou-location-finder-loading-bar-animation-easing, linear);\n    -webkit-animation-iteration-count: var(--toujou-location-finder-loading-bar-animation-iteration-count, infinite);\n            animation-iteration-count: var(--toujou-location-finder-loading-bar-animation-iteration-count, infinite);\n}\n\n@-webkit-keyframes loadingBarAnimation {\n    0% {\n        left: 0;\n        right: 100%;\n    }\n    35%, 50% {\n        left: 0;\n        right: 0;\n    }\n    85%, 100% {\n        left: 100%;\n        right: 0;\n    }\n}\n\n@keyframes loadingBarAnimation {\n    0% {\n        left: 0;\n        right: 100%;\n    }\n    35%, 50% {\n        left: 0;\n        right: 0;\n    }\n    85%, 100% {\n        left: 100%;\n        right: 0;\n    }\n}\n\n/* PAGINATION */\n\n.pagination {\n    width: var(--toujou-location-finder-pagination-width, var(--toujou-location-finder-sidebar-width));\n    height: var(--toujou-location-finder-pagination-height, var(--toujou-location-finder-search-height));\n    display: var(--toujou-location-finder-pagination-display, flex);\n    -webkit-box-align: var(--toujou-location-finder-pagination-align-items, center);\n        -ms-flex-align: var(--toujou-location-finder-pagination-align-items, center);\n            align-items: var(--toujou-location-finder-pagination-align-items, center);\n    -webkit-box-pack: var(--toujou-location-finder-pagination-justify-content, space-between);\n        -ms-flex-pack: var(--toujou-location-finder-pagination-justify-content, space-between);\n            justify-content: var(--toujou-location-finder-pagination-justify-content, space-between);\n    background-color: var(--toujou-location-finder-pagination-bg-color, var(--bg-color));\n    padding: var(--toujou-location-finder-pagination-padding, 0 calc(var(--toujou-location-finder-padding) / 4));\n    border-top: var(--toujou-location-finder-pagination-border-top, 1px solid var(--font-color--light));\n}\n\n.pagination__button {\n    border: var(--toujou-location-finder-pagination-button-border, none);\n    outline: var(--toujou-location-finder-pagination-button-outline, none);\n    height: var(--toujou-location-finder-pagination-button-height, 1.5rem);\n    width: var(--toujou-location-finder-pagination-button-width, 1.5rem);\n    background-color: var(--toujou-location-finder-pagination-button-bg-color, var(--font-color));\n    mask-position: var(--toujou-location-finder-pagination-button-mask-position, center);\n    -webkit-mask-position: var(--toujou-location-finder-pagination-button-mask-position, center);\n    mask-repeat: var(--toujou-location-finder-pagination-button--mask-repeat, no-repeat);\n    -webkit-mask-repeat: var(--toujou-location-finder-pagination-button--mask-repeat, no-repeat);\n    mask-size: var(--toujou-location-finder-pagination-button-mask-size, contain);\n    -webkit-mask-size: var(--toujou-location-finder-pagination-button-mask-size, contain);\n    mask-image: var(--toujou-location-finder-pagination-button-image, var(--medatsu-icon-chevron-down));\n    -webkit-mask-image: var(--toujou-location-finder-pagination-button-image, var(--medatsu-icon-chevron-down));\n    opacity: var(--toujou-location-finder-pagination-button-opacity, .5);\n    cursor: var(--toujou-location-finder-pagination-button-cursor, pointer);\n}\n\n.pagination__button[disabled] {\n    pointer-events: none;\n    opacity: 0;\n}\n\n.pagination__button--prev {\n    -webkit-transform: var(--toujou-location-finder-pagination-button-prev-transform, rotate(90deg));\n            transform: var(--toujou-location-finder-pagination-button-prev-transform, rotate(90deg));\n}\n\n.pagination__button--next {\n    -webkit-transform: var(--toujou-location-finder-pagination-button-next-transform, rotate(-90deg));\n            transform: var(--toujou-location-finder-pagination-button-next-transform, rotate(-90deg));\n}\n\n.pagination__text {\n    font-size: var(--toujou-location-finder-pagination-text-size, .875rem);\n}\n\n@media (hover: hover) {\n    .pagination__button:hover {\n        background-color: var(--toujou-location-finder-pagination-button-bg-color-hover, var(--primary-color));\n        opacity: var(--toujou-location-finder-pagination-button-opacity-hover, 1);\n    }\n}\n\n@media screen and (min-width: 840px) {\n    :host {\n        display: block;\n    }\n\n    .loading-bar {\n        top: 0;\n    }\n\n    .location-finder__map {\n        max-height: var(--toujou-location-finder-map-max-height, 75vh);\n    }\n\n    .sidebar__ui-button--locator {\n        left: var(--toujou-location-finder-locator-left, calc(var(--toujou-location-finder-sidebar-width) + calc(var(--toujou-location-finder-padding) * 2) ));\n        top: var(--toujou-location-finder-locator-top, var(--toujou-location-finder-padding));\n    }\n\n    .sidebar__panel {\n        position: var(--toujou-location-finder-panel-position, absolute);\n        width: var(--toujou-location-finder-panel-width, var(--toujou-location-finder-sidebar-width));\n        top: var(--toujou-location-finder-panel-top, calc(var(--toujou-location-finder-padding) + var(--toujou-location-finder-search-height) + 2px));\n        left: var(--toujou-location-finder-panel-left, var(--toujou-location-finder-padding));\n        -webkit-transform: var(--toujou-location-finder-panel-transform, translateX(0));\n                transform: var(--toujou-location-finder-panel-transform, translateX(0));\n        -webkit-transition: var(--toujou-location-finder-panel-transition, transform var(--toujou-location-finder-transition-settings));\n        transition: var(--toujou-location-finder-panel-transition, transform var(--toujou-location-finder-transition-settings));\n        height: var(--toujou-location-finder-panel-height, calc(100% - calc(var(--toujou-location-finder-padding) * 3) - calc(var(--toujou-location-finder-search-height)) - 1.5rem));\n    }\n\n    .teasers {\n        width: var(--toujou-location-finder-teasers-width, var(--toujou-location-finder-sidebar-width));\n        max-height: var(--toujou-location-finder-teasers-max-height, calc(var(--toujou-location-finder-map-height) - (var(--toujou-location-finder-padding) * 3) - var(--toujou-location-finder-search-height)));\n        overflow: var(--toujou-location-finder-teasers--overflow, auto);\n        padding: var(--toujou-location-finder-teasers-padding, calc(var(--toujou-location-finder-padding) / 4) 0);\n    }\n}\n"]))),Ht=i(Nt||(Nt=zt(["/* TEASER */\n.teaser {\n    --toujou-location-finder-teaser-border-bottom: 1px solid var(--font-color--light);\n\n    padding: var(--toujou-location-finder-teaser--padding, .5rem);\n    display: var(--toujou-location-finder-teaser-display, grid);\n    grid-template-columns: var(--toujou-location-finder-teaser-grid-columns, 1fr var(--toujou-location-finder-image-size));\n    grid-gap: var(--toujou-location-finder-teaser-gap, .5rem);\n    -webkit-text-decoration: var(--toujou-location-finder-teaser-text-decoration, none);\n            text-decoration: var(--toujou-location-finder-teaser-text-decoration, none);\n}\ntoujou-location-finder-teaser:not(:last-child) .teaser {\n    border-bottom: var(--toujou-location-finder-teaser-not-last-child-teaser-border-bottom, var(--toujou-location-finder-teaser-border-bottom));\n}\n.teaser[teaserhasnoimage] {\n    grid-template-columns: var(--toujou-location-finder-teaser-no-image-grid-template-columns, var(--toujou-location-finder-teaser-grid-columns-no-image, 1fr));\n}\n.teaser:not(:last-child) {\n    border-bottom: var(--toujou-location-finder-teaser-last-child-border-bottom, var(--toujou-location-finder-teaser-separator));\n}\n.teaser__image,\n.teaser__logo-container {\n    min-height: var(--toujou-location-finder-image-size, 80px);\n    height: var(--toujou-location-finder-image-size, 80px);\n    width: var(--toujou-location-finder-image-size, 80px);\n    -o-object-fit: var(--toujou-location-finder-image-object-fit, cover);\n       object-fit: var(--toujou-location-finder-image-object-fit, cover);\n    border-radius: var(--toujou-location-finder-teaser-image-radius, 2px);\n}\n.teaser__image--logo {\n    -o-object-fit: var(--toujou-location-finder-logo-object-fit, contain);\n       object-fit: var(--toujou-location-finder-logo-object-fit, contain);\n}\n.teaser__title {\n    display: var(--toujou-location-finder-title-display, grid);\n    grid-template-columns: var(--toujou-location-finder-title-grid-template-columns, auto 1fr);\n    margin-bottom: var(--toujou-location-finder-title-margin-bottom, 0);\n}\n.teaser__name {\n    font-weight: var(--toujou-location-finder-teaser-name-font-weight, var(--paragraph__bold));\n    font-size: var(--toujou-location-finder-teaser-name-font-size, 1.25rem);\n    font-family: var(--toujou-location-finder-teaser-name-font-family, var(--headline__family));\n    margin-top: var(--toujou-location-finder-teaser-name-margin-top, 0);\n    margin-bottom: var(--toujou-location-finder-teaser-name-margin-bottom, 0);\n    color: var(--toujou-location-finder-teaser-name-color, var(--primary-color));\n    display: var(--toujou-location-finder-teaser-name-display, block);\n}\n.teaser__branch {\n    font-size: var(--toujou-location-finder-teaser-branch-font-size, 1rem);\n    display: var(--toujou-location-finder-teaser-branch-display, block);\n    font-weight:var(--toujou-location-finder-teaser-branch-font-weight,  var(--paragraph__normal));\n    font-family: var(--toujou-location-finder-teaser-branch-font-family, var(--paragraph__family));\n    margin-top: var(--toujou-location-finder-teaser-branch-margin-top, .125rem);\n    color: var(--toujou-location-finder-teaser-branch-color, var(--font-color));\n    opacity: var(--toujou-location-finder-teaser-branch-opacity, .75);\n}\n.teaser__type {\n    font-family: var(--toujou-location-finder-teaser-name-font-family, var(--paragraph__family));\n    font-size: var(--toujou-location-finder-teaser-type-font-size, .75rem);\n    font-weight: var(--toujou-location-finder-teaser-type-font-weight, var(--paragraph__bold));\n    text-transform: var(--toujou-location-finder-teaser-type-text-transform, uppercase);\n    opacity: var(--toujou-location-finder-teaser-type-opacity, .5);\n    margin: var(--toujou-location-finder-teaser-type-margin, .5rem 0 0);\n    color: var(--toujou-location-finder-teaser-type-color, var(--font-color));\n}\n.teaser__description {\n    font-family: var(--toujou-location-finder-teaser-description-font-family, var(--paragraph__family));\n    font-size: var(--toujou-location-finder-teaser-description-font-size, .875rem);\n    margin: var(--toujou-location-finder-teaser-description-margin, .5rem 0 0);\n    overflow: var(--toujou-location-finder-teaser-description-overflow, hidden);\n    text-overflow: var(--toujou-location-finder-teaser-description-text-overflow, ellipsis);\n    white-space: var(--toujou-location-finder-teaser-description-white-space, initial);\n    display: var(--toujou-location-finder-teaser-description-display, -webkit-box);\n    -webkit-line-clamp: var(--toujou-location-finder-teaser-description-line-clamp, 2);\n    -webkit-box-orient: var(--toujou-location-finder-teaser-description-box-orient, vertical);\n    color: var(--toujou-location-finder-teaser-description-color, var(--font-color));\n    line-height: var(--toujou-location-finder-teaser-description-line-height, 1.25);\n}\n.teaser__address {\n    margin-bottom: var(--toujou-location-finder-teaser-address-margin-bottom, .25rem);\n    margin-top: var(--toujou-location-finder-teaser-address-margin-top, .25rem);\n}\n.teaser__address-meta,\n.teaser__time {\n    display:  var(--toujou-location-finder-teaser-meta-display, inline-block);\n    font-size: var(--toujou-location-finder-teaser-meta-font-size, .875rem);\n    font-family:  var(--toujou-location-finder-teaser-meta-font-family, var(--paragraph__family));\n    color: var(--toujou-location-finder-teaser-meta-color, var(--font-color));\n    font-style:  var(--toujou-location-finder-teaser-meta-font-style, normal);\n    opacity: var(--toujou-location-finder-teaser-meta-opacity, .75);\n    line-height: var(--toujou-location-finder-teaser-meta-line-height, 1.2);\n}\n.teaser__times {\n    font-family: var(--toujou-location-finder-teaser-times-font-family, var(--paragraph__family));\n    font-size: var(--toujou-location-finder-teaser-times-font-size, 1rem);\n    line-height:  var(--toujou-location-finder-teaser-times-line-height, 1);\n}\n.teaser__address-meta--country,\n.teaser__address-meta--region {\n    display:  var(--toujou-location-finder-teaser-meta-country-display, block);\n}\n.teaser__address-meta--telephone,\n.teaser__address-meta--email,\n.teaser__address-meta--description {\n    display:  var(--toujou-location-finder-teaser-meta-phone-display, block);\n    margin-top:  var(--toujou-location-finder-teaser-meta-phone-margin-top, .25rem);\n}\n.teaser > *:last-child {\n    margin-bottom:  var(--toujou-location-finder-teaser-last-child-inside-margin-bottom, .25rem);\n}\n.teaser__day {\n    display:  var(--toujou-location-finder-teaser-day-display, inline-block);\n    width:  var(--toujou-location-finder-teaser-day-width, 75px);\n}\ntoujou-location-finder-teaser[highlighted] .teaser {\n    background-color: var(--toujou-location-finder-teaser-highlighted-bg-color, rgba(150, 150, 150, .1));\n}\ntoujou-location-finder-teaser[highlighted] .teaser .teaser__title {\n    color: var(--toujou-location-finder-teaser-highlighted-title-color, var(--primary-color));\n}\n@media (hover: hover) {\n    .teaser:hover, .teaser[is-highlighted] {\n        background-color: var(--toujou-location-finder-teaser-highlighted-bg-color);\n    }\n\n    :is(.teaser:hover, .teaser[is-highlighted]) .teaser__title {\n        color: var(--toujou-location-finder-teaser-highlighted-title-color, var(--primary-color));\n    }\n}\n"]))),Gt=i(Dt||(Dt=zt(["/* POPUP */\n.location-finder-popup {\n    background-color: var(--toujou-location-finder-popup-bg-color, var(--bg-color));\n    width: var(--toujou-location-finder-popup-width, var(--toujou-location-finder-sidebar-width));\n    max-width: var(--toujou-location-finder-popup-max-width, 100%);\n    font-family: var(--paragraph__family);\n    font-weight: var(--paragraph__normal);\n    padding: var(--toujou-location-finder-popup-padding, .5rem);\n    margin: var(--toujou-location-finder-popop-margin, 0);\n}\n.location-finder-popup .teaser {\n    padding: var(--toujou-location-finder-popup-teaser-padding, 0);\n}\n.location-finder-popup .teaser[teaserhasnoimage] {\n    padding: var(--toujou-location-finder-popop-teaser-no-image-padding, 0 .25rem);\n}\n.location-finder-popup .teaser__details {\n    padding: var(--toujou-location-finder-popup-teaser-details-padding, .25rem 0);\n}\n"]))),Ut=i(Vt||(Vt=zt(['/* Basics */\n.maplibregl-ctrl-geocoder,\n.maplibregl-ctrl-geocoder *,\n.maplibregl-ctrl-geocoder *:after,\n.maplibregl-ctrl-geocoder *:before {\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n.maplibregl-ctrl-geocoder {\n  font-size: 18px;\n  line-height: 24px;\n  font-family: "Open Sans", "Helvetica Neue", Arial, Helvetica, sans-serif;\n  position: relative;\n  background-color: #fff;\n  width: 100%;\n  min-width: 240px;\n  z-index: 1;\n  border-radius: 4px;\n  -webkit-transition: width 0.25s, min-width 0.25s;\n  transition: width 0.25s, min-width 0.25s;\n}\n.maplibregl-ctrl-geocoder--input {\n  font: inherit;\n  width: 100%;\n  border: 0;\n  background-color: transparent;\n  margin: 0;\n  height: 50px;\n  color: #404040; /* fallback */\n  color: rgba(0, 0, 0, 0.75);\n  padding: 6px 45px;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  overflow: hidden;\n}\n.maplibregl-ctrl-geocoder--input::-ms-clear {\n  display: none; /* hide input clear button in IE */\n}\n.maplibregl-ctrl-geocoder--input:focus {\n  color: #404040; /* fallback */\n  color: rgba(0, 0, 0, 0.75);\n  outline: 0;\n  -webkit-box-shadow: none;\n          box-shadow: none;\n  outline: thin dotted;\n}\n.maplibregl-ctrl-geocoder .maplibregl-ctrl-geocoder--pin-right > * {\n  z-index: 2;\n  position: absolute;\n  right: 8px;\n  top: 7px;\n  display: none;\n}\n.maplibregl-ctrl-geocoder,\n.maplibregl-ctrl-geocoder .suggestions {\n  -webkit-box-shadow: 0 0 10px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 0 10px 2px rgba(0, 0, 0, 0.1);\n}\n/* Collapsed */\n.maplibregl-ctrl-geocoder.maplibregl-ctrl-geocoder--collapsed {\n  width: 50px;\n  min-width: 50px;\n  -webkit-transition: width 0.25s, min-width 0.25s;\n  transition: width 0.25s, min-width 0.25s;\n}\n/* Suggestions */\n.maplibregl-ctrl-geocoder .suggestions {\n  background-color: #fff;\n  border-radius: 4px;\n  left: 0;\n  list-style: none;\n  margin: 0;\n  padding: 0;\n  position: absolute;\n  width: 100%;\n  top: 110%; /* fallback */\n  top: calc(100% + 6px);\n  z-index: 1000;\n  overflow: hidden;\n  font-size: 15px;\n}\n.maplibregl-ctrl-bottom-left .suggestions,\n.maplibregl-ctrl-bottom-right .suggestions {\n  top: auto;\n  bottom: 100%;\n}\n.maplibregl-ctrl-geocoder .suggestions > li > a {\n  cursor: default;\n  display: block;\n  padding: 6px 12px;\n  color: #404040;\n}\n.maplibregl-ctrl-geocoder .suggestions > .active > a,\n.maplibregl-ctrl-geocoder .suggestions > li > a:hover {\n  color: #404040;\n  background-color: #f3f3f3;\n  text-decoration: none;\n  cursor: pointer;\n}\n.maplibregl-ctrl-geocoder--suggestion {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.maplibregl-ctrl-geocoder--suggestion-icon {\n  min-width: 30px;\n  min-height: 24px;\n  max-width: 30px;\n  max-height: 24px;\n  padding-right: 12px;\n}\n.maplibregl-ctrl-geocoder--suggestion-info {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n.maplibregl-ctrl-geocoder--suggestion-match {\n  font-weight: bold;\n}\n.maplibregl-ctrl-geocoder--suggestion-title,\n.maplibregl-ctrl-geocoder--suggestion-address {\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n}\n.maplibregl-ctrl-geocoder--result {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.maplibregl-ctrl-geocoder--result-icon {\n  min-width: 30px;\n  min-height: 24px;\n  max-width: 30px;\n  max-height: 24px;\n  padding-right: 12px;\n}\n.maplibregl-ctrl-geocoder--result-title {\n  font-weight: bold;\n}\n.maplibregl-ctrl-geocoder--result-title,\n.maplibregl-ctrl-geocoder--result-address {\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n}\n/* Icons */\n.maplibregl-ctrl-geocoder--icon {\n  display: inline-block;\n  vertical-align: middle;\n  speak: none;\n  fill: #757575;\n  top: 15px;\n}\n.maplibregl-ctrl-geocoder--icon-search {\n  position: absolute;\n  top: 13px;\n  left: 12px;\n  width: 23px;\n  height: 23px;\n}\n.maplibregl-ctrl-geocoder--button {\n  padding: 0;\n  margin: 0;\n  border: none;\n  cursor: pointer;\n  background: #fff;\n  line-height: 1;\n}\n.maplibregl-ctrl-geocoder--icon-close {\n  width: 20px;\n  height: 20px;\n  margin-top: 8px;\n  margin-right: 3px;\n}\n.maplibregl-ctrl-geocoder--button:hover .maplibregl-ctrl-geocoder--icon-close {\n  fill: #909090;\n}\n.maplibregl-ctrl-geocoder--icon-loading {\n  width: 26px;\n  height: 26px;\n  margin-top: 5px;\n  margin-right: 0px;\n  -webkit-animation: rotate 0.8s infinite cubic-bezier(0.45, 0.05, 0.55, 0.95);\n  animation: rotate 0.8s infinite cubic-bezier(0.45, 0.05, 0.55, 0.95);\n}\n/* Animation */\n@-webkit-keyframes rotate {\n  from {\n    -webkit-transform: rotate(0);\n    transform: rotate(0);\n  }\n  to {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n@keyframes rotate {\n  from {\n    -webkit-transform: rotate(0);\n    transform: rotate(0);\n  }\n  to {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n/* Media queries*/\n@media screen and (min-width: 640px) {\n  .maplibregl-ctrl-geocoder.maplibregl-ctrl-geocoder--collapsed {\n    width: 36px;\n    min-width: 36px;\n  }\n\n  .maplibregl-ctrl-geocoder {\n    width: 33.3333%;\n    font-size: 15px;\n    line-height: 20px;\n    max-width: 360px;\n  }\n  .maplibregl-ctrl-geocoder .suggestions {\n    font-size: 13px;\n  }\n\n  .maplibregl-ctrl-geocoder--icon {\n    top: 8px;\n  }\n\n  .maplibregl-ctrl-geocoder--icon-close {\n    width: 16px;\n    height: 16px;\n    margin-top: 3px;\n    margin-right: 0;\n  }\n\n  .maplibregl-ctrl-geocoder--icon-search {\n    left: 7px;\n    width: 20px;\n    height: 20px;\n  }\n\n  .maplibregl-ctrl-geocoder--input {\n    height: 36px;\n    padding: 6px 35px;\n  }\n\n  .maplibregl-ctrl-geocoder--icon-loading {\n    width: 26px;\n    height: 26px;\n    margin-top: -2px;\n    margin-right: -5px;\n  }\n\n  .maplibre-gl-geocoder--error {\n    color: #909090;\n    padding: 6px 12px;\n    font-size: 16px;\n    text-align: center;\n  }\n}\n.search {\n    display: var(--toujou-location-finder-search-display, block);\n    position: var(--toujou-location-finder-search-position, relative);\n    background-color: var(--toujou-location-finder-search-bg-color, var(--bg-color));\n    width: var(--toujou-location-finder-search-width, 100%);\n    max-width: var(--toujou-location-finder-search-max-width, 100%);\n    height: var(--toujou-location-finder-search-height, 2.5rem);\n    border-radius: var(--toujou-location-finder-search-border-radius, .25rem);\n    -webkit-box-shadow: var(--toujou-location-finder-search-shadow, 0 2px 4px rgba(150, 150, 150, .2));\n            box-shadow: var(--toujou-location-finder-search-shadow, 0 2px 4px rgba(150, 150, 150, .2));\n    padding: var(--toujou-location-finder-search-padding, 0);\n    border: var(--toujou-location-finder-search-border, none);\n    outline: var(--toujou-location-finder-search-outline, none);\n    -webkit-transform: var(--toujou-location-finder-search-transform, translateX(0));\n            transform: var(--toujou-location-finder-search-transform, translateX(0));\n    -webkit-transition: -webkit-transform var(--toujou-location-finder-transition-settings);\n    transition: -webkit-transform var(--toujou-location-finder-transition-settings);\n    transition: transform var(--toujou-location-finder-transition-settings);\n    transition: transform var(--toujou-location-finder-transition-settings), -webkit-transform var(--toujou-location-finder-transition-settings);\n    margin: var(--toujou-location-finder-search-margin, 0);\n    z-index: var(--toujou-location-finder-search-z-index, 2);\n    grid-row: var(--toujou-location-finder-search-grid-row, 1);\n}\n:host([ismobile][map-is-hidden]) {\n    --toujou-location-finder-search-display: none;\n}\n/* GEOCODER */\n.search .mapboxgl-ctrl-geocoder {\n    min-height: var(--toujou-location-finder-search-geocoder-min-height, 100%);\n    width: var(--toujou-location-finder-search-geocoder-width, 100%);\n    max-width: var(--toujou-location-finder-search-geocoder-max-width, 100%);\n    outline: var(--toujou-location-finder-search-outline, none);\n    -webkit-box-shadow: var(--toujou-location-finder-search-geocoder-box-shadow, none);\n            box-shadow: var(--toujou-location-finder-search-geocoder-box-shadow, none);\n    font-family: var(--toujou-location-finder-search-geocoder-font-family, var(--paragraph__family));\n    font-weight: var(--toujou-location-finder-search-geocoder-font-weight, var(--paragraph__normal));\n    color: var(toujou-location-finder-search-input-color, var(--font-color));\n    border: var(--toujou-location-finder-search-geocoder-border, 1px solid var(--font-color--light));\n}\n.search .mapboxgl-ctrl-geocoder--input {\n    height: var(--toujou-location-finder-search-height, 2.5rem);\n    background-color: var(--toujou-location-finder-search-bg-color, transparent);\n    font-family: var(--toujou-location-finder-search-input-font-family, var(--paragraph__family));\n    font-weight: var(--toujou-location-finder-search-input-font-weight, var(--headline__weight));\n    border-radius: var(--toujou-location-finder-search-input-border-radius, 0);\n    border: var(--toujou-location-finder-search-input-border, none);\n    padding: var(--toujou-location-finder-search-input-padding, 6px 35px);\n}\n.search .mapboxgl-ctrl-geocoder--input:focus {\n    outline: var(--toujou-location-finder-search-outline-focus, none);\n}\n.search .mapboxgl-ctrl-geocoder--icon-search {\n    top: var(--toujou-location-finder-search-geocoder-icon-search-top, 50%);\n    -webkit-transform: var(--toujou-location-finder-search-geocoder-icon-search-transform, translateY(-50%));\n            transform: var(--toujou-location-finder-search-geocoder-icon-search-transform, translateY(-50%));\n}\n.search .mapboxgl-ctrl-geocoder--icon-search path {\n    fill: var(--toujou-location-finder-search-search-icon-color, var(--font-color));\n    opacity: var(--toujou-location-finder-search-close-icon-opacity, .5);\n}\n.search .mapboxgl-ctrl-geocoder--pin-right > * {\n    top: var(--toujou-location-finder-search-geocoder-pin-right-top, 50%);\n    -webkit-transform: var(--toujou-location-finder-search-geocoder-pin-right-transform, translateY(-50%));\n            transform: var(--toujou-location-finder-search-geocoder-pin-right-transform, translateY(-50%));\n}\n.search .mapboxgl-ctrl-geocoder--icon-close {\n    margin-top: var(--toujou-location-finder-search-geocoder-icon-close-margin-top, 0);\n}\n.search .mapboxgl-ctrl-geocoder--icon-close path {\n    fill: var(--toujou-location-finder-search-close-icon-color, var(--font-color));\n    opacity: var(--toujou-location-finder-search-close-icon-opacity, .5);\n}\n.search .mapboxgl-ctrl-geocoder--pin-right .mapboxgl-ctrl-geocoder--icon-loading {\n    top: var(--toujou-location-finder-search-geocoder-icon-loading-top, 6px);\n}\n.search .mapboxgl-ctrl-geocoder--icon-loading path {\n    fill: var(--toujou-location-finder-search-loading-icon-color, var(--primary-color));\n}\n@media (hover: hover) {\n    .search .mapboxgl-ctrl-geocoder--icon-close:hover path {\n        fill: var(--toujou-location-finder-search-close-icon-color, var(--font-color));\n        opacity: var(--toujou-location-finder-search-close-icon-opacity-hover, 1);\n    }\n}\n@media screen and (min-width: 840px) {\n    .search {\n        position: var(--toujou-location-finder-search-position, absolute);\n        top: var(--toujou-location-finder-search-top, var(--toujou-location-finder-padding));\n        left: var(--toujou-location-finder-search-left, var(--toujou-location-finder-padding));\n        width: var(--toujou-location-finder-search-width, var(--toujou-location-finder-sidebar-width));\n        max-width: var(--toujou-location-finder-search-max-width, var(--toujou-location-finder-sidebar-width));\n    }\n\n    .search .mapboxgl-ctrl-geocoder {\n        border: var(--toujou-location-finder-search-geocoder--border, none);\n    }\n}\n'])));const qt=et((t=>t),(t=>t.data.isLoading||t.locator.isLoading||t.search.isLoading||t.popup.isLoading)),Zt=et((t=>{var e;return null!==(e=t.data.geojson)&&void 0!==e?e:{type:"FeatureCollection",features:[]}}),(t=>t.features.highlightedFeature),((t,e)=>t&&Object.prototype.hasOwnProperty.call(t,"features")?{...t,features:t.features.map((t=>({type:t.type,geometry:t.geometry,properties:{...t.properties,isHighlighted:e===t.properties.uid}})))}:t));class Jt extends o{static get is(){return"toujou-location-finder"}static get styles(){return[$t,Ht,Gt,Ut]}static get properties(){return{isLoading:{type:Boolean,reflect:!0},reducedMotion:{type:Boolean,attribute:"reduced-motion"},_geoJsonData:{type:Object},_geoJsonPoints:{type:Object},_geoJsonPolygons:{type:Object},_geoJsonLines:{type:Object},_map:{type:Object},_teasersData:{type:String},hasPagination:{type:Boolean,reflect:!0},_currentPage:{type:Number},bounds:{type:Array},geoJsonUrl:{type:String},filterParams:{type:String},teaserUrl:{type:String},_popupFeature:{type:Object},_popupCoordinates:{type:Array},isMobile:{type:Boolean,reflect:!0},accessToken:{type:String,attribute:"access-token"},mapStyle:{type:String,attribute:"map-style"},maxZoom:{type:Number},fitBoundsMaxZoom:{type:Number,attribute:"fit-bounds-max-zoom"},minZoom:{type:Number},_hideMap:{type:Boolean,attribute:"map-is-hidden",reflect:!0},locatorButtonLabel:{type:String,attribute:"locator-button-label"},paginationPrevButtonTitle:{type:String,attribute:"pagination-prev-button-title"},paginationNextButtonTitle:{type:String,attribute:"pagination-next-button-title"}}}get _geoJsonEndpointFull(){return this._bounds=this._map.getBounds(),`${this.geoJsonUrl}?north=${this._bounds._ne.lat}&south=${this._bounds._sw.lat}&east=${this._bounds._ne.lng}&west=${this._bounds._sw.lng}${this.filterParams}`}render(){const t=this.querySelectorAll('[slot="layers"]').length>0;return n`
      <div class="loading-bar" part="loading-bar"></div>
      <toujou-map
        class="location-finder__map"
        @toujou-map-ready="${this._onToujouMapReady}"
        .accessToken="${this.accessToken}"
        .mapStyle="${this.mapStyle}"
        .minZoom="${this.minZoom}"
        .maxZoom="${this.maxZoom}"
        .fitBoundsMaxZoom="${this.fitBoundsMaxZoom}"
        @toujou-map-layer-added="${this.onMapLayerAdded}"
        @toujou-map-layer-removed="${this.onMapLayerRemoved}"
        part="map"
      >
          ${t?n`<slot name="layers"></slot>`:this.renderLayers()}

          <toujou-map-geojson
            id="geoJsonSourcePolygons"
            ?cluster="${this._clusterRadius>0}"
            .clusterRadius="${this._clusterRadius}"
            .clusterMaxZoom="${Math.min(this._clusterMaxZoom,this.maxZoom)}"
            .sourceData='${this._geoJsonData}'
            source-id="geoJsonData">
          </toujou-map-geojson>

          ${this._popupFeature&&this._popupCoordinates?n`
            <toujou-map-popup .coordinates="${this._popupCoordinates}" part="map-popup">
                ${this._renderPopupContent()}
            </toujou-map-popup>
          `:""}
      </toujou-map>

      <div class="geocoder-container search" part="geocoder-container"></div>
      <button
        class="sidebar__ui-button sidebar__ui-button--locator"
        @click="${this._onLocatorClick}"
        ?locatorIsLoading="${this._locatorIsLoading}"
        aria-label="${this.locatorButtonLabel}"
        part="geocoder-container-locator-button"
      ></button>

      <slot name="location-finder-map-toggle" @click="${this._handleMapToggleClick}"></slot>

      <div class="sidebar__panel" part="sidebar-panel">
        ${this._teasersData?this._renderTeasers():""}
        ${this.hasPagination?this._renderPagination():""}
      </div>
    `}renderLayers(){const t={"fill-color":["case",["!=",["get","isHighlighted"],!0],this._mapPolygonColor,this._mapPolygonColorHover],"fill-opacity":.5},e={"circle-color":["case",["!=",["get","isHighlighted"],!0],this._mapPointColor,this._mapPointColorHover],"circle-radius":6,"circle-stroke-width":1,"circle-stroke-color":"#ffffff"},o={"line-color":["case",["!=",["get","isHighlighted"],!0],this._mapLineColor,this._mapLineColorHover],"line-opacity":1,"line-width":3};return n`
        <!-- POLYGONS LAYER -->
        <toujou-map-layer
          layer-id="geoJson_polygons"
          source="geoJsonData"
          type="fill"
          .paint='${t}'
          filter='["==", "$type", "Polygon"]'
        ></toujou-map-layer>

        <!-- POINTS LAYER -->
        <toujou-map-layer
          layer-id="geoJson_points"
          source="geoJsonData"
          type="circle"
          .paint='${e}'
          filter='["==", "$type", "Point"]'
        ></toujou-map-layer>

      <!-- LINES LAYER -->
      <toujou-map-layer
        layer-id="geoJson_lines"
        source="geoJsonData"
        type="line"
        layout='{
          "line-join": "round",
          "line-cap": "round"
        }'
        .paint='${o}'
        filter='["==", "$type", "LineString"]'
      ></toujou-map-layer>

      <toujou-map-layer
        layer-id="clusters"
        source="geoJsonData"
        type="circle"
        filter='["has", "point_count"]'
        paint='{
          "circle-radius": [ "step", ["get", "point_count"], 12, 3, 16, 5, 20, 10, 25, 25, 30 ],
          "circle-color": "${this._clusterBgColor}",
          "circle-stroke-width": ${this._clusterBorderWidth},
          "circle-stroke-color": "${this._clusterBorderColor}"
        }'
      ></toujou-map-layer>
      <toujou-map-layer
        layer-id="cluster-count"
        source="geoJsonData"
        type="symbol"
        filter='["has", "point_count"]'
        layout='{ "text-field": "{point_count_abbreviated}", "text-size": ${this._clusterTextSize} }'
        paint='{ "text-color": "${this._clusterTextColor}" }'
      ></toujou-map-layer>`}constructor(){super(),this.geoJsonUrl="",this.filterParams="",this.teaserUrl="",this.hasPagination=!1,this.bounds=[],this.accessToken=null,this.reducedMotion=!1,this._geoJsonData=null,this._teasersData=null,this._bounds={},this._popupFeature=null,this._popupCoordinates=null,this._maxTeasersPerPage=20,this._currentPage=1,this._locatorIsLoading=!1,this._mql=null,this._layers=[],this._cssVarsFallbacks={mapPadding:16,mapPointColor:"var(--primary-color)",mapPointColorHover:"var(--primary-color--dark)",mapPolygonColor:"var(--primary-color)",mapPolygonColorHover:"var(--primary-color--dark)",mapLineColor:"var(--primary-color)",mapLineColorHover:"var(--primary-color--dark)",breakpoint:"840px",clusterBgColor:"var(--primary-color)",clusterBorderWidth:2,clusterBorderColor:"var(--primary-color)",clusterTextColor:"var(--bg-color)",clusterTextSize:16,clusterRadius:50,clusterMaxZoom:12},this.onStateChange=this.onStateChange.bind(this),this._onLocatorSuccess=this._onLocatorSuccess.bind(this),this._onLocatorError=this._onLocatorError.bind(this),this._onMapFeatureHoverEnter=this._onMapFeatureHoverEnter.bind(this),this._onMapFeatureHoverLeave=this._onMapFeatureHoverLeave.bind(this),this._onMapFeatureClick=this._onMapFeatureClick.bind(this),this._onMapClick=this._onMapClick.bind(this),this._onMapMoveEnd=this._onMapMoveEnd.bind(this),this._initGeocoder=this._initGeocoder.bind(this),this.geoJsonUrl="",this.filterParams="",this.teaserUrl="",this._geoJsonData=null,this._teasersData=null,this._bounds={},this._popupFeature=null,this._popupCoordinates=null,this._maxTeasersPerPage=20,this._currentPage=1,this.hasPagination=!1,this.bounds=[],this._locatorIsLoading=!1,this.accessToken=null,this._mql=null,this._hideMap=!1,this._deviceCanHover=window.matchMedia("(hover: hover)").matches,this._layers=[],this.locatorButtonLabel="Find my location",this.paginationPrevButtonTitle="Previous page",this.paginationNextButtonTitle="Next page",this.store=It,this.store.subscribe(this.onStateChange),this._state=this.store.getState(),this.reducedMotion=!1}connectedCallback(){super.connectedCallback(),this.addEventListener("toujou-location-finder-teaser-mouse-enter",this._onMouseEnterTeaser),this.addEventListener("toujou-location-finder-teaser-mouse-leave",this._onMouseLeaveTeaser),this._getCustomProperties()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("toujou-location-finder-teaser-mouse-enter",this._onMouseEnterTeaser),this.removeEventListener("toujou-location-finder-teaser-mouse-leave",this._onMouseLeaveTeaser)}updated(t){super.updated(t),t.has("_map")&&this._init(),t.has("_currentPage")&&this._map&&this._fetchData(),t.has("filterParams")&&this._map&&this._fetchData()}onStateChange(){this._state=this.store.getState(),this.isLoading=qt(this._state);const t=Zt(this._state);t&&(this._geoJsonData=t),this._teasersData=this._state.data.teasers,this._currentlyVisibleFeaturesUids=this._state.data.currentlyVisibleFeatures,this.hasPagination=this._state.pagination.hasPagination,this._currentPage=this._state.pagination.currentPage,this._popupFeature=this._state.popup.feature,this._popupCoordinates=this._state.popup.coordinates,this._locatorIsLoading=this._state.locator.isLoading}async _init(){this._map&&this._fetchData()}_setHighlightedFeatureID(t){this.store.dispatch((t=>({type:rt,payload:t}))(t))}_resetHighlightedFeatureID(){this.store.dispatch({type:at})}_setLocatorLoadingStatus(t){this.store.dispatch(t?{type:ot}:{type:nt})}_onToujouMapReady(t){this._map=t.detail,this._map.setPadding(this.isMobile?this._mapPaddingMobile:this._mapPaddingDesktop),this.bounds&&this._map.fitBounds(this.bounds,{animate:!this.reducedMotion}),this._initGeocoder(),this._initFullscreenControl(),this._map.on("moveend",this._onMapMoveEnd),this.dispatchEvent(new CustomEvent("toujou-location-finder-ready",{bubbles:!0,composed:!0,detail:this}))}onMapLayerAdded(t){const e=t.detail.id;this._layers.push(e),this._map.on("mouseover",e,this._onMapFeatureHoverEnter),this._map.on("mouseleave",e,this._onMapFeatureHoverLeave),this._map.on("click",e,this._onMapFeatureClick),this._map.on("click",this._onMapClick)}onMapLayerRemoved(t){const e=t.detail.id;this._layers=this._layers.filter((t=>t!==e)),this._map.off("mouseover",e,this._onMapFeatureHoverEnter),this._map.off("mouseleave",e,this._onMapFeatureHoverLeave),this._map.off("click",e,this._onMapFeatureClick),this._map.off("click",this._onMapClick)}_onMouseEnterTeaser(t){this._setHighlightedFeatureID(+t.detail.featureUid)}_onMouseLeaveTeaser(){this._resetHighlightedFeatureID()}_onLocatorClick(){this._setLocatorLoadingStatus(!0),this._geocoder.clear(),navigator.geolocation?navigator.geolocation.getCurrentPosition(this._onLocatorSuccess,this._onLocatorError):console.error("Cannot get your location because Geolocation is not supported by your browser")}_onLocatorSuccess(t){const{latitude:e,longitude:o}=t.coords;this._map.flyTo({center:[o,e]}),this._setLocatorLoadingStatus(!1)}_onLocatorError(t){console.error("Could not get your location",t),this._setLocatorLoadingStatus(!1)}_onMapFeatureHoverEnter(t){this._deviceCanHover&&(this._map.getCanvas().style.cursor="pointer",this._setHighlightedFeatureID(t.features[0].properties.uid))}_onMapFeatureClick(t){t.features[0].properties.uid&&this._showPopup(t)}_onMapClick(){this._popupFeature&&(this.store.dispatch({type:Tt}),this.store.dispatch({type:Ot}))}_onMapFeatureHoverLeave(){this._deviceCanHover&&(this._map.getCanvas().style.cursor="grab",this._resetHighlightedFeatureID())}_onMapMoveEnd(){this.store.dispatch({type:lt}),this._fetchData()}_onPaginationButtonClick(t){const e=t.currentTarget.getAttribute("paginationAction");"prev"===e&&this.store.dispatch({type:ct}),"next"===e&&this.store.dispatch({type:ut})}_showPopup(t){const e="Point"===t.features[0].geometry.type?t.features[0].geometry.coordinates:t.lngLat;this.store.dispatch(((t,e)=>async o=>{o({type:Ct});try{const n=new URLSearchParams({ids:t}),i=e+(e.match(/[?]/g)?"&":"?")+n.toString();o((t=>({type:St,payload:t}))(await fetch(i).then((t=>t.text()))))}catch(n){console.error("Could not get popup content",n)}o({type:Mt})})(t.features[0].properties.uid,this.teaserUrl)),e&&this.store.dispatch({type:At,payload:e})}_getCustomProperties(){const t=window.getComputedStyle(document.body);this._mapPointColor=t.getPropertyValue("--toujou-location-finder-map-point-color")||this._cssVarsFallbacks.mapPointColor,this._mapPointColorHover=t.getPropertyValue("--toujou-location-finder-map-point-color-hover")||this._cssVarsFallbacks.mapPointColorHover,this._mapPolygonColor=t.getPropertyValue("--toujou-location-finder-map-polygon-color")||this._cssVarsFallbacks.mapPolygonColor,this._mapPolygonColorHover=t.getPropertyValue("--toujou-location-finder-map-polygon-color-hover")||this._cssVarsFallbacks.mapPolygonColorHover,this._mapLineColor=t.getPropertyValue("--toujou-location-finder-map-line-color")||this._cssVarsFallbacks.mapLineColor,this._mapLineColorHover=t.getPropertyValue("--toujou-location-finder-map-line-color-hover")||this._cssVarsFallbacks.mapLineColorHover,this._breakpoint=t.getPropertyValue("--toujou-location-finder-breakpoint")||this._cssVarsFallbacks.breakpoint,this._clusterBgColor=t.getPropertyValue("--toujou-location-finder-cluster-background-color")||this._cssVarsFallbacks.clusterBgColor,this._clusterBorderWidth=t.getPropertyValue("--toujou-location-finder-cluster-border-width")||this._cssVarsFallbacks.clusterBorderWidth,this._clusterBorderColor=t.getPropertyValue("--toujou-location-finder-cluster-border-color")||this._cssVarsFallbacks.clusterBorderColor,this._clusterTextColor=t.getPropertyValue("--toujou-location-finder-cluster-text-color")||this._cssVarsFallbacks.clusterTextColor,this._clusterTextSize=t.getPropertyValue("--toujou-location-finder-cluster-text-size")||this._cssVarsFallbacks.clusterTextSize,this._clusterRadius=parseInt(t.getPropertyValue("--toujou-location-finder-cluster-radius"),10)||this._cssVarsFallbacks.clusterRadius,this._clusterMaxZoom=t.getPropertyValue("--toujou-location-finder-cluster-max-zoom")||this._cssVarsFallbacks.clusterMaxZoom,this._mapPaddingMobile={top:parseInt(t.getPropertyValue("--toujou-location-finder-map-padding-mobile-top"),10)||this._cssVarsFallbacks.mapPadding,bottom:parseInt(t.getPropertyValue("--toujou-location-finder-map-padding-mobile-bottom"),10)||this._cssVarsFallbacks.mapPadding,left:parseInt(t.getPropertyValue("--toujou-location-finder-map-padding-mobile-left"),10)||this._cssVarsFallbacks.mapPadding,right:parseInt(t.getPropertyValue("--toujou-location-finder-map-padding-mobile-right"),10)||this._cssVarsFallbacks.mapPadding},this._mapPaddingDesktop={top:parseInt(t.getPropertyValue("--toujou-location-finder-map-padding-desktop-top"),10)||this._cssVarsFallbacks.mapPadding,bottom:parseInt(t.getPropertyValue("--toujou-location-finder-map-padding-desktop-bottom"),10)||this._cssVarsFallbacks.mapPadding,left:parseInt(t.getPropertyValue("--toujou-location-finder-map-padding-desktop-left"),10)||this._cssVarsFallbacks.mapPadding,right:parseInt(t.getPropertyValue("--toujou-location-finder-map-padding-desktop-right"),10)||this._cssVarsFallbacks.mapPadding},this._initMatchMedia()}_fetchData(){var t,e,o,n,i,r;this.store.dispatch((t=this._geoJsonEndpointFull,e=this.teaserUrl,o=this._map,n=this._layers,i=this._currentlyVisibleFeaturesUids,r=this._maxTeasersPerPage,async(a,s)=>{const{currentPage:l}=s().pagination;a(bt());try{const s=await(async t=>fetch(t).then((t=>t.json())))(t);a({type:ht,payload:s}),o.once("idle",(async()=>{a(bt());const t=[];for(const e of((t,e,o)=>{const n=[];let i=[];return o.forEach((t=>{e&&e.getLayer(t)&&n.push(t)})),n.length&&(i=e.queryRenderedFeatures({layers:n})),i})(0,o,n))if(Object.prototype.hasOwnProperty.call(e.properties,"cluster_id")){const n=o.getSource(e.source),i=await wt(n,e.properties.cluster_id,e.properties.point_count,0);t.push(...i)}else t.push(e);const s=(t=>{if(!t.length)return[];const e={};return t.filter((t=>{const{uid:o}=t.properties;return!e[o]&&(e[o]=!0,!0)}))})(t),c=s.map((t=>t.properties.uid));if(a(c.length>r?{type:dt}:{type:pt}),a(yt(c)),d=i,p=c,!(Array.isArray(d)&&Array.isArray(p)&&d.length===p.length&&d.every(((t,e)=>t===p[e])))){const t={offset:(l-1)*(u=r),limit:u},o=await(async(t,e,o)=>{if(!t.length)return null;const n=t.filter((t=>t.properties.search_boost||t.properties.name)).sort(jt).splice(o.offset,o.limit).map((t=>t.properties.uid)),i=new URLSearchParams({ids:n.join(",")}),r=e+(e.match(/[?]/g)?"&":"?")+i.toString();return fetch(r).then((t=>t.text()))})(s,e,t);a({type:gt,payload:o}),a(yt(c.sort()))}var u,d,p;a(_t())}))}catch(c){console.error("Could not load the location finder geoJSON",c)}a(_t())}))}_renderTeasers(){return n`
        <div class="teasers" part="teasers">
          ${W(this._teasersData)}
        </div>
    `}_renderPagination(){return n`
      <div class="pagination" part="pagination">
        <button
          class="pagination__button pagination__button--prev"
          paginationAction="prev"
          @click="${this._onPaginationButtonClick}"
          ?disabled="${1===this._currentPage}"
          part="pagination-button pagination-button-prev"
          title="${this.paginationPrevButtonTitle}"
        ></button>
        <div
          class="pagination__text"
          part="pagination-text"
        >${(this._currentPage-1)*this._maxTeasersPerPage+1} - ${this._currentPage*this._maxTeasersPerPage}</div>
        <button
          class="pagination__button pagination__button--next"
          paginationAction="next"
          @click="${this._onPaginationButtonClick}"
          ?disabled="${this._currentlyVisibleFeaturesUids.length/this._currentPage<=this._maxTeasersPerPage}"
          part="pagination-button pagination-button-next"
          title="${this.paginationNextButtonTitle}"
        ></button>
      </div>
    `}_renderPopupContent(){return n`
        <div class="location-finder-popup" part="popup">
          ${W(this._popupFeature)}
        </div>
    `}_initGeocoder(){const t={forwardGeocode:async t=>{let e=[];try{const o=`https://nominatim.openstreetmap.org/search?q=${t.query}&format=geojson&polygon_geojson=1&addressdetails=1`,n=await fetch(o);e=(await n.json()).features.map((t=>{const e=[t.bbox[0]+(t.bbox[2]-t.bbox[0])/2,t.bbox[1]+(t.bbox[3]-t.bbox[1])/2];return{type:"Feature",geometry:{type:"Point",coordinates:e},place_name:t.properties.display_name,properties:t.properties,text:t.properties.display_name,place_type:["place"],bbox:t.bbox,center:e}}))}catch(o){console.error(`Failed to forwardGeocode with error: ${o}`)}return{type:"FeatureCollection",features:e}}};this._geocoder=new q(t,{maplibregl:r,showResultsWhileTyping:!0,showResultMarkers:!1,marker:!1}),this.shadowRoot.querySelector(".geocoder-container").appendChild(this._geocoder.onAdd(this._map)),this._geocoder.on("loading",(()=>{this.store.dispatch({type:kt})})),this._geocoder.on("results",(()=>{this.store.dispatch({type:Et})}));const e="en"===document.documentElement.lang?"Search location":"Standort suchen";this._geocoder.setPlaceholder(e)}_initFullscreenControl(){this._map.addControl(new r.FullscreenControl({container:this}))}_initMatchMedia(){this._mql=window.matchMedia(`(max-width: ${this._breakpoint})`),this.isMobile=this._mql.matches,this._mql.addListener((t=>{this.isMobile=t.matches,this._updateMapPadding()}))}_updateMapPadding(){this._map&&this._map.setPadding(this.isMobile?this._mapPaddingMobile:this._mapPaddingDesktop)}_handleMapToggleClick(){this._hideMap=!this._hideMap}}customElements.define(Jt.is,Jt);
//# sourceMappingURL=toujou-location-finder.js.map
