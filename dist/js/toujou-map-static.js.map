{"version":3,"file":"toujou-map-static.js","sources":["../../src/components/copied/toujou-map/toujou-map-static.js"],"sourcesContent":["import { LitElement, html, css } from 'lit';\n\n/**\n * Show a static map (as an image).\n * The map is configurable with zoom, height, width, pitch and bearing.\n *\n * @element toujou-map-static\n */\n// eslint-disable-next-line import/prefer-default-export\nexport class ToujouMapStatic extends LitElement {\n  static get is() { return 'toujou-map-static'; }\n\n  static get styles() {\n    return css`\n      :host {\n        display: inline-block;\n        overflow: hidden;\n        position: relative;\n      }\n      #img {\n        position: absolute;\n        top: 0px;\n        right: 0px;\n        bottom: 0px;\n        left: 0px;\n      }\n    `;\n  }\n\n  render() {\n    return html`\n      <img id=\"img\" src=\"${this.mapSource}\" alt=\"Map Image\">\n      <slot @toujou-map-element-attached=\"${this.updateMapElements}\" @slotchange=\"${this.updateMapElements}\"></slot>\n    `;\n  }\n\n  static get properties() {\n    return {\n\n      accessToken: {\n        type: String,\n        attribute: 'access-token',\n      },\n\n      /**\n       * Define which style should be used for the map.\n       * It must be a link to a valid map style.\n       * Default is 'mapbox://styles/mapbox/light-v10'\n       *\n       * @String\n       */\n      mapStyle: {\n        type: String,\n        attribute: 'map-style',\n      },\n\n      /* The username of the account to which the style belongs. */\n      username: {\n        type: String,\n      },\n\n      /* The ID of the style from which to create a static map. */\n      styleId: {\n        type: String,\n        attribute: 'style-id',\n      },\n\n      // eslint-disable-next-line max-len\n      /* One or more comma-separated features that can be applied on top of the map at request time. */\n      overlay: {\n        type: String,\n      },\n\n      /**\n       * Geocoordinates [longitude, latitude] for the center point of the static map.\n       * Default is '[0, 0].\n       *\n       * @Array\n       */\n      center: {\n        type: Array,\n      },\n\n      /**\n       * Zoom level for the static map.\n       * It should be a number between 0 and 20.\n       * Fractional zoom level will be rounded to two decimal places.\n       * Default value is '8'.\n       *\n       * @Number\n       */\n      zoom: {\n        type: Number,\n      },\n\n      /**\n       * Pitch tilts the map, producing a perspectiv effect.\n       * It must be a number between 0 and 60, measured in degrees.\n       * Default is 0 (looking straight down at the map).\n       * Default value is '0'.\n       *\n       * @Number\n       */\n      pitch: {\n        type: Number,\n      },\n\n      /**\n       * Bearing rotates the map around its center.\n       * Must be a number between 0 and 360, interpreted as decimal degrees.\n       * '90' rotates the map 90Â° clockwise, while '180' flips the map.\n       * Default is '0'.\n       *\n       * @Number\n       */\n      bearing: {\n        type: Number,\n      },\n\n      /**\n       * If 'auto' is added, the viewport will fir the bounds of the overlay.\n       * If used, 'auto' replaces center, zoom, bearing and pitch.\n       * Default value is 'false'\n       *\n       * @Boolean\n       */\n      auto: {\n        type: Boolean,\n      },\n\n      /**\n       * Width of the image.\n       * Must be a number between 1 and 1280 (pixels).\n       * Default value is '300' (px)\n       *\n       * @Number\n       */\n      width: {\n        type: Number,\n      },\n\n      /**\n       * Height of the image.\n       * It must be a number between 1 and 1280 (pixels).\n       * Default value is '200' (px)\n       *\n       * @Number\n       */\n      height: {\n        type: Number,\n      },\n\n      /* Internal reference to connected markers */\n      markers: {\n        type: Array,\n      },\n\n      // eslint-disable-next-line max-len\n      /* The image url shouldn't be set before the slot isn't rendered yet and no potential overlays are captured. */\n      slotRendered: {\n        type: Boolean,\n      },\n    };\n  }\n\n  get mapStyleParts() {\n    return this.mapStyle.replace(/^mapbox:\\/\\/styles\\//, '');\n  }\n\n  get renderedOverlay() {\n    const markers = this.markers.map(ToujouMapStatic.renderMarker);\n    this.overlay && markers.push(this.overlay);\n    return markers.join(',');\n  }\n\n  get mapSource() {\n    if (!this.slotRendered) {\n      return '';\n    }\n\n    const pathParts = [\n      'https://api.mapbox.com',\n      'styles',\n      'v1',\n      this.mapStyleParts,\n      'static',\n    ];\n\n    const { renderedOverlay } = this;\n    renderedOverlay && pathParts.push(renderedOverlay);\n\n    this.auto ? pathParts.push('auto') : pathParts.push(this.center.concat([this.zoom, this.bearing, this.pitch]).join(','));\n\n    pathParts.push(`${this.width}x${this.height}`);\n\n    return `${pathParts.join('/')}?access_token=${this.accessToken}`;\n  }\n\n  set width(width) {\n    // eslint-disable-next-line no-restricted-globals\n    this.style.width = isNaN(width) ? width : `${width}px`;\n  }\n\n  get width() {\n    return this.style.width.replace(/px$/, '');\n  }\n\n  set height(height) {\n    // eslint-disable-next-line no-restricted-globals\n    this.style.height = isNaN(height) ? height : `${height}px`;\n  }\n\n  get height() {\n    return this.style.height.replace(/px$/, '');\n  }\n\n  constructor(props) {\n    super(props);\n    this.accessToken = 'pk.eyJ1IjoiZml0cmVpc2VuIiwiYSI6ImNqdHppeXlkMDBiazk0M3QxZDFpNGNqYmgifQ.f6VsL4UgB13NPCXv9-vJGQ';\n    this.mapStyle = 'mapbox://styles/mapbox/light-v10';\n    this.center = [0, 0];\n    this.overlay = '';\n    this.zoom = 8;\n    this.pitch = 0;\n    this.bearing = 0;\n    this.auto = false;\n    this.width = 300;\n    this.height = 200;\n    this.markers = [];\n    this.slotRendered = false;\n  }\n\n  firstUpdated() {\n    this.slotRendered = !!this.shadowRoot.querySelector('slot');\n  }\n\n  updateMapElements() {\n    const nodes = this.shadowRoot.querySelector('slot').assignedNodes({ flatten: true });\n    const mapElements = nodes.filter((n) => n.nodeName.slice(0, 10) === 'TOUJOU-MAP');\n    this.markers = mapElements.filter((n) => n.nodeName === 'TOUJOU-MAP-MARKER');\n  }\n\n  static renderMarker(marker) {\n    const markerProperties = {\n      name: 'pin-l',\n      label: '',\n      color: '77b800',\n      coordinates: [0, 0],\n    };\n\n    const markerConstructor = customElements.get(marker.nodeName);\n    if (markerConstructor) {\n      markerProperties.color = marker.color || markerProperties.color;\n      markerProperties.coordinates = marker.coordinates || markerProperties.coordinates;\n    } else {\n      markerProperties.color = (marker.hasAttribute('color') ? marker.getAttribute('color') : '') || markerProperties.color;\n      markerProperties.coordinates = (marker.hasAttribute('coordinates') ? JSON.parse(marker.getAttribute('coordinates')) : null) || markerProperties.coordinates;\n    }\n\n    return `${markerProperties.name}${markerProperties.label ? `-${markerProperties.label}` : ''}${markerProperties.color ? `+${markerProperties.color.replace(/^#/, '')}` : ''}(${markerProperties.coordinates.join(',')})`;\n  }\n}\n\ncustomElements.define(ToujouMapStatic.is, ToujouMapStatic);\n"],"names":["ToujouMapStatic","LitElement","css","html","markers","pathParts","renderedOverlay","width","height","props","mapElements","n","marker","markerProperties"],"mappings":"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"}