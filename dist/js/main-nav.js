class t{constructor(t){this.navListItems=[],this.activeSubNavs=[],this.listItemSelector=".main-nav__list-item",this.hasSubNavAttribute="has-subnav",this.isOpenAttribute="is-open",this.listItemLevelAttribute="nav-item-level",this.listItemChevronSelector=".main-nav__chevron",this.listSelector=".main-nav__list",this.isOpenOnHoverAttribute="is-open-on-hover",this._getNavListItems=()=>{this.navListItems=[...this.mainNavEl.querySelectorAll(this.listItemSelector)],this.navListItems?this.navListItems.forEach((t=>{t.hasSubNav=t.hasAttribute(this.hasSubNavAttribute),t.hasSubNav&&(t.isOpen=!1,t.level=t.getAttribute(this.listItemLevelAttribute),t.toggleEl=t.querySelector(".main-nav__chevron"),t.toggleEl.addEventListener("click",(()=>{this._toggleListItemState(t)})),t.addEventListener("keyup",this._handleKeyUp))})):console.warn("TOUJOU: Main navigation has no list items!")},this._handleMouseEvent=t=>{this._toggleListItemState(t.currentTarget)},this._handleKeyUp=t=>{var e,i,s;if("Escape"===t.key||"Escape"===t.code){const n=this.activeSubNavs.shift();t.stopPropagation(),n?(this._toggleListItemState(n),null==(s=null==(i=n.parentElement)?void 0:i.querySelector(`${this.listItemChevronSelector}[aria-controls="${null==(e=n.querySelector(this.listSelector))?void 0:e.id}"]`))||s.focus({focusVisible:!0})):this.mainNavEl.dispatchEvent(new CustomEvent("toujou-main-nav-close"))}},this._toggleListItemState=t=>{const e=t.querySelector(this.listItemChevronSelector);t.isOpen=!t.isOpen,null==e||e.setAttribute("aria-expanded",`${t.isOpen}`),null==e||e.setAttribute("aria-pressed",`${t.isOpen}`),t.isOpen?(t.setAttribute(this.isOpenAttribute,""),this._closeOtherOpenListItems(t),this.activeSubNavs.unshift(t),window.addEventListener("click",this._onWindowClick)):t.removeAttribute(this.isOpenAttribute)},this._closeOtherOpenListItems=t=>{var e;const i=null==(e=t.parentNode)?void 0:e.querySelectorAll(`${this.listItemSelector}[is-open]`);i&&i.forEach((e=>{e.isOpen&&e!==t&&this._toggleListItemState(e)}))},this._closeAllNavListItems=()=>{this.navListItems.forEach((t=>{t.isOpen&&(this._toggleListItemState(t),window.removeEventListener("click",this._onWindowClick))}))},this._onWindowClick=t=>{t.target.closest(".main-nav")||this._closeAllNavListItems()},this.mainNavEl=t,this._getNavListItems(),this.mainNavEl.hasAttribute(this.isOpenOnHoverAttribute)?this.navListItems.forEach((t=>{t.hasSubNav&&(t.addEventListener("mouseenter",this._handleMouseEvent),t.addEventListener("mouseleave",this._handleMouseEvent))})):window.addEventListener("keyup",this._handleKeyUp)}}function e(){const e=document.querySelector(".main-nav");e&&!e.mainNav&&(e.mainNav=new t(e))}export{e as i};
//# sourceMappingURL=main-nav.js.map
