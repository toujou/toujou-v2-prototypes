{"version":3,"file":"toujou-topbutton.js","sources":["../../src/components/toujou-topbutton/toujou-topbutton.ts"],"sourcesContent":["import { html, LitElement, PropertyValues } from 'lit';\nimport { property } from 'lit/decorators.js';\n\nclass ToujouTopbutton extends LitElement {\n    @property({ type: Boolean, attribute: \"is-visible\", reflect: true })\n    private visible: boolean = false;\n\n    static get is() {\n        return 'toujou-topbutton';\n    }\n\n    constructor() {\n        super();\n\n        this._checkVisibility = this._checkVisibility.bind(this);\n    }\n\n    render() {\n        return html`\n            <slot id=\"content\"></slot>\n        `;\n    }\n\n    connectedCallback() {\n        super.connectedCallback();\n\n        this.setAttribute('role', 'button');\n        this._checkVisibility();\n\n        window.addEventListener('scroll', this._checkVisibility);\n        window.addEventListener('resize', this._checkVisibility);\n        this.addEventListener('click', this._handleClick);\n    }\n\n    disconnectedCallback() {\n        window.removeEventListener('scroll', this._checkVisibility);\n        window.addEventListener('resize', this._checkVisibility);\n        this.removeEventListener('click', this._handleClick);\n\n        super.disconnectedCallback();\n    }\n\n    updated(changedProperties: PropertyValues) {\n        super.updated(changedProperties);\n        if (changedProperties.has('visible')) {\n            this.setAttribute('aria-hidden', (!this.visible).toString());\n        }\n    }\n\n    /**\n     * Get the viewport height\n     */\n    get _viewportHeight(): number {\n        return Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n    }\n\n    /**\n     * Check if the button is visible according to the amount scrolled and the viewport height\n     */\n    _checkVisibility = (): void => {\n        this.visible = document.body.scrollTop > this._viewportHeight || document.documentElement.scrollTop > this._viewportHeight;\n    }\n\n    /**\n     * When the button is clicked we scroll to the top of the page and set focus on the 1st element on the page\n     */\n    _handleClick(): void {\n        window.scrollTo({\n            top: 0,\n            left: 0,\n            behavior: 'smooth',\n        });\n        const firstElementOnPage = this._getFirstElementOnPage();\n        if (firstElementOnPage) {\n            firstElementOnPage.focus();\n        }\n    }\n\n    /**\n     * Get first element on the page, so we can set focus once the button is clicked\n     */\n    _getFirstElementOnPage = (): HTMLElement | undefined => {\n        const main = document.querySelector('main');\n        let firstElement = main\n            ? main.querySelector('main *:not(span)')\n            : document.querySelector('.wrap--content *:first-child:not(.header)');\n\n        if (!firstElement) {\n            firstElement = document.querySelector('.wrap--master') || document.querySelector('*');\n        }\n\n        if (firstElement) {\n            return firstElement as HTMLElement;\n        } else {\n            console.error('TOUJOU: Could not add focus to the first element on the page');\n            return;\n        }\n    }\n}\n\ncustomElements.define(ToujouTopbutton.is, ToujouTopbutton);\n"],"names":["ToujouTopbutton","LitElement","main","firstElement","html","changedProperties","firstElementOnPage","__decorateClass","property"],"mappings":"8UAGA,MAAMA,UAAwBC,CAAW,CAQrC,aAAc,CACJ,QAPV,KAAQ,QAAmB,GAsD3B,KAAA,iBAAmB,IAAY,CACtB,KAAA,QAAU,SAAS,KAAK,UAAY,KAAK,iBAAmB,SAAS,gBAAgB,UAAY,KAAK,eAAA,EAqB/G,KAAA,uBAAyB,IAA+B,CAC9C,MAAAC,EAAO,SAAS,cAAc,MAAM,EACtC,IAAAC,EAAeD,EACbA,EAAK,cAAc,kBAAkB,EACrC,SAAS,cAAc,2CAA2C,EAMxE,GAJKC,IACDA,EAAe,SAAS,cAAc,eAAe,GAAK,SAAS,cAAc,GAAG,GAGpFA,EACO,OAAAA,EAEP,QAAQ,MAAM,8DAA8D,CAEhF,EAlFA,KAAK,iBAAmB,KAAK,iBAAiB,KAAK,IAAI,CAC3D,CARA,WAAW,IAAK,CACL,MAAA,kBACX,CAQA,QAAS,CACE,OAAAC;AAAAA;AAAAA,SAGX,CAEA,mBAAoB,CAChB,MAAM,kBAAkB,EAEnB,KAAA,aAAa,OAAQ,QAAQ,EAClC,KAAK,iBAAiB,EAEf,OAAA,iBAAiB,SAAU,KAAK,gBAAgB,EAChD,OAAA,iBAAiB,SAAU,KAAK,gBAAgB,EAClD,KAAA,iBAAiB,QAAS,KAAK,YAAY,CACpD,CAEA,sBAAuB,CACZ,OAAA,oBAAoB,SAAU,KAAK,gBAAgB,EACnD,OAAA,iBAAiB,SAAU,KAAK,gBAAgB,EAClD,KAAA,oBAAoB,QAAS,KAAK,YAAY,EAEnD,MAAM,qBAAqB,CAC/B,CAEA,QAAQC,EAAmC,CACvC,MAAM,QAAQA,CAAiB,EAC3BA,EAAkB,IAAI,SAAS,GAC/B,KAAK,aAAa,eAAgB,CAAC,KAAK,SAAS,UAAU,CAEnE,CAKA,IAAI,iBAA0B,CAC1B,OAAO,KAAK,IAAI,SAAS,gBAAgB,aAAc,OAAO,aAAe,CAAC,CAClF,CAYA,cAAqB,CACjB,OAAO,SAAS,CACZ,IAAK,EACL,KAAM,EACN,SAAU,QAAA,CACb,EACK,MAAAC,EAAqB,KAAK,yBAC5BA,GACAA,EAAmB,MAAM,CAEjC,CAsBJ,CA7FYC,EAAA,CADPC,EAAS,CAAE,KAAM,QAAS,UAAW,aAAc,QAAS,GAAM,CAAA,EADjER,EAEM,UAAA,UAAA,CAAA,EA+FZ,eAAe,OAAOA,EAAgB,GAAIA,CAAe"}