import{i as C,s as P,y as b}from"./lit-element-9d8fde0b.js";import{e as S}from"./custom-element-73470d87.js";import{e as g}from"./property-1027a1df.js";import"./query-assigned-elements-acf341e1.js";import{P as w,a as I}from"./photoswipe-lightbox.esm-79dfae70.js";const A=C`
  * {
    box-sizing: border-box;
  }

  :host {
    position: relative;
  }
`,L={videoAttributes:{controls:"",playsinline:"",preload:"auto"},autoplay:!0,preventDragOffset:40};function s(i){return i&&i.data&&i.data.type==="video"}class D{constructor(e,t){this.options=t,this.initLightboxEvents(e),e.on("init",()=>{this.initPswpEvents(e.pswp)})}initLightboxEvents(e){e.on("contentLoad",this.onContentLoad.bind(this)),e.on("contentDestroy",this.onContentDestroy.bind(this)),e.on("contentActivate",this.onContentActivate.bind(this)),e.on("contentDeactivate",this.onContentDeactivate.bind(this)),e.on("contentAppend",this.onContentAppend.bind(this)),e.on("contentResize",this.onContentResize.bind(this)),e.addFilter("isKeepingPlaceholder",this.isKeepingPlaceholder.bind(this)),e.addFilter("isContentZoomable",this.isContentZoomable.bind(this)),e.addFilter("useContentPlaceholder",this.useContentPlaceholder.bind(this)),e.addFilter("domItemData",(t,n,o)=>(t.type==="video"&&o&&(o.dataset.pswpVideoSources?t.videoSources=JSON.parse(pswpVideoSources):o.dataset.pswpVideoSrc?t.videoSrc=o.dataset.pswpVideoSrc:t.videoSrc=o.href),t))}initPswpEvents(e){e.on("pointerDown",t=>{const n=e.currSlide;if(s(n)&&this.options.preventDragOffset){const o=t.originalEvent;if(o.type==="pointerdown"){const l=Math.ceil(n.height*n.currZoomLevel)+n.bounds.center.y,v=o.pageY-e.offset.y;v>l-this.options.preventDragOffset&&v<l&&t.preventDefault()}}}),e.on("appendHeavy",t=>{s(t.slide)&&!t.slide.isActive&&t.preventDefault()}),e.on("close",()=>{s(e.currSlide.content)&&((!e.options.showHideAnimationType||e.options.showHideAnimationType==="zoom")&&(e.options.showHideAnimationType="fade"),this.pauseVideo(e.currSlide.content))})}onContentDestroy({content:e}){s(e)&&e._videoPosterImg&&(e._videoPosterImg.onload=e._videoPosterImg.onerror=null,e._videoPosterImg=null)}onContentResize(e){if(s(e.content)){e.preventDefault();const t=e.width,n=e.height,o=e.content;if(o.element&&(o.element.style.width=t+"px",o.element.style.height=n+"px"),o.slide&&o.slide.placeholder){const r=o.slide.placeholder.element.style;r.transform="none",r.width=t+"px",r.height=n+"px"}}}isKeepingPlaceholder(e,t){return s(t)?!1:e}isContentZoomable(e,t){return s(t)?!1:e}onContentActivate({content:e}){s(e)&&this.options.autoplay&&this.playVideo(e)}onContentDeactivate({content:e}){s(e)&&this.pauseVideo(e)}onContentAppend(e){s(e.content)&&(e.preventDefault(),e.content.isAttached=!0,e.content.appendImage())}onContentLoad(e){const t=e.content;if(s(e.content)&&(e.preventDefault(),!t.element)){if(t.state="loading",t.type="video",t.element=document.createElement("video"),this.options.videoAttributes)for(let n in this.options.videoAttributes)t.element.setAttribute(n,this.options.videoAttributes[n]||"");t.element.setAttribute("poster",t.data.msrc),this.preloadVideoPoster(t,t.data.msrc),t.element.style.position="absolute",t.element.style.left=0,t.element.style.top=0,t.data.videoSources?t.data.videoSources.forEach(n=>{let o=document.createElement("source");o.src=n.src,o.type=n.type,t.element.appendChild(o)}):t.data.videoSrc&&(t.element.src=t.data.videoSrc)}}preloadVideoPoster(e,t){!e._videoPosterImg&&t&&(e._videoPosterImg=new Image,e._videoPosterImg.src=t,e._videoPosterImg.complete?e.onLoaded():e._videoPosterImg.onload=e._videoPosterImg.onerror=()=>{e.onLoaded()})}playVideo(e){e.element&&e.element.play()}pauseVideo(e){e.element&&e.element.pause()}useContentPlaceholder(e,t){return s(t)?!0:e}}class x{constructor(e,t){new D(e,{...L,...t})}}var V=Object.defineProperty,E=Object.getOwnPropertyDescriptor,f=(i,e,t,n)=>{for(var o=n>1?void 0:n?E(e,t):e,r=i.length-1,l;r>=0;r--)(l=i[r])&&(o=(n?l(e,t,o):l(o))||o);return n&&o&&V(e,t,o),o},T=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},d=(i,e,t)=>(T(i,e,"read from private field"),t?t.call(i):e.get(i)),c=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},h,m,p,y,u,_;let a=class extends P{constructor(){super(...arguments),c(this,h),c(this,p),c(this,u),this._currentImageIndex=1,this._imageCount=0,this._handleLightboxUiRegister=()=>{this.lightbox.pswp.ui.registerElement({name:"caption",order:9,isButton:!1,appendTo:"root",onInit:i=>{this.lightbox.pswp.on("change",()=>this._handleLightboxChange(i))}})},this._handleLightboxChange=i=>{let e="";const t=this.lightbox.pswp.currSlide.data.element||null,n=(t==null?void 0:t.querySelector("a.slider__item"))||null;n&&(e=n.getAttribute("title")),i.textContent=e||""}}connectedCallback(){super.connectedCallback(),this._initializeLightbox()}render(){return b`
            <slot id="slider" name="slider"></slot>
            <slot id="button" name="button" @click="${this._handleButtonClick}"></slot>
        `}_initializeLightbox(){this.lightbox=new w({gallery:d(this,u,_),children:".slider-slide",pswpModule:I,allowPanToNext:!0,preloaderDelay:0}),this.lightbox.on("uiRegister",()=>this._handleLightboxUiRegister()),this.videoPlugin=new x(this.lightbox,{autoplay:!1}),this.lightbox.init()}_handleButtonClick(){var e;const i=(e=d(this,h,m))==null?void 0:e.querySelector(".slider-slide.is-active.is-visible .slider__item");i?i.click():d(this,p,y).click()}};h=new WeakSet;m=function(){var t;const i=(t=this.shadowRoot)==null?void 0:t.querySelector("#slider");return i&&i.assignedElements({flatten:!0})[0]||null};p=new WeakSet;y=function(){var e;return((e=d(this,h,m))==null?void 0:e.querySelector("a.slider__item"))||null};u=new WeakSet;_=function(){const i=this.getAttribute("id");return i?`#${i}`:void 0};a.styles=[A];f([g({type:Number})],a.prototype,"_currentImageIndex",2);f([g({type:Number})],a.prototype,"_imageCount",2);a=f([S("toujou-portfolio-gallery")],a);
//# sourceMappingURL=toujou-portfolio-gallery.js.map
